{"componentChunkName":"component---src-templates-blog-template-js","path":"/kubetnetes-kubespary/","result":{"data":{"cur":{"id":"22b18939-b966-58ca-8408-1ddb10464062","html":"<p>머리말  </p>\n<p>쿠버네티스 환경을 구성하는 방법은 여러가지가 존재합니다 서버를 준비하는 방법은 또한 여러 가지가 있겠지만<br>\n가장 쉽게 생각해볼 수 있는 건 <code class=\"language-text\">VirtualBox</code> 와 <code class=\"language-text\">Vagrant</code> 를 이용한 <code class=\"language-text\">로컬 VM</code>로 구성하는 것 입니다.<br>\n하지만 이번 포스트에서는 GCP STUDY + Kubernetes STUDY 겸 GCP로 진행했습니다.<br>\n사실 GCP 무료 크레딧이 아까운 마음이 더 크긴 했습니다.</p>\n<hr>\n<h2 id=\"-사전준비\" style=\"position:relative;\"><a href=\"#-%EC%82%AC%EC%A0%84%EC%A4%80%EB%B9%84\" aria-label=\" 사전준비 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✔ 사전준비</h2>\n<ul>\n<li>쿠버네티스는 3개월 마다 새로운 버전이 릴리즈 되고 해당 버전은 9개월 동안 버그와 보안 이슈를 수정하는 패치가 이루어 집니다.  </li>\n<li>이번 포스트에 구성할 노드는 <code class=\"language-text\">Master 노드 하나</code>와 <code class=\"language-text\">Worker 노드 세 개</code>로 총 <code class=\"language-text\">네 개</code>의 서버가 필요합니다.</li>\n<li>\n<p>노드의 최소 요구 사양은 다음과 같습니다.</p>\n<table>\n<thead>\n<tr>\n<th>항목</th>\n<th>사양</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>CPU</td>\n<td>1 CPU 이상</td>\n</tr>\n<tr>\n<td>메모리</td>\n<td>2 GB 이상</td>\n</tr>\n<tr>\n<td>OS</td>\n<td>CentOS 7, RHEL 7, Ubuntu 16.04+ etc.</td>\n</tr>\n</tbody>\n</table>\n</li>\n</ul>\n<br/>\n<p>또한 각 서버는 다음 조건을 만족해야 합니다.</p>\n<ul>\n<li>각 노드가 서로 <code class=\"language-text\">네트워크 연결</code>되어 있어야 합니다.</li>\n<li>\n<p>각 노드는 다음 <code class=\"language-text\">정보가 겹치지 않아야</code> 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">hostname<span class=\"token punctuation\">:</span> hostname\n<span class=\"token class-name\">MAC</span> address<span class=\"token punctuation\">:</span> ip link 또는 ifconfig <span class=\"token operator\">-</span><span class=\"token class-name\">a</span>\nproduct_uuid<span class=\"token punctuation\">:</span> sudo cat <span class=\"token operator\">/</span>sys<span class=\"token operator\">/</span><span class=\"token keyword\">class</span><span class=\"token operator\">/</span>dmi<span class=\"token operator\">/</span>id<span class=\"token operator\">/</span>product_uuid</code></pre></div>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>각 노드가 사용하는 <code class=\"language-text\">포트</code>입니다. <code class=\"language-text\">각 포트는 방화벽에서 모두 허용 되어</code> 있어야 합니다.</p>\n<table>\n<thead>\n<tr>\n<th>노드</th>\n<th>프로토콜</th>\n<th>방향</th>\n<th>포트 범위</th>\n<th align=\"center\">목적</th>\n<th align=\"center\">누가 사용?</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Master</td>\n<td>TCP</td>\n<td>Inbound</td>\n<td>6443</td>\n<td align=\"center\">Kubernetes API server</td>\n<td align=\"center\">All</td>\n</tr>\n<tr>\n<td>Master</td>\n<td>TCP</td>\n<td>Inbound</td>\n<td>2379-2380</td>\n<td align=\"center\">etcd server client API</td>\n<td align=\"center\">kube-apiserver, etcd</td>\n</tr>\n<tr>\n<td>Master</td>\n<td>TCP</td>\n<td>Inbound</td>\n<td>10250</td>\n<td align=\"center\">Kubelet API</td>\n<td align=\"center\">Self, Control plane</td>\n</tr>\n<tr>\n<td>Master</td>\n<td>TCP</td>\n<td>Inbound</td>\n<td>10251</td>\n<td align=\"center\">kube-scheduler</td>\n<td align=\"center\">Self</td>\n</tr>\n<tr>\n<td>Master</td>\n<td>TCP</td>\n<td>Inbound</td>\n<td>10252</td>\n<td align=\"center\">kube-controller-manager</td>\n<td align=\"center\">Self</td>\n</tr>\n<tr>\n<td>Worker</td>\n<td>TCP</td>\n<td>Inbound</td>\n<td>10250</td>\n<td align=\"center\">Kubelet API</td>\n<td align=\"center\">Self, Control plane</td>\n</tr>\n<tr>\n<td>Worker</td>\n<td>TCP</td>\n<td>Inbound</td>\n<td>30000-32767</td>\n<td align=\"center\">NodePort Services</td>\n<td align=\"center\">All</td>\n</tr>\n</tbody>\n</table>\n</li>\n</ul>\n<br/>\n<hr>\n<h2 id=\"-구성-install\" style=\"position:relative;\"><a href=\"#-%EA%B5%AC%EC%84%B1-install\" aria-label=\" 구성 install permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✌ 구성 (Install)</h2>\n<p><strong>구성 전 안내</strong></p>\n<p> <code class=\"language-text\">GCP</code>에는 이미 <code class=\"language-text\">Kubernetes Engine</code>란 이름으로 쿠버네티스를 사용할 수 있는 서비스를 제공하고 있습니다.</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90713985-91cef580-e2e1-11ea-98f2-09c7e0f72c9f.png\" alt=\"스크린샷, 2020-08-20 12-34-57\"></p>\n<br/>\n<p>실제 해당 메뉴에 들어가보면 이렇게 설치 없이 바로 클러스터를 만들 수 있습니다.</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90714040-ba56ef80-e2e1-11ea-91a7-51616910e81e.png\" alt=\"스크린샷, 2020-08-20 12-36-07\"></p>\n<p>하지만 이번 포스트에서는 쿠버스프레이를 이용한 구성방법을 포스팅 할 것이기 때문에 해당 서비스는 넘기겠습니다.</p>\n<br/>\n<hr>\n<h3 id=\"kubespray-로-환경-설정하기\" style=\"position:relative;\"><a href=\"#kubespray-%EB%A1%9C-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\" aria-label=\"kubespray 로 환경 설정하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kubespray 로 환경 설정하기</h3>\n<br/>\n<p><code class=\"language-text\">GCP Console</code>에 접속 후 아래 Spec으로 4개의 Instance를 생성합니다.  [인스턴스 구성 방법] : <a href=\"https://nasa1515.tech/gcp-first/\">“GCP포스트”!!!</a>  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90719826-4e2fb800-e2f0-11ea-94d4-b8f9dc1d31f4.png\" alt=\"스크린샷, 2020-08-20 14-20-27\"></p>\n<br/>\n<p>아래처럼 인스턴스 4개를 생성해야 합니다.</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90720126-eded4600-e2f0-11ea-963e-c7d5203642b8.png\" alt=\"스크린샷, 2020-08-20 14-24-55\"></p>\n<br/>\n<hr>\n<h3 id=\"설치-전-사전-작업\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EC%B9%98-%EC%A0%84-%EC%82%AC%EC%A0%84-%EC%9E%91%EC%97%85\" aria-label=\"설치 전 사전 작업 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>설치 전 사전 작업</h3>\n<p>사전 작업은 master, node1, node2, node3 모두 동일하게 진행합니다.</p>\n<br/>\n<p>사전 작업의 모든 과정은 <code class=\"language-text\">root</code> 권한으로 진행합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">sudo su <span class=\"token operator\">-</span></code></pre></div>\n<br/>\n<br/>\n<p>스왑 메모리 사용 중지  </p>\n<p><code class=\"language-text\">Swap</code> 은 디스크의 일부 공간을 메모리처럼 사용하는 기능입니다.<br>\n<code class=\"language-text\">Kubelet</code> 이 정상 동작할 수 있도록 swap 디바이스와 파일 모두 <code class=\"language-text\">disable</code> 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">swapoff <span class=\"token operator\">-</span>a\necho <span class=\"token number\">0</span> <span class=\"token operator\">></span> <span class=\"token operator\">/</span>proc<span class=\"token operator\">/</span>sys<span class=\"token operator\">/</span>vm<span class=\"token operator\">/</span>swappiness\nsed <span class=\"token operator\">-</span>e '<span class=\"token operator\">/</span>swap<span class=\"token operator\">/</span> s<span class=\"token operator\">/</span><span class=\"token operator\">^</span>#<span class=\"token operator\">*</span><span class=\"token operator\">/</span>#<span class=\"token operator\">/</span>' <span class=\"token operator\">-</span>i <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>fstab</code></pre></div>\n<ul>\n<li><code class=\"language-text\">swapoff -a</code>: paging 과 swap 기능을 끕니다.  </li>\n<li><code class=\"language-text\">/proc/sys/vm/swappiness</code>: 커널 속성을 변경해 swap을 disable 합니다.  </li>\n<li><code class=\"language-text\">/etc/fastab</code>: Swap을 하는 파일 시스템을 찾아 disable 합니다.</li>\n</ul>\n<br/>\n<br/>\n<p>각 노드의 통신을 원활하게 하기 위해 <code class=\"language-text\">방화벽을 해제</code>합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">systemctl disable firewalld\nsystemctl stop firewalld</code></pre></div>\n<br/>\n<br/>\n<p><code class=\"language-text\">SELinux(Security-Enhanced Linux)</code> 종료. 컨테이너가 호스트의 파일시스템에 접속할 수 있도록 해당 기능을 꺼야 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">setenforce <span class=\"token number\">0</span>\nsed <span class=\"token operator\">-</span>i 's<span class=\"token operator\">/</span><span class=\"token operator\">^</span>SELINUX<span class=\"token operator\">=</span>enforcing$<span class=\"token operator\">/</span>SELINUX<span class=\"token operator\">=</span>permissive<span class=\"token operator\">/</span>' <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>selinux<span class=\"token operator\">/</span>config</code></pre></div>\n<br/>\n<br/>\n<p><code class=\"language-text\">RHEL</code> 과 <code class=\"language-text\">CentOS 7</code>에서 <code class=\"language-text\">iptables</code> 관련 이슈가 있어 <code class=\"language-text\">커널 매개변수</code>를 다음과 같이 수정하고 적용합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">cat <span class=\"token operator\">&lt;&lt;</span>EOF <span class=\"token operator\">></span>  <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>sysctl<span class=\"token punctuation\">.</span>d<span class=\"token operator\">/</span>k8s<span class=\"token punctuation\">.</span>conf\nnet<span class=\"token punctuation\">.</span>bridge<span class=\"token punctuation\">.</span>bridge<span class=\"token operator\">-</span>nf<span class=\"token operator\">-</span>call<span class=\"token operator\">-</span>ip6tables <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nnet<span class=\"token punctuation\">.</span>bridge<span class=\"token punctuation\">.</span>bridge<span class=\"token operator\">-</span>nf<span class=\"token operator\">-</span>call<span class=\"token operator\">-</span>iptables <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nEOF\nsysctl <span class=\"token operator\">--</span>system</code></pre></div>\n<br/>\n<br/>\n<p><code class=\"language-text\">br_netfilter 모듈</code>을 <code class=\"language-text\">활성화</code>합니다. <code class=\"language-text\">modprobe br_netfilter 명령어</code>로 해당 모듈을 명시적으로 <code class=\"language-text\">추가</code>합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">$ modprobe br_netfilter\n$ lsmod <span class=\"token operator\">|</span> grep br_netfilter <span class=\"token punctuation\">[</span>확인<span class=\"token punctuation\">]</span></code></pre></div>\n<br/>\n<hr>\n<h3 id=\"설치-진행\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EC%B9%98-%EC%A7%84%ED%96%89\" aria-label=\"설치 진행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>설치 진행</h3>\n<p>앤서블의 인벤토리는 SSH(RSA) 기반으로 동작하므로 VM끼리의 공개 키를 공유해줘야 합니다.</p>\n<p>각 인스턴스 별로 <code class=\"language-text\">호스트 네임</code>을 설정해줍니다.<br>\n사실 GCP는 자동적으로 인스턴스의 이름을 받아오지만 GCP가 아닌 직접 구성을 할 경우에는 호스트네임을 모두 바꿔주어야 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>node3 <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ hostnamectl <span class=\"token keyword\">set</span><span class=\"token operator\">-</span>hostname nasa<span class=\"token operator\">-</span>node3\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>node3 <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ hostname\nnasa<span class=\"token operator\">-</span>node3</code></pre></div>\n<br/>\n<br/>\n<p><code class=\"language-text\">MASTER</code> 인스턴스에 HOST 정보 및 SSH 권한 설정을 합니다. GCP에서는 할 필요가 없지만 직접 구성시에는 필요합니다.</p>\n<p><code class=\"language-text\">/etc/hosts</code>에 각 노드 등록</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ sudo cat <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>hosts\n<span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span>   localhost localhost<span class=\"token punctuation\">.</span>localdomain localhost4 localhost4<span class=\"token punctuation\">.</span>localdomain4\n<span class=\"token punctuation\">::</span><span class=\"token number\">1</span>         localhost localhost<span class=\"token punctuation\">.</span>localdomain localhost6 localhost6<span class=\"token punctuation\">.</span>localdomain6\n<span class=\"token number\">10.178</span><span class=\"token number\">.0</span><span class=\"token number\">.2</span>      nasa<span class=\"token operator\">-</span>master\n<span class=\"token number\">10.178</span><span class=\"token number\">.0</span><span class=\"token number\">.4</span>      nasa<span class=\"token operator\">-</span>node1\n<span class=\"token number\">10.178</span><span class=\"token number\">.0</span><span class=\"token number\">.5</span>      nasa<span class=\"token operator\">-</span>node2\n<span class=\"token number\">10.178</span><span class=\"token number\">.0</span><span class=\"token number\">.3</span>      nasa<span class=\"token operator\">-</span>node3</code></pre></div>\n<br/>\n<br/>\n<p><code class=\"language-text\">ssh 유저 권한 설정</code>을 위해 <code class=\"language-text\">master서버</code>의 <code class=\"language-text\">/etc/sudoers</code> 파일에 내용을 추가 </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90839950-b5eb0f00-e393-11ea-94a3-b7dabd3c2d51.png\" alt=\"스크린샷, 2020-08-21 09-49-17\"></p>\n<p>h43254라는 유저에 대해서 패스워드를 물어보지 않겠다는 설정입니다.</p>\n<br/>\n<br/>\n<p><code class=\"language-text\">공개키 설정</code>을 위해서 SSH 버튼을 눌러서 <code class=\"language-text\">nasa-master</code>에 접속해 <code class=\"language-text\">ssh-keygen -t rsa</code>를 입력. 공개키를 생성합니다.  </p>\n<p>(그 외에 옵션은 Enter를 눌러서 기본값을 넣어줍니다.)</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ ssh<span class=\"token operator\">-</span>keygen <span class=\"token operator\">-</span>t rsa\nGenerating <span class=\"token keyword\">public</span><span class=\"token operator\">/</span><span class=\"token keyword\">private</span> rsa key <span class=\"token class-name\">pair<span class=\"token punctuation\">.</span>\nEnter</span> file <span class=\"token keyword\">in</span> which to save <span class=\"token return-type class-name\">the</span> key <span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>home<span class=\"token operator\">/</span>h43254<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>ssh<span class=\"token operator\">/</span>id_rsa<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> \n<span class=\"token return-type class-name\">Enter</span> passphrase <span class=\"token punctuation\">(</span>empty <span class=\"token keyword\">for</span> <span class=\"token class-name\">no</span> passphrase<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> \nEnter same <span class=\"token class-name\">passphrase</span> again<span class=\"token punctuation\">:</span> \nYour identification has <span class=\"token class-name\">been</span> saved <span class=\"token keyword\">in</span> <span class=\"token operator\">/</span>home<span class=\"token operator\">/</span>h43254<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>ssh<span class=\"token operator\">/</span>id_rsa<span class=\"token punctuation\">.</span>\nYour <span class=\"token keyword\">public</span> key has <span class=\"token class-name\">been</span> saved <span class=\"token keyword\">in</span> <span class=\"token operator\">/</span>home<span class=\"token operator\">/</span>h43254<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>ssh<span class=\"token operator\">/</span>id_rsa<span class=\"token punctuation\">.</span>pub<span class=\"token punctuation\">.</span>\nThe key fingerprint <span class=\"token keyword\">is</span><span class=\"token punctuation\">:</span>\nSHA256<span class=\"token punctuation\">:</span>sr6RS6MW<span class=\"token operator\">/</span>ESkXfbVBi9LTdRSfPm3a2F7VrC9K8e93mc h43254@nasa<span class=\"token operator\">-</span>master\nThe key's randomart image <span class=\"token keyword\">is</span><span class=\"token punctuation\">:</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span><span class=\"token punctuation\">[</span>RSA <span class=\"token number\">2048</span><span class=\"token punctuation\">]</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span>            <span class=\"token punctuation\">.</span><span class=\"token operator\">+</span>o<span class=\"token operator\">+</span>o<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>      <span class=\"token punctuation\">.</span> o   <span class=\"token punctuation\">.</span><span class=\"token operator\">++</span><span class=\"token punctuation\">.</span><span class=\"token operator\">+</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>     <span class=\"token operator\">+</span> o <span class=\"token punctuation\">.</span> <span class=\"token punctuation\">.</span>o<span class=\"token punctuation\">.</span>o<span class=\"token punctuation\">.</span>o<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>    <span class=\"token punctuation\">.</span> o   <span class=\"token range operator\">..</span> o<span class=\"token punctuation\">.</span> o<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>   <span class=\"token punctuation\">.</span> <span class=\"token range operator\">..</span> S   <span class=\"token punctuation\">.</span>  <span class=\"token operator\">+</span>o<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>    o <span class=\"token punctuation\">.</span><span class=\"token operator\">+</span>      <span class=\"token punctuation\">.</span><span class=\"token operator\">+</span>o<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>     <span class=\"token operator\">+</span><span class=\"token operator\">*</span>       o B<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>    <span class=\"token punctuation\">.</span><span class=\"token operator\">+</span><span class=\"token punctuation\">.</span><span class=\"token operator\">+</span>     <span class=\"token punctuation\">.</span> BE<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>   <span class=\"token range operator\">..</span> <span class=\"token operator\">+</span><span class=\"token punctuation\">.</span>      <span class=\"token operator\">=</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">SHA256</span></span><span class=\"token punctuation\">]</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span></code></pre></div>\n<br/>\n<br/>\n<p>키가 잘 만들어 있는지 확인하기 위해서 아래 명령어로 확인합니다. </p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ cd <span class=\"token punctuation\">.</span>ssh\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token punctuation\">.</span>ssh<span class=\"token punctuation\">]</span>$ ls <span class=\"token operator\">-</span>al\ntotal <span class=\"token number\">8</span>\ndrwx<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token punctuation\">.</span> <span class=\"token number\">2</span> h43254 h43254   <span class=\"token number\">38</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">05</span><span class=\"token punctuation\">:</span><span class=\"token number\">31</span> <span class=\"token punctuation\">.</span>\ndrwx<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token punctuation\">.</span> <span class=\"token number\">3</span> h43254 h43254   <span class=\"token number\">74</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">05</span><span class=\"token punctuation\">:</span><span class=\"token number\">28</span> <span class=\"token range operator\">..</span>\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span><span class=\"token punctuation\">.</span> <span class=\"token number\">1</span> h43254 h43254 <span class=\"token number\">1679</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">05</span><span class=\"token punctuation\">:</span><span class=\"token number\">30</span> id_rsa\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span> <span class=\"token number\">1</span> h43254 h43254  <span class=\"token number\">400</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">05</span><span class=\"token punctuation\">:</span><span class=\"token number\">30</span> id_rsa<span class=\"token punctuation\">.</span>pub       ## 정상 생성<span class=\"token punctuation\">.</span></code></pre></div>\n<br/>\n<br/>\n    \n아래 명령어를 통해서 공개키를 복사하고, 나온 명령어를 복사합니다.  \n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token punctuation\">.</span>ssh<span class=\"token punctuation\">]</span>$ cat id_rsa<span class=\"token punctuation\">.</span>pub \nssh<span class=\"token operator\">-</span>rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDMcBYtD<span class=\"token operator\">/</span>NDrxGOyjPJ9DryBOWzoWlVszqI<span class=\"token operator\">+</span>jqSAUeAsZ<span class=\"token operator\">+</span>hwjTtyU60I3vuBn9Ge6HcgKfKUccUyGPickMyTXk2qzeMsa9iN0MOgLZ3GM<span class=\"token comment\">//aFE5z6yoEvjPJ9KxQg9qRrLhUUWqYtBhyegBt26+YdSWF24ZNutp7CRLtVQpwT/opMkY9XTseaD1kaj1BZF8ls2V5WNCgC504JfPKuKBVKcbuOwBIBv6TyZhhGXRWfKTKpma3/L5Yhc4qNOZGDo913/kkwlMpqPb4JQAEasXELfFPMou9vPOaKEK7CDdcJ/EOkXct7d43vnMRa8360okA+BMP7vJ4c4ElW+T0op5rt h43254@nasa-master</span></code></pre></div>\n<br/>\n<br/>\n<p>GCP에 <code class=\"language-text\">공개키를 등록</code>하기 위해서 <code class=\"language-text\">Compute Engine - 메타데이터- SSH</code> 에  서  공개 키를 추가합니다.  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90721321-7e2c8a80-e2f3-11ea-914e-8174cfc57d39.png\" alt=\"스크린샷, 2020-08-20 14-43-15\"></p>\n<p>복사한 키를 넣으면 자동으로 왼쪽에 아이디(여기서는  h43254)이 나타납니다.<br>\n아이디를 확인 한 다음에 저장을 누릅니다. (만약에 나타나지 않았다면 공개키 코드의 띄어쓰기 때문이니 확인해야 합니다)</p>\n<br/>\n<br/>\n<p>메타데이터 정상 확인을 위해 <code class=\"language-text\">NODE1</code>에 접속 후 확인합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>node1 <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ cat <span class=\"token punctuation\">.</span>ssh<span class=\"token operator\">/</span>authorized_keys \n<span class=\"token preprocessor property\"># Added by Google</span>\nssh<span class=\"token operator\">-</span>rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCJjI66r5lO6y<span class=\"token operator\">/</span>3NVCDA9RZt98DCs1LDLL4rScU<span class=\"token operator\">+</span>scCDdIJmEHhqvOSU7bmK<span class=\"token operator\">+</span>a8BezaoqmlQgBWKt0Yj6FqxXyokAs2KBNEJMDA99yTAiyR1omopwsgD7Ce50iUDGs6jWvagPktuUznYyi75hQXoTQKt9FEhjBrpLBxoBZUoBgxa67mkc<span class=\"token operator\">+</span>rn1icoWoKRlAEt1UQzmT13Spx6ueTMYxC5CZIhPlWpTRpe5SthSvuOShv5KZy<span class=\"token operator\">+</span>0ByOycrTUrjDfqIY1zPiOJb5Q92UXbmSbsk2ZEMyD5JCC5kvD4poQBToE<span class=\"token operator\">/</span>mdFcdvfAkta<span class=\"token operator\">/</span>l9qh2qmI8FMHKkelLXM0m82yM0IRStR google<span class=\"token operator\">-</span>ssh <span class=\"token punctuation\">{</span><span class=\"token string\">\"userName\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"h43254@gmail.com\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"expireOn\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"2020-08-20T05:49:24+0000\"</span><span class=\"token punctuation\">}</span>\n<span class=\"token preprocessor property\"># Added by Google</span>\necdsa<span class=\"token operator\">-</span>sha2<span class=\"token operator\">-</span>nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBFwFZIw8RvKf9xUVUx<span class=\"token operator\">+</span>NO3yzwCMFgqTRB2UxxnjqrxImnPWraBpEKdtY4m<span class=\"token operator\">/</span>VIxn9hL26OyF3fD<span class=\"token operator\">+</span>NRGMySo7xlnI<span class=\"token operator\">=</span> google<span class=\"token operator\">-</span>ssh<span class=\"token punctuation\">{</span><span class=\"token string\">\"userName\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"h43254@gmail.com\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"expireOn\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"2020-08-20T05:49:22+0000\"</span><span class=\"token punctuation\">}</span>\n<span class=\"token preprocessor property\"># Added by Google         ###### 정상 등록 확인!!! ######</span>\nssh<span class=\"token operator\">-</span>rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDMcBYtD<span class=\"token operator\">/</span>NDrxGOyjPJ9DryBOWzoWlVszqI<span class=\"token operator\">+</span>jqSAUeAsZ<span class=\"token operator\">+</span>hwjTtyU60I3vuBn9Ge6HcgKfKUccUyGPickMyTXk2qzeMsa9iN0MOgLZ3GM<span class=\"token comment\">//aFE5z6yoEvjPJ9KxQg9qRrLhUUWqYtBhyegBt26+YdSWF24ZNutp7CRLtVQpwT/opMkY9XTseaD1kaj1BZF8ls2V5WNCgC504JfPKuKBVKcbuOwBIBv6TyZhhGXRWfKTKpma3/L5Yhc4qNOZGDo913/kkwlMpqPb4JQAEasXELfFPMou9vPOaKEK7CDdcJ/EOkXct7d43vnMRa8360okA+BMP7vJ4c4ElW+T0op5rt h43254@nasa-master</span>\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>node1 <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ </code></pre></div>\n<br/>\n<p>터미널에서 <code class=\"language-text\">cat .ssh/authorized_keys</code>를 쳐보면 등록된 키를 확인할 수 있습니다.<br>\n자 이제 마스터 &#x3C;-> 노드의 통신이 원활해졌으니 본격적으로 설치를 진행하죠.</p>\n<br/>\n<hr>\n<h2 id=\"-kubespray-설치하기\" style=\"position:relative;\"><a href=\"#-kubespray-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\" aria-label=\" kubespray 설치하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>👍 Kubespray 설치하기</h2>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90722288-85549800-e2f5-11ea-8eb9-aefa22c73f46.png\" alt=\"스크린샷, 2020-08-20 14-57-48\"></p>\n<p>이제 <code class=\"language-text\">Kubespray</code>를 설치해보도록 하겠습니다. Kubespray는 <code class=\"language-text\">Ansible을 기반</code>으로 Kubernetes를 설치하는 도구 입니다.  </p>\n<br/>\n<p>우선 <code class=\"language-text\">Master</code> 인스턴스인 <code class=\"language-text\">nasa-master</code>에서 패키지를 업데이트 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token punctuation\">.</span>ssh<span class=\"token punctuation\">]</span>$ sudo yum update\n<span class=\"token class-name\">Loaded</span> plugins<span class=\"token punctuation\">:</span> fastestmirror\nLoading mirror speeds <span class=\"token keyword\">from</span> cached hostfile\n<span class=\"token operator\">*</span> <span class=\"token keyword\">base</span><span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\n<span class=\"token operator\">*</span> epel<span class=\"token punctuation\">:</span> d2lzkl7pfhq30w<span class=\"token punctuation\">.</span>cloudfront<span class=\"token punctuation\">.</span>net\n<span class=\"token operator\">*</span> extras<span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\n<span class=\"token operator\">*</span> updates<span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\nResolving Dependencies\n<span class=\"token operator\">--</span><span class=\"token operator\">></span> Running transaction check\n<span class=\"token operator\">--</span><span class=\"token operator\">-></span> Package google<span class=\"token operator\">-</span>cloud<span class=\"token operator\">-</span>sdk<span class=\"token punctuation\">.</span>x86_64 <span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">304.0</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span><span class=\"token number\">1</span> will be updated\n<span class=\"token operator\">--</span><span class=\"token operator\">-></span> Package google<span class=\"token operator\">-</span>cloud<span class=\"token operator\">-</span>sdk<span class=\"token punctuation\">.</span>x86_64 <span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">306.0</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span><span class=\"token number\">1</span> will be an update\n<span class=\"token operator\">--</span><span class=\"token operator\">></span> Finished Dependency Resolution\n<span class=\"token range operator\">..</span><span class=\"token range operator\">..</span>\n<span class=\"token range operator\">..</span><span class=\"token range operator\">..</span><span class=\"token punctuation\">(</span>중략<span class=\"token punctuation\">)</span>\nUpdated<span class=\"token punctuation\">:</span>\ngoogle<span class=\"token operator\">-</span>cloud<span class=\"token operator\">-</span>sdk<span class=\"token punctuation\">.</span>x86_64 <span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">306.0</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span><span class=\"token number\">1</span>                                                                                                                                                        \nComplete<span class=\"token operator\">!</span></code></pre></div>\n<br/>\n<br/>\n<p>그리고 <code class=\"language-text\">pip</code>를 설치합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">/</span><span class=\"token punctuation\">]</span>$ sudo yum <span class=\"token operator\">-</span>y install python<span class=\"token operator\">-</span>pip\n<span class=\"token class-name\">Loaded</span> plugins<span class=\"token punctuation\">:</span> fastestmirror\nLoading mirror speeds <span class=\"token keyword\">from</span> cached hostfile\n<span class=\"token operator\">*</span> <span class=\"token keyword\">base</span><span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\n<span class=\"token operator\">*</span> epel<span class=\"token punctuation\">:</span> d2lzkl7pfhq30w<span class=\"token punctuation\">.</span>cloudfront<span class=\"token punctuation\">.</span>net\n<span class=\"token operator\">*</span> extras<span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\n<span class=\"token operator\">*</span> updates<span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\nResolving Dependencies\n<span class=\"token operator\">--</span><span class=\"token operator\">></span> Running transaction check\n<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span>\n<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>중략<span class=\"token punctuation\">)</span>\npython<span class=\"token operator\">-</span>ipaddress<span class=\"token punctuation\">.</span>noarch <span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">1.0</span><span class=\"token number\">.16</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">.</span>el7                                                       \npython<span class=\"token operator\">-</span>setuptools<span class=\"token punctuation\">.</span>noarch <span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">0.9</span><span class=\"token number\">.8</span><span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">.</span>el7                                                       \n\nComplete<span class=\"token operator\">!</span></code></pre></div>\n<br/>\n<br/>\n<p>패키지가 정상적으로 설치되었는지 확인해봅니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">/</span><span class=\"token punctuation\">]</span>$ pip <span class=\"token operator\">--</span>version\npip <span class=\"token number\">8.1</span><span class=\"token number\">.2</span> <span class=\"token keyword\">from</span> <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>lib<span class=\"token operator\">/</span>python2<span class=\"token punctuation\">.</span><span class=\"token number\">7</span><span class=\"token operator\">/</span>site<span class=\"token operator\">-</span>packages <span class=\"token punctuation\">(</span>python <span class=\"token number\">2.7</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br/>\n<br/>\n<p><code class=\"language-text\">git clone</code> 명령어를 통해서 Kubespray File을 다운로드 합니다.  </p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">$ git <span class=\"token class-name\">clone</span> https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>github<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>kubernetes<span class=\"token operator\">-</span>sigs<span class=\"token operator\">/</span>kubespray<span class=\"token punctuation\">.</span>git</code></pre></div>\n<br/>\n<br/>\n<p>다운로드 완료!!</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">/</span><span class=\"token punctuation\">]</span>$ sudo git <span class=\"token class-name\">clone</span> https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>github<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>kubernetes<span class=\"token operator\">-</span>sigs<span class=\"token operator\">/</span>kubespray<span class=\"token punctuation\">.</span>git\nCloning <span class=\"token keyword\">into</span> 'kubespray'<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span>\nremote<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Enumerating</span> objects<span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> done<span class=\"token punctuation\">.</span>\nremote<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Counting</span> objects<span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token operator\">/</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> done<span class=\"token punctuation\">.</span>\nremote<span class=\"token punctuation\">:</span> Total <span class=\"token number\">46404</span> <span class=\"token punctuation\">(</span>delta <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> reused <span class=\"token number\">2</span> <span class=\"token punctuation\">(</span>delta <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> pack<span class=\"token operator\">-</span>reused <span class=\"token number\">46401</span>\n<span class=\"token class-name\">Receiving</span> objects<span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span><span class=\"token number\">46404</span><span class=\"token operator\">/</span><span class=\"token number\">46404</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13.45</span> MiB <span class=\"token operator\">|</span> <span class=\"token number\">6.09</span> MiB<span class=\"token operator\">/</span>s<span class=\"token punctuation\">,</span> <span class=\"token class-name\">done<span class=\"token punctuation\">.</span>\nResolving</span> deltas<span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span><span class=\"token number\">25881</span><span class=\"token operator\">/</span><span class=\"token number\">25881</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> done<span class=\"token punctuation\">.</span></code></pre></div>\n<br/>\n<br/>\n<p>다운받은 설치 파일은 아래와 같습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">$ cd kubespray<span class=\"token operator\">/</span>\n$ ls <span class=\"token operator\">-</span>alrt</code></pre></div>\n<br/>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">/</span><span class=\"token punctuation\">]</span>$ cd <span class=\"token operator\">/</span>kubespray<span class=\"token operator\">/</span>\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ ls <span class=\"token operator\">-</span>alrt \ntotal <span class=\"token number\">184</span>\ndr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span> <span class=\"token number\">18</span> root root   <span class=\"token number\">241</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token range operator\">..</span>\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">285</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>editorconfig\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">832</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>ansible<span class=\"token operator\">-</span>lint\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root     <span class=\"token number\">0</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>nojekyll\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root    <span class=\"token number\">17</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>markdownlint<span class=\"token punctuation\">.</span>yaml\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root     <span class=\"token number\">0</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>gitmodules\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">1980</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>gitlab<span class=\"token operator\">-</span>ci<span class=\"token punctuation\">.</span>yml\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span>  <span class=\"token number\">2</span> root root   <span class=\"token number\">102</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>gitlab<span class=\"token operator\">-</span>ci\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">1192</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>gitignore\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span>  <span class=\"token number\">3</span> root root    <span class=\"token number\">60</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>github\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">289</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>yamllint\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">531</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> SECURITY_CONTACTS\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">3272</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> RELEASE<span class=\"token punctuation\">.</span>md\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root <span class=\"token number\">12328</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> README<span class=\"token punctuation\">.</span>md\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">283</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> OWNERS_ALIASES\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">121</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> OWNERS\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root    <span class=\"token number\">85</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> Makefile\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root <span class=\"token number\">11342</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> LICENSE\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">969</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> Dockerfile\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">1661</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> CONTRIBUTING<span class=\"token punctuation\">.</span>md\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root    <span class=\"token number\">12</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> CNAME\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root <span class=\"token number\">10127</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> Vagrantfile\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root    <span class=\"token number\">30</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> _config<span class=\"token punctuation\">.</span>yml\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">148</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> code<span class=\"token operator\">-</span>of<span class=\"token operator\">-</span>conduct<span class=\"token punctuation\">.</span>md\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">4526</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> cluster<span class=\"token punctuation\">.</span>yml\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">412</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> ansible_version<span class=\"token punctuation\">.</span>yml\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">927</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> ansible<span class=\"token punctuation\">.</span>cfg\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span> <span class=\"token number\">13</span> root root   <span class=\"token number\">193</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> contrib\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span>  <span class=\"token number\">4</span> root root    <span class=\"token number\">33</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> inventory\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">1468</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> index<span class=\"token punctuation\">.</span>html\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">484</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> facts<span class=\"token punctuation\">.</span>yml\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span>  <span class=\"token number\">3</span> root root   <span class=\"token number\">115</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> extra_playbooks\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span>  <span class=\"token number\">5</span> root root  <span class=\"token number\">4096</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> docs\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span>  <span class=\"token number\">2</span> root root    <span class=\"token number\">21</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> library\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root    <span class=\"token number\">94</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> requirements<span class=\"token punctuation\">.</span>txt\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">1705</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token keyword\">remove</span><span class=\"token operator\">-</span>node<span class=\"token punctuation\">.</span>yml\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">612</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> recover<span class=\"token operator\">-</span>control<span class=\"token operator\">-</span>plane<span class=\"token punctuation\">.</span>yml\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">1172</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> mitogen<span class=\"token punctuation\">.</span>yml\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span>  <span class=\"token number\">2</span> root root  <span class=\"token number\">4096</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> logo\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">726</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> reset<span class=\"token punctuation\">.</span>yml\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">2608</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> scale<span class=\"token punctuation\">.</span>yml\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span> <span class=\"token number\">17</span> root root  <span class=\"token number\">4096</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> roles\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">693</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> setup<span class=\"token punctuation\">.</span>py\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">1663</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> setup<span class=\"token punctuation\">.</span>cfg</code></pre></div>\n<br/>\n<br/>\n<p><code class=\"language-text\">requirements.txt</code>에 필요한 패키지들이 명시되어 있는데 이를 이용해 패키지 설치를 진행합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ sudo pip install <span class=\"token operator\">-</span>r requirements<span class=\"token punctuation\">.</span>txt\n<span class=\"token class-name\">Collecting</span> ansible<span class=\"token operator\">==</span><span class=\"token number\">2.9</span><span class=\"token number\">.6</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">from</span> <span class=\"token operator\">-</span><span class=\"token return-type class-name\">r</span> requirements<span class=\"token punctuation\">.</span>txt <span class=\"token punctuation\">(</span>line <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token class-name\">Downloading</span> https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>files<span class=\"token punctuation\">.</span>pythonhosted<span class=\"token punctuation\">.</span>org<span class=\"token operator\">/</span>packages<span class=\"token operator\">/</span>ae<span class=\"token operator\">/</span>b7<span class=\"token operator\">/</span>c717363f767f7af33d90af9458d5f1e0960\ndb9c2393a6c221c2ce97ad1aa<span class=\"token operator\">/</span>ansible<span class=\"token operator\">-</span><span class=\"token number\">2.9</span><span class=\"token number\">.6</span><span class=\"token punctuation\">.</span>tar<span class=\"token punctuation\">.</span>gz <span class=\"token punctuation\">(</span><span class=\"token number\">14</span><span class=\"token punctuation\">.</span>2MB<span class=\"token punctuation\">)</span>\n    <span class=\"token number\">100</span><span class=\"token operator\">%</span> <span class=\"token operator\">|</span>████████████████████████████████<span class=\"token operator\">|</span> <span class=\"token number\">14</span><span class=\"token punctuation\">.</span>2MB 75kB<span class=\"token operator\">/</span>s \n<span class=\"token class-name\">Collecting</span> jinja2<span class=\"token operator\">==</span><span class=\"token number\">2.11</span><span class=\"token number\">.1</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">from</span> <span class=\"token operator\">-</span><span class=\"token return-type class-name\">r</span> requirements<span class=\"token punctuation\">.</span>txt <span class=\"token punctuation\">(</span>line <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token class-name\">Downloading</span> https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>files<span class=\"token punctuation\">.</span>pythonhosted<span class=\"token punctuation\">.</span>org<span class=\"token operator\">/</span>packages<span class=\"token operator\">/</span><span class=\"token number\">27</span><span class=\"token operator\">/</span><span class=\"token number\">24</span><span class=\"token operator\">/</span>4f35961e5c669e96f6559760042a55b9bcf\n<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span>\n<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>중략<span class=\"token punctuation\">)</span>\n8e2a0ecf73d21d6b85865da11<span class=\"token operator\">/</span>MarkupSafe<span class=\"token operator\">-</span><span class=\"token number\">1.1</span><span class=\"token number\">.1</span><span class=\"token operator\">-</span>cp27<span class=\"token operator\">-</span>cp27mu<span class=\"token operator\">-</span>manylinux1_x86_64<span class=\"token punctuation\">.</span>whl\nCollecting ruamel<span class=\"token punctuation\">.</span>ordereddict<span class=\"token punctuation\">;</span> platform_python_implementation <span class=\"token operator\">==</span> <span class=\"token string\">\"CPython\"</span> <span class=\"token keyword\">and</span> python_version <span class=\"token operator\">&lt;</span>\n<span class=\"token operator\">=</span> <span class=\"token string\">\"2.7\"</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">from</span> ruamel<span class=\"token punctuation\">.</span>yaml<span class=\"token operator\">==</span><span class=\"token number\">0.16</span><span class=\"token number\">.10</span><span class=\"token operator\">-></span><span class=\"token operator\">-</span><span class=\"token return-type class-name\">r</span> requirements<span class=\"token punctuation\">.</span>txt <span class=\"token punctuation\">(</span>line <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token class-name\">Downloading</span> https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>files<span class=\"token punctuation\">.</span>pythonhosted<span class=\"token punctuation\">.</span>org<span class=\"token operator\">/</span>packages<span class=\"token operator\">/</span>8c<span class=\"token operator\">/</span>d6<span class=\"token operator\">/</span>4971e55c60b972160b911368fa4cd756d68\n739b6616b0cb57d09d8a6ee18<span class=\"token operator\">/</span>ruamel<span class=\"token punctuation\">.</span>ordereddict<span class=\"token operator\">-</span><span class=\"token number\">0.4</span><span class=\"token number\">.14</span><span class=\"token operator\">-</span>cp27<span class=\"token operator\">-</span>cp27mu<span class=\"token operator\">-</span>manylinux1_x86_64<span class=\"token punctuation\">.</span>whl <span class=\"token punctuation\">(</span>93kB<span class=\"token punctuation\">)</span>\n    <span class=\"token number\">100</span><span class=\"token operator\">%</span> <span class=\"token operator\">|</span>████████████████████████████████<span class=\"token operator\">|</span> 102kB <span class=\"token number\">9</span><span class=\"token punctuation\">.</span>2MB<span class=\"token operator\">/</span>s </code></pre></div>\n<br/>\n<br/>\n<p>이 후 정상적으로 <code class=\"language-text\">ansible</code>이 설치된 것을 확인 할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ ansible <span class=\"token operator\">--</span>version\n<span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>lib64<span class=\"token operator\">/</span>python2<span class=\"token punctuation\">.</span><span class=\"token number\">7</span><span class=\"token operator\">/</span>site<span class=\"token operator\">-</span>packages<span class=\"token operator\">/</span>cryptography<span class=\"token operator\">/</span>__init__<span class=\"token punctuation\">.</span>py<span class=\"token punctuation\">:</span><span class=\"token number\">39</span><span class=\"token punctuation\">:</span> CryptographyDeprecationWarning<span class=\"token punctuation\">:</span> Python <span class=\"token number\">2</span> <span class=\"token keyword\">is</span> <span class=\"token class-name\">no</span> longer supported <span class=\"token keyword\">by</span> the Python core team<span class=\"token punctuation\">.</span> Support <span class=\"token keyword\">for</span> it <span class=\"token keyword\">is</span> <span class=\"token class-name\">now</span> <span class=\"token class-name\">deprecated</span> incryptography<span class=\"token punctuation\">,</span> <span class=\"token keyword\">and</span> will <span class=\"token class-name\">be</span> removed <span class=\"token keyword\">in</span> a future release<span class=\"token punctuation\">.</span>\nCryptographyDeprecationWarning<span class=\"token punctuation\">,</span>\nansible <span class=\"token number\">2.9</span><span class=\"token number\">.6</span>\n<span class=\"token class-name\">config</span> file <span class=\"token operator\">=</span> <span class=\"token operator\">/</span>kubespray<span class=\"token operator\">/</span>ansible<span class=\"token punctuation\">.</span>cfg\nconfigured module <span class=\"token class-name\">search</span> path <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>u'<span class=\"token operator\">/</span>kubespray<span class=\"token operator\">/</span>library'<span class=\"token punctuation\">]</span>\nansible python <span class=\"token class-name\">module</span> location <span class=\"token operator\">=</span> <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>lib<span class=\"token operator\">/</span>python2<span class=\"token punctuation\">.</span><span class=\"token number\">7</span><span class=\"token operator\">/</span>site<span class=\"token operator\">-</span>packages<span class=\"token operator\">/</span>ansible\n<span class=\"token class-name\">executable</span> location <span class=\"token operator\">=</span> <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span>ansible\n<span class=\"token class-name\">python</span> version <span class=\"token operator\">=</span> <span class=\"token number\">2.7</span><span class=\"token number\">.5</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">default</span><span class=\"token punctuation\">,</span> Apr  <span class=\"token number\">2</span> <span class=\"token number\">2020</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">:</span><span class=\"token number\">16</span><span class=\"token punctuation\">:</span><span class=\"token number\">51</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>GCC <span class=\"token number\">4.8</span><span class=\"token number\">.5</span> <span class=\"token number\">20150623</span> <span class=\"token punctuation\">(</span>Red Hat <span class=\"token number\">4.8</span><span class=\"token number\">.5</span><span class=\"token operator\">-</span><span class=\"token number\">39</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></code></pre></div>\n<br/>\n<br/>\n<p>이어서 기본 <code class=\"language-text\">inventory/sample</code>을 <code class=\"language-text\">inventory/mycluster</code> 로 복사합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ cp <span class=\"token operator\">-</span>rfp inventory<span class=\"token operator\">/</span>sample inventory<span class=\"token operator\">/</span><span class=\"token class-name\">cluster</span>\ncp<span class=\"token punctuation\">:</span> cannot create directory ‘inventory<span class=\"token operator\">/</span>mycluster’<span class=\"token punctuation\">:</span> Permission denied\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ sudo cp <span class=\"token operator\">-</span>rfp inventory<span class=\"token operator\">/</span>sample inventory<span class=\"token operator\">/</span>mycluster\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ ls <span class=\"token operator\">-</span>alrt inventory<span class=\"token operator\">/</span>mycluster<span class=\"token operator\">/</span>\ntotal <span class=\"token number\">4</span>\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span> <span class=\"token number\">4</span> root root  <span class=\"token number\">52</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> group_vars\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span> <span class=\"token number\">1</span> root root <span class=\"token number\">994</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> inventory<span class=\"token punctuation\">.</span>ini\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span> <span class=\"token number\">3</span> root root  <span class=\"token number\">45</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span> <span class=\"token number\">5</span> root root  <span class=\"token number\">50</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">45</span> <span class=\"token range operator\">..</span></code></pre></div>\n<p>inventory를 복사할 디렉토리 이름은 아무이름이나 설정해도 됩니다.</p>\n<br/>\n<br/>\n<p>디렉토리의 <code class=\"language-text\">tree 구조</code>를 보기 위해서 tree 패키지를 설치합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ \n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ sudo yum <span class=\"token operator\">-</span>y install tree\n<span class=\"token class-name\">Loaded</span> plugins<span class=\"token punctuation\">:</span> fastestmirror\nLoading mirror speeds <span class=\"token keyword\">from</span> cached hostfile\n<span class=\"token operator\">*</span> <span class=\"token keyword\">base</span><span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\n<span class=\"token operator\">*</span> epel<span class=\"token punctuation\">:</span> d2lzkl7pfhq30w<span class=\"token punctuation\">.</span>cloudfront<span class=\"token punctuation\">.</span>net\n<span class=\"token operator\">*</span> extras<span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\n<span class=\"token operator\">*</span> updates<span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\nResolving Dependencies\n<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span>\n<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>중략<span class=\"token punctuation\">)</span>\nTransaction test succeeded\nRunning <span class=\"token class-name\">transaction</span>\nInstalling <span class=\"token punctuation\">:</span> tree<span class=\"token operator\">-</span><span class=\"token number\">1.6</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">.</span>el7<span class=\"token punctuation\">.</span>x86_64                                                    <span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">1</span> \nVerifying  <span class=\"token punctuation\">:</span> tree<span class=\"token operator\">-</span><span class=\"token number\">1.6</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">.</span>el7<span class=\"token punctuation\">.</span>x86_64                                                    <span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">1</span> \nInstalled<span class=\"token punctuation\">:</span>\ntree<span class=\"token punctuation\">.</span>x86_64 <span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">1.6</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">.</span>el7                                                                   \nComplete<span class=\"token operator\">!</span></code></pre></div>\n<br/>\n<br/>\n<p><code class=\"language-text\">tree</code>로 <code class=\"language-text\">group_vars 디렉토리</code>를 보면 설치에 필요한 <code class=\"language-text\">yml 파일</code>이 있는걸 볼 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ tree inventory<span class=\"token operator\">/</span>cluster<span class=\"token operator\">/</span>group_vars\ninventory<span class=\"token operator\">/</span>mycluster<span class=\"token operator\">/</span>group_vars\n├── all\n│   ├── all<span class=\"token punctuation\">.</span>yml\n│   ├── aws<span class=\"token punctuation\">.</span>yml\n│   ├── azure<span class=\"token punctuation\">.</span>yml\n│   ├── containerd<span class=\"token punctuation\">.</span>yml\n│   ├── coreos<span class=\"token punctuation\">.</span>yml\n│   ├── docker<span class=\"token punctuation\">.</span>yml\n│   ├── gcp<span class=\"token punctuation\">.</span>yml\n│   ├── oci<span class=\"token punctuation\">.</span>yml\n│   ├── openstack<span class=\"token punctuation\">.</span>yml\n│   └── vsphere<span class=\"token punctuation\">.</span>yml\n├── etcd<span class=\"token punctuation\">.</span>yml\n└── k8s<span class=\"token operator\">-</span>cluster\n    ├── addons<span class=\"token punctuation\">.</span>yml\n    ├── k8s<span class=\"token operator\">-</span>cluster<span class=\"token punctuation\">.</span>yml\n    ├── k8s<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>calico<span class=\"token punctuation\">.</span>yml\n    ├── k8s<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>canal<span class=\"token punctuation\">.</span>yml\n    ├── k8s<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>cilium<span class=\"token punctuation\">.</span>yml\n    ├── k8s<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>contiv<span class=\"token punctuation\">.</span>yml\n    ├── k8s<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>flannel<span class=\"token punctuation\">.</span>yml\n    ├── k8s<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>kube<span class=\"token operator\">-</span>router<span class=\"token punctuation\">.</span>yml\n    ├── k8s<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>macvlan<span class=\"token punctuation\">.</span>yml\n    └── k8s<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>weave<span class=\"token punctuation\">.</span>yml\n<span class=\"token number\">2</span> directories<span class=\"token punctuation\">,</span> <span class=\"token number\">21</span> files</code></pre></div>\n<br/>\n<br/>\n<p>설치를 위해 <code class=\"language-text\">inventory.ini</code>를 수정합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">vi inventory<span class=\"token operator\">/</span>mycluster<span class=\"token operator\">/</span>inventory<span class=\"token punctuation\">.</span>ini</code></pre></div>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90841465-b7b6d180-e397-11ea-9c8b-a129f1e9b5ce.png\" alt=\"스크린샷, 2020-08-21 10-18-49\"></p>\n<ul>\n<li><code class=\"language-text\">[all]</code> 그룹에는 인스턴스의 내부 아이피를 입력합니다  </li>\n<li><code class=\"language-text\">[kube-master]</code> 그룹에는 마스터로 사용할 인스턴스 명을 넣습니다.</li>\n<li><code class=\"language-text\">[etcd]</code> 그룹에는 etcd를 사용할 인스턴스를 입력합니다 (홀수)</li>\n<li><code class=\"language-text\">[kube-node]</code> 그룹에는 노드로 사용 할 인스턴스 명을 넣습니다.</li>\n</ul>\n<br/>\n<br/>\n<p><code class=\"language-text\">SSH KEY</code>를 한번 사용해서 마스터와 동기화 시켜줍니다</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ ssh h43254@nasa<span class=\"token operator\">-</span>node1\n<span class=\"token class-name\">Last</span> login<span class=\"token punctuation\">:</span> Thu Aug <span class=\"token number\">20</span> <span class=\"token number\">09</span><span class=\"token punctuation\">:</span><span class=\"token number\">12</span><span class=\"token punctuation\">:</span><span class=\"token number\">40</span> <span class=\"token number\">2020</span> <span class=\"token keyword\">from</span> nasa<span class=\"token operator\">-</span>master<span class=\"token punctuation\">.</span>asia<span class=\"token operator\">-</span>northeast3<span class=\"token operator\">-</span>a<span class=\"token punctuation\">.</span>c<span class=\"token punctuation\">.</span>nasa1515<span class=\"token punctuation\">.</span><span class=\"token keyword\">internal</span>\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>node1 <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ exit\nlogout\nConnection to nasa<span class=\"token operator\">-</span>node1 closed<span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ ssh h43254@nasa<span class=\"token operator\">-</span>node2\nThe authenticity of host 'nasa<span class=\"token operator\">-</span>node2 <span class=\"token punctuation\">(</span><span class=\"token number\">10.178</span><span class=\"token number\">.0</span><span class=\"token number\">.5</span><span class=\"token punctuation\">)</span>' can't be established<span class=\"token punctuation\">.</span>\nECDSA key fingerprint <span class=\"token keyword\">is</span> <span class=\"token class-name\">SHA256</span><span class=\"token punctuation\">:</span><span class=\"token operator\">+</span>Pcsu6s4ImB0kob1TZ41ieS8wz2drCalVIVzBawpRlk<span class=\"token punctuation\">.</span>\nECDSA key fingerprint <span class=\"token keyword\">is</span> <span class=\"token class-name\">MD5</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span><span class=\"token punctuation\">:</span>6a<span class=\"token punctuation\">:</span><span class=\"token number\">41</span><span class=\"token punctuation\">:</span><span class=\"token number\">28</span><span class=\"token punctuation\">:</span>c8<span class=\"token punctuation\">:</span>5a<span class=\"token punctuation\">:</span><span class=\"token number\">77</span><span class=\"token punctuation\">:</span>3e<span class=\"token punctuation\">:</span><span class=\"token number\">04</span><span class=\"token punctuation\">:</span><span class=\"token number\">7d</span><span class=\"token punctuation\">:</span><span class=\"token number\">88</span><span class=\"token punctuation\">:</span>1e<span class=\"token punctuation\">:</span><span class=\"token number\">14</span><span class=\"token punctuation\">:</span><span class=\"token number\">44</span><span class=\"token punctuation\">:</span>d8<span class=\"token punctuation\">:</span><span class=\"token number\">14</span><span class=\"token punctuation\">.</span>\nAre you sure you want to <span class=\"token keyword\">continue</span> connecting <span class=\"token punctuation\">(</span>yes<span class=\"token operator\">/</span>no<span class=\"token punctuation\">)</span><span class=\"token punctuation\">?</span> <span class=\"token class-name\">yes</span>\nWarning<span class=\"token punctuation\">:</span> Permanently added 'nasa<span class=\"token operator\">-</span>node2' <span class=\"token punctuation\">(</span>ECDSA<span class=\"token punctuation\">)</span> to the list of known <span class=\"token class-name\">hosts<span class=\"token punctuation\">.</span>\nLast</span> login<span class=\"token punctuation\">:</span> Thu Aug <span class=\"token number\">20</span> <span class=\"token number\">09</span><span class=\"token punctuation\">:</span><span class=\"token number\">12</span><span class=\"token punctuation\">:</span><span class=\"token number\">40</span> <span class=\"token number\">2020</span> <span class=\"token keyword\">from</span> nasa<span class=\"token operator\">-</span>master<span class=\"token punctuation\">.</span>asia<span class=\"token operator\">-</span>northeast3<span class=\"token operator\">-</span>a<span class=\"token punctuation\">.</span>c<span class=\"token punctuation\">.</span>nasa1515<span class=\"token punctuation\">.</span><span class=\"token keyword\">internal</span>\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>node2 <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ exit\nlogout\nConnection to nasa<span class=\"token operator\">-</span>node2 closed<span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ ssh h43254@nasa<span class=\"token operator\">-</span>node3\n<span class=\"token class-name\">Last</span> login<span class=\"token punctuation\">:</span> Fri Aug <span class=\"token number\">21</span> <span class=\"token number\">00</span><span class=\"token punctuation\">:</span><span class=\"token number\">43</span><span class=\"token punctuation\">:</span><span class=\"token number\">40</span> <span class=\"token number\">2020</span> <span class=\"token keyword\">from</span> <span class=\"token number\">35.235</span><span class=\"token number\">.240</span><span class=\"token number\">.229</span>\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>node3 <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ exit\nlogout\nConnection to nasa<span class=\"token operator\">-</span>node3 closed<span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ </code></pre></div>\n<p>위와 같이 <code class=\"language-text\">ssh</code>로 한번씩 접속만 해주면 됩니다.</p>\n<br/>\n<br/>\n<p>모두 완료 되었으면 필요로 하는 <code class=\"language-text\">의존성 및 설정</code>을 세팅합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">$ ansible<span class=\"token operator\">-</span>playbook <span class=\"token operator\">-</span>i kubespray<span class=\"token operator\">/</span>inventory<span class=\"token operator\">/</span>cluster<span class=\"token operator\">/</span>inventory<span class=\"token punctuation\">.</span>ini <span class=\"token operator\">-</span>v <span class=\"token operator\">--</span>become <span class=\"token operator\">--</span>become<span class=\"token operator\">-</span>user<span class=\"token operator\">=</span>root kubespray<span class=\"token operator\">/</span>cluster<span class=\"token punctuation\">.</span>yml</code></pre></div>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90844636-5692fc00-e39f-11ea-9bce-2d1bea280a1c.png\" alt=\"스크린샷, 2020-08-21 11-11-23\">\n<code class=\"language-text\">skipped</code>이 많긴하지만 여러 테스트를 하며 설치를 해서 상관없습니다</p>\n<br/>\n<br/>\n<p>간혹가다 다음과 같은 에러가 발생할 경우에는 디렉토리를 수동으로 생성해주면 됩니다</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90846348-e71f0b80-e3a2-11ea-91c9-ffecd03462cb.png\" alt=\"스크린샷, 2020-08-21 10-42-48\"></p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">sudo mkdir credentials</code></pre></div>\n<br/>\n<br/>\n<p>설치가 완료되고 <code class=\"language-text\">root 권한</code>으로 <code class=\"language-text\">노드 정보</code>를 정상적으로 받아옴을 확인합니다  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90846161-91e2fa00-e3a2-11ea-86e4-cbaf96a90258.png\" alt=\"스크린샷, 2020-08-21 11-36-30\"></p>\n<hr>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#-%EC%82%AC%EC%A0%84%EC%A4%80%EB%B9%84\">✔ 사전준비</a></li>\n<li>\n<p><a href=\"#-%EA%B5%AC%EC%84%B1-install\">✌ 구성 (Install)</a></p>\n<ul>\n<li><a href=\"#kubespray-%EB%A1%9C-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\">Kubespray 로 환경 설정하기</a></li>\n<li><a href=\"#%EC%84%A4%EC%B9%98-%EC%A0%84-%EC%82%AC%EC%A0%84-%EC%9E%91%EC%97%85\">설치 전 사전 작업</a></li>\n<li><a href=\"#%EC%84%A4%EC%B9%98-%EC%A7%84%ED%96%89\">설치 진행</a></li>\n</ul>\n</li>\n<li><a href=\"#-kubespray-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\">👍 Kubespray 설치하기</a></li>\n</ul>\n</div>","excerpt":"머리말   쿠버네티스 환경을 구성하는 방법은 여러가지가 존재합니다 서버를 준비하는 방법은 또한 여러 가지가 있겠지만 가장 쉽게 생각해볼 수 있는 건  와  를 이용한 로 구성하는 것 입니다. 하지만 이번 포스트에서는 GCP STUDY + Kubernetes STUDY 겸 GCP로 진행했습니다. 사실 GCP 무료 크레딧이 아까운 마음이 더 크긴 했습니다. ✔ 사전준비 쿠버네티스는 3개월 마다 새로운 버전이 릴리즈 되고 해당 버전은 9개월 동안 버그와 보안 이슈를 수정하는 패치가 이루어 집니다.   이번 포스트에 구성할 노드는 와 로 총 의 서버가 필요합니다. 노드의 최소 요구 사양은 다음과 같습니다. 항목 사양 CPU …","frontmatter":{"date":"June 29, 2021","title":"[Kubernetes] - Kubernetes 환경구성 on GCP Using KubeSpary","categories":"Kubernetes GCP","author":"nasa1515","emoji":"🤦‍♂️"},"fields":{"slug":"/kubetnetes-kubespary/"}},"next":{"id":"5355c631-7fe6-5aa1-b88f-9fb739c067bf","html":"<p>머리말  </p>\n<p> 쿠버네티스… 이름만 많이 들어보고 많이 사용하는 기술이라고만 들었다.<br>\n하지만 온프레미스 경험만 가지고 있는 나는 아무것도 알지 못한다.  아마도 포스트를 작성하면서 조금씩 익숙해질 것이라고 생각한다.<br>\n마지막 포스트를 쓸 때 쯤에는 초급정도의 스킬은 가지고 있었으면 싶다.  </p>\n<hr>\n<p> 참고 블로그 : <a href=\"https://subicura.com/2019/05/19/kubernetes-basic-1.html\">https://subicura.com/2019/05/19/kubernetes-basic-1.html</a></p>\n<hr>\n<h2 id=\"-쿠버네티스란\" style=\"position:relative;\"><a href=\"#-%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%EB%9E%80\" aria-label=\" 쿠버네티스란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✔ 쿠버네티스란??</h2>\n<p><img src=\"https://subicura.com/assets/article_images/2019-05-19-kubernetes-basic-1/kubernetes-logo.png\"></p>\n<ul>\n<li>쿠버네티스는 컨테이너를 쉽고 빠르게 <code class=\"language-text\">배포/확장하고 관리를 자동화</code>해주는 오픈소스 플랫폼입니다.  </li>\n<li>보통 k8s 또는 큐브 (kube) 라고 줄여서 부릅니다.</li>\n<li>현재는 단순한 컨테이너 플랫폼이 아닌 <code class=\"language-text\">마이크로서비스</code>, <code class=\"language-text\">클라우드 플랫폼</code>을 지향하고<br>\n컨테이너로 이루어진 것들을 손쉽게 담고 관리할 수 있는 그릇 역할을 합니다.<br>\n서버리스, CI/CD, 머신러닝 등 다양한 기능이 쿠버네티스 플랫폼 위에서 동작합니다.</li>\n</ul>\n<br/>\n<h2 id=\"-대표적인-쿠버네티스의-기능들\" style=\"position:relative;\"><a href=\"#-%EB%8C%80%ED%91%9C%EC%A0%81%EC%9D%B8-%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%EC%9D%98-%EA%B8%B0%EB%8A%A5%EB%93%A4\" aria-label=\" 대표적인 쿠버네티스의 기능들 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✌ 대표적인 쿠버네티스의 기능들</h2>\n<h3 id=\"쿠버네티스의-배포-방식\" style=\"position:relative;\"><a href=\"#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%EC%9D%98-%EB%B0%B0%ED%8F%AC-%EB%B0%A9%EC%8B%9D\" aria-label=\"쿠버네티스의 배포 방식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>쿠버네티스의 배포 방식</h3>\n<p><img src=\"https://subicura.com/assets/article_images/2019-05-19-kubernetes-basic-1/workload.png\"></p>\n<ul>\n<li>컨테이너와 관련된 많은 예제가 <code class=\"language-text\">웹(프론트엔드+백엔드)</code> 애플리케이션을 다루고 있지만 실제론 더 다양한 형태의 APP이 있습니다.<br>\n쿠버네티스는 <code class=\"language-text\">Deployment</code>, <code class=\"language-text\">StatefulSets</code>, <code class=\"language-text\">DaemonSet</code>, <code class=\"language-text\">Job</code>, <code class=\"language-text\">CronJob</code>등 다양한 배포 방식을 지원합니다.  </li>\n<li><code class=\"language-text\">Deployment</code>는 새로운 버전의 애플리케이션을 다양한 전략으로 무중단 배포할 수 있습니다. </li>\n<li><code class=\"language-text\">StatefulSets</code>은 실행 순서를 보장하고 호스트 이름과 볼륨을 일정하게<br>\n사용할 수 있어 순서나 데이터가 중요한 경우에 사용할 수 있습니다. </li>\n<li><code class=\"language-text\">DaemonSet</code>은 로그나 모니터링 등 모든 노드에 설치가 필요한 경우에 사용 할 수 있습니다.</li>\n<li><code class=\"language-text\">Job, CronJob</code>을 이용해 배치성 작업을 할 수도 있습니다.</li>\n</ul>\n<br/>\n<h3 id=\"cloud-지원\" style=\"position:relative;\"><a href=\"#cloud-%EC%A7%80%EC%9B%90\" aria-label=\"cloud 지원 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CLOUD 지원</h3>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90616176-12411800-e248-11ea-8e9e-b79e49051a66.png\" alt=\"스크린샷, 2020-08-19 18-16-09\"></p>\n<ul>\n<li>쿠버네티스는 부하에 따라 자동으로 서버를 늘리는 기능 <code class=\"language-text\">AutoScaling</code> 기능을 가지고 있으며 LoadBalancer로 사용할 수 있습니다. </li>\n<li>외부 스토리지를 컨테이너 내부에 마운트해 사용도 가능한데 이를 위해 클라우드 별로 적절한 API를 사용하는 모듈이 필요합니다.</li>\n<li>쿠버네티스는 <code class=\"language-text\">Cloud Controller</code>를 이용하여 클라우드 연동을 손쉽게 확장할 수 있습니다.<br>\n<code class=\"language-text\">AWS, GCP, AZURE</code>는 물론 <code class=\"language-text\">다양한 모듈</code>을 제공해 동일한 설정 파일을 서로 다른 클라우드에서 동일하게 사용할 수 있습니다.</li>\n</ul>\n<br/>\n<h3 id=\"namespace--label\" style=\"position:relative;\"><a href=\"#namespace--label\" aria-label=\"namespace  label permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NAMESPACE &#x26; LABEL</h3>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90703714-722bd300-e2c9-11ea-927f-e4e2e4fdc719.png\" alt=\"스크린샷, 2020-08-20 09-42-17\"></p>\n<ul>\n<li>쿠버네티스에서는 1개의 클러스터를 <code class=\"language-text\">논리적으로 구분</code>하여 사용할 수 있습니다. </li>\n<li>하나의 클러스터에 다양한 프레임워크와 애플리케이션을 설치하기 때문에 기본(system, default)외에 여러 개의 네임스페이스를 사용하는 것이 당연합니다.   </li>\n<li>더 세부적으로 <code class=\"language-text\">라벨 기능</code>을 적극적으로 사용하여 유연하고, 확장성 있게 리소스를 관리할 수 있습니다.</li>\n</ul>\n<br/>\n<h3 id=\"auto-scaling\" style=\"position:relative;\"><a href=\"#auto-scaling\" aria-label=\"auto scaling permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Auto Scaling</h3>\n<p>k8s는 <code class=\"language-text\">CPU</code>, <code class=\"language-text\">memory</code> 사용량에 따른 확장은 기본이고 현재 접속자 수와 같은 값을 사용할 수도 있습니다.  </p>\n<p>총 세개의 방식이 대표적인데 아래와 같습니다.  </p>\n<ul>\n<li><code class=\"language-text\">Horizontal Pod Autoscaler(HPA)</code> : 컨테이너의 개수를 조정\n<img src=\"https://user-images.githubusercontent.com/69498804/90703962-23326d80-e2ca-11ea-934d-86b32cfdd145.png\" alt=\"스크린샷, 2020-08-20 09-47-14\"></li>\n</ul>\n<br/>\n<ul>\n<li><code class=\"language-text\">Vertical Pod Autoscaler(VPA)</code>: 컨테이너의 리소스 할당량을 조정\n<img src=\"https://user-images.githubusercontent.com/69498804/90704099-8f14d600-e2ca-11ea-9e20-1cd1837fa9b2.png\" alt=\"스크린샷, 2020-08-20 09-50-15\"></li>\n</ul>\n<br/>\n<ul>\n<li><code class=\"language-text\">Cluster Autosclaer(CA)</code> : 서버 개수(노드 수) 를 조정 </li>\n</ul>\n<br/>\n<h3 id=\"쿠버네티스의-단점\" style=\"position:relative;\"><a href=\"#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%EC%9D%98-%EB%8B%A8%EC%A0%90\" aria-label=\"쿠버네티스의 단점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>쿠버네티스의 단점</h3>\n<ul>\n<li>컨테이너라는 개념조차도 처음 접해보는 초보자에게는 <code class=\"language-text\">쿠버네티스</code>는 복잡하고 초반 개념을 이해하기 매우 어렵습니다.</li>\n<li><code class=\"language-text\">YAML 설정 파일</code>은 매우 많고 클러스터를 만드는 것도 쉽지 않습니다. </li>\n<li>즉 오래동안 사용해보지 않는 사람을 제외한 초기사용자에겐 진입장벽이 높습니다</li>\n</ul>\n<hr>\n<h2 id=\"-쿠버네티스의-기본-로직-및-개념\" style=\"position:relative;\"><a href=\"#-%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%EC%9D%98-%EA%B8%B0%EB%B3%B8-%EB%A1%9C%EC%A7%81-%EB%B0%8F-%EA%B0%9C%EB%85%90\" aria-label=\" 쿠버네티스의 기본 로직 및 개념 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✌ 쿠버네티스의 기본 로직, 및 개념</h2>\n<ul>\n<li>\n<p><code class=\"language-text\">Desired State</code></p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90704590-e10a2b80-e2cb-11ea-95dd-9553e597fd69.png\" alt=\"스크린샷, 2020-08-20 09-59-42\"></p>\n</li>\n<li><code class=\"language-text\">k8s</code>에서 가장 중요한 것은 <code class=\"language-text\">desired state</code> - <code class=\"language-text\">원하는 상태</code> 라는 개념이라고 합니다.  </li>\n</ul>\n<br/>\n<ul>\n<li><code class=\"language-text\">원하는 상태</code>라 함은 관리자가 원하는 환경을 의미하고<br>\n구체적으로는 몇대의 웹서버가 떠 있으면 좋은지, 몇 번 포트를 사용하길 원하는지 등을 말합니다.</li>\n</ul>\n<br/>\n<ul>\n<li>k8s는 복잡한 작업을 하지만 자세히 들여다보면 <code class=\"language-text\">현재 상태 (current state)</code>를 모니터링하면서<br>\n관리자가 설정한 상태를 유지하려 내부적으로 작업을 하는 로직을 가지고 있습니다.</li>\n</ul>\n<br/>\n<ul>\n<li>이 개념 때문에 관리자가 배포할 때 직접적인 동작을 명령하지 않고 상태를 선언하는 방식을 사용합니다.</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>예를 들어 “nginx 컨테이너를 실행해줘. 그리고 80 포트로 오픈해줘라는 것은”  </p>\n<ul>\n<li><code class=\"language-text\">명령(imperative)</code> :  nginx 컨테이너 실행, 80포트로 서비스 (현재 상태 변경)</li>\n<li><code class=\"language-text\">선언(declarative)</code> : 80 포트를 오픈한 nginx 컨테이너를 1개 유지해</li>\n</ul>\n</li>\n<li>\n<p>말로 풀어쓰니깐 약간 이해가 안되는데 아래의 <code class=\"language-text\">CLI</code> 명령을 보면 이해가 될 것입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ docker run                    # 명령 (imperative)\n$ kubectl create \n# 상태 생성</code></pre></div>\n<p>k8s의 <code class=\"language-text\">핵심은 상태</code>입니다. k8s를 사용하려면 어떤 상태가 있고 어떻게 상태를 선언하는지를 아는 것이 가장 중요합니다</p>\n</li>\n</ul>\n<br/>\n<hr>\n<h2 id=\"-아키텍처\" style=\"position:relative;\"><a href=\"#-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98\" aria-label=\" 아키텍처 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>👌 아키텍처</h2>\n<ul>\n<li>컨테이너는 아주 심플하고 우아하게 동작합니다.  </li>\n<li>즉 <code class=\"language-text\">run</code>을 하면 실행되고 <code class=\"language-text\">stop</code>을 하면 멈춥니다.</li>\n<li>\n<p><code class=\"language-text\">서버-클라이언트</code> 구조를 안다면 컨테이너를 관리하는 에이전트를 만들고<br>\n중앙에서 <code class=\"language-text\">API</code>를 사용해 원격으로 관리하는 로직을 그릴 수 있을 것입니다.</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90705561-31828880-e2ce-11ea-9b8b-5e6c4d725632.png\" alt=\"스크린샷, 2020-08-20 10-16-16\"></p>\n</li>\n<li>ks8 또한 <code class=\"language-text\">Master</code>에 <code class=\"language-text\">API 서버와 상태 저장소</code>를 두고 각 <code class=\"language-text\">Node</code>의 <code class=\"language-text\">에이전트(kubelet)</code>와 통신하는 구조입니다.  </li>\n</ul>\n<hr>\n<h2 id=\"-마스터---노드-구조\" style=\"position:relative;\"><a href=\"#-%EB%A7%88%EC%8A%A4%ED%84%B0---%EB%85%B8%EB%93%9C-%EA%B5%AC%EC%A1%B0\" aria-label=\" 마스터   노드 구조 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>👍 마스터 - 노드 구조</h2>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90705892-ecab2180-e2ce-11ea-8226-f235801c05ab.png\" alt=\"스크린샷, 2020-08-20 10-21-31\"></p>\n<ul>\n<li>k8s는 <code class=\"language-text\">전체 클러스터를 관리</code>하는 <code class=\"language-text\">마스터</code>와 <code class=\"language-text\">컨테이너가 배포</code>되는 <code class=\"language-text\">노드</code>로 구성되어 있습니다.  </li>\n<li>모든 명령은 <code class=\"language-text\">마스터의 API 서버를 호출</code>하고 노드는 마스터와 통신하면서 필요한 작업을 수행합니다.  </li>\n<li>특정 노드에 명령하거나 로그를 조회할 때도 노드에 직접 명령하는 게 아닌<br>\n마스터에 명령을 내리고 마스터가 노드에 접속하여 대신 결과를 응답합니다.</li>\n</ul>\n<br/>\n<p><strong>Master</strong>  </p>\n<ul>\n<li><code class=\"language-text\">MASTER</code>는 다양한 모듈이 확장성을 고려하여 기능별로 쪼개져 있는 것이 특징 입니다.  </li>\n<li>그러다 보니 보안 설정에 심혈을 기울여야 합니다.</li>\n<li>마스터 서버 장애시 클러스터를 관리할 수 없기 때문에 보통 여러대로 구성하여 안정성을 높입니다.  </li>\n</ul>\n<br/>\n<p><strong>Node</strong></p>\n<ul>\n<li><code class=\"language-text\">NODE</code>는 <code class=\"language-text\">MASTER</code>와 통신하면서 필요한 Pod을 생성하고 네트워크와 볼륨을 설정합니다.  </li>\n<li><code class=\"language-text\">실제 컨테이너들이 생성되는 곳</code>으로 거의 수천대로 확장할 수 있습니다.  </li>\n<li><code class=\"language-text\">추가적으로 라벨기능</code>을 사용하게되면 각각의 서버에 라벨을 붙여 사용목적(GPU 특화, SSD 서버 등)을 정의할 수 있습니다.</li>\n</ul>\n<br/>\n<p><strong>Kubectl</strong></p>\n<ul>\n<li>API 서버는 json 또는 protobuf 형식을 이용한 http 통신을 지원합니다.</li>\n<li>보통 kubectl이라는 명령행 도구를 사용합니다.  (매우 편함!!)</li>\n</ul>\n<br/>\n<hr>\n<h3 id=\"master-구성-요소\" style=\"position:relative;\"><a href=\"#master-%EA%B5%AC%EC%84%B1-%EC%9A%94%EC%86%8C\" aria-label=\"master 구성 요소 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Master 구성 요소</h3>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90707414-845e3f00-e2d2-11ea-881a-c754f08739cb.png\" alt=\"스크린샷, 2020-08-20 10-47-13\"></p>\n<br/>\n<h3 id=\"api-서버-kube-apiserver\" style=\"position:relative;\"><a href=\"#api-%EC%84%9C%EB%B2%84-kube-apiserver\" aria-label=\"api 서버 kube apiserver permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>API 서버 kube-apiserver</h3>\n<ul>\n<li>API 서버는 <code class=\"language-text\">모든(ALL) 요청을 처리하는 마스터의 핵심 모듈</code>입니다.  </li>\n<li>kubectl의 요청과 더불어 <code class=\"language-text\">내부 모듈</code>의 요청도 처리하고, 권한을 체크하여 요청을 거부할 수 있습니다.    </li>\n<li>실제로 하는 일은 <code class=\"language-text\">원하는 상태</code>를 <code class=\"language-text\">key-value 저장소</code>에 저장하고 저장된 상태를 조회하는 매우 단순한 작업입니다.  </li>\n<li>\n<p><code class=\"language-text\">Pod을 노드에 할당</code>하고 상태를 체크하는 일은 다른 모듈로 분리되어 있습니다.<br>\n노드에서 실행 중인 컨테이너의 로그를 보여주고 명령을 보내는 등 <code class=\"language-text\">디버거 역할</code>도 수행합니다.</p>\n<p><code class=\"language-text\">즉!!!! 마스터는 엄마입니다!!</code></p>\n</li>\n</ul>\n<br/>\n<h3 id=\"분산-데이터-저장소-etcd\" style=\"position:relative;\"><a href=\"#%EB%B6%84%EC%82%B0-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%80%EC%9E%A5%EC%86%8C-etcd\" aria-label=\"분산 데이터 저장소 etcd permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>분산 데이터 저장소 etcd</h3>\n<ul>\n<li><code class=\"language-text\">RAFT 알고리즘</code>을 이용한 <code class=\"language-text\">key-value 저장소</code>입니다.  </li>\n<li>여러 개로 분산하여 복제할 수 있기 때문에 안정성이 높고 속도가 빠릅니다.  </li>\n<li>단순히 값을 저장하고 읽는 기능뿐 아니라 <code class=\"language-text\">watch 기능</code>이 있어 어떤 상태가 변경되면 바로 체크하여 로직을 실행할 수 있습니다.</li>\n<li><code class=\"language-text\">클러스터의 모든 설정</code>, <code class=\"language-text\">상태 데이터</code>는 여기 저장되고 나머지 모듈은 stateless하게 동작하기 때문에<br>\n<code class=\"language-text\">etcd</code>만 잘 백업해두면 언제든지 클러스터를 복구할 수 있습니다.  </li>\n<li><code class=\"language-text\">etcd는 오직 API 서버와 통신</code>하고 다른 모듈은 API 서버를 거쳐 etcd 데이터에 접근합니다.  </li>\n</ul>\n<br/>\n<h3 id=\"스케줄러-컨트롤러\" style=\"position:relative;\"><a href=\"#%EC%8A%A4%EC%BC%80%EC%A4%84%EB%9F%AC-%EC%BB%A8%ED%8A%B8%EB%A1%A4%EB%9F%AC\" aria-label=\"스케줄러 컨트롤러 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>스케줄러, 컨트롤러</h3>\n<ul>\n<li>API 서버는 요청 시 etcd 저장소와 통신할 뿐 <code class=\"language-text\">실제로 상태를 바꾸는 건 스케줄러와 컨트롤러</code> 입니다.  </li>\n<li>\n<p><code class=\"language-text\">현재 상태</code>를 모니터링하다가 원하는 상태와 다르면 맡은 작업을 수행하고 상태를 갱신합니다.</p>\n<br/>\n<ul>\n<li>\n<p><code class=\"language-text\">스케줄러 kube-scheduler</code>  </p>\n<p>스케줄러는 할당되지 않은 <code class=\"language-text\">Pod을 여러 가지 조건(필요한 자원, 라벨)</code>에 따라 적절한 노드 서버에 할당해주는 모듈입니다.</p>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p><code class=\"language-text\">큐브 컨트롤러 kube-controller-manager</code></p>\n<p>큐브 컨트롤러는 다양한 역할을 하는 아주 바쁜 모듈입니다.<br>\nk8s에 있는 거의 <code class=\"language-text\">모든 오브젝트의 상태를 관리</code>합니다. 오브젝트별로 철저하게 분업화되어<br>\nDeployment는 ReplicaSet을 생성하고 ReplicaSet은 Pod을 생성하고 Pod은 스케줄러가 관리하는 식입니다.</p>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p><code class=\"language-text\">클라우드 컨트롤러 cloud-controller-manager</code>  </p>\n<p>클라우드 컨트롤러는 <code class=\"language-text\">AWS, GCE, Azure 등 클라우드에 특화</code>된 모듈입니다.<br>\n<code class=\"language-text\">노드를 추가/삭제</code>하고 <code class=\"language-text\">로드 밸런서를 연결</code>하거나 볼륨을 붙일 수 있습니다.<br>\n각 클라우드 업체에서 자체 모듈을 만들어 제공하고 있습니다.</p>\n</li>\n</ul>\n</li>\n</ul>\n<br/>\n<hr>\n<h3 id=\"node-구성-요소\" style=\"position:relative;\"><a href=\"#node-%EA%B5%AC%EC%84%B1-%EC%9A%94%EC%86%8C\" aria-label=\"node 구성 요소 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Node 구성 요소</h3>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90708077-f08d7280-e2d3-11ea-9e24-eb5e0f52430a.png\" alt=\"스크린샷, 2020-08-20 10-57-25\"></p>\n<br/>\n<p><strong>큐블릿 kubelet</strong>   </p>\n<ul>\n<li>노드에 할당된 Pod의 생명주기를 관리합니다.  </li>\n<li><code class=\"language-text\">Pod을 생성</code>하고 Pod 안 컨테이너에 이상을 확인하면서 <code class=\"language-text\">주기적으로 마스터에 상태를 전달</code>합니다.  </li>\n<li>API 서버의 요청을 받아 컨테이너의 로그를 전달하거나 <code class=\"language-text\">특정 명령을 대신 수행</code>하기도 합니다.</li>\n</ul>\n<br/>\n<p><strong>프록시 kube-proxy</strong>  </p>\n<ul>\n<li>프록시는 Pod으로 연결되는 <code class=\"language-text\">네트워크를 관리</code>합니다.  </li>\n<li><code class=\"language-text\">TCP, UDP, SCTP 스트림을 포워딩</code>하고<br>\n여러 개의 Pod을 <code class=\"language-text\">라운드로빈 형태</code>로 묶어 서비스를 제공할 수 있습니다.  </li>\n<li>현재는 요청에 대한 처리를 <code class=\"language-text\">iptables를 설정하는 방식으로 변경</code>되었습니다.<br>\n하지만 iptables에 등록된 규칙이 많아지면 <code class=\"language-text\">느려지는 문제</code> 때문에 최근 <code class=\"language-text\">IPVS</code>를 지원하기 시작했습니다.</li>\n</ul>\n<br/>\n<p><strong>추상화</strong></p>\n<ul>\n<li>컨테이너는 도커고 도커가 컨테이너라고 생각해도 무리가 없는 상황입니다만 </li>\n<li>k8s는 <code class=\"language-text\">CRI(Container runtime interface)</code>를 구현한 다양한 컨테이너 런타임을 지원합니다.  </li>\n<li>CRI 외에 <code class=\"language-text\">CNI(네트워크)</code>, <code class=\"language-text\">CSI(스토리지)</code>를 지원하여 쉽게 확장하여 사용할 수 있습니다.</li>\n</ul>\n<br/>\n<hr>\n<h3 id=\"k8s의-전체적인-로직-요약\" style=\"position:relative;\"><a href=\"#k8s%EC%9D%98-%EC%A0%84%EC%B2%B4%EC%A0%81%EC%9D%B8-%EB%A1%9C%EC%A7%81-%EC%9A%94%EC%95%BD\" aria-label=\"k8s의 전체적인 로직 요약 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>K8S의 전체적인 로직 요약</h3>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90708580-1ff0af00-e2d5-11ea-9102-75dd7cf923ff.png\" alt=\"스크린샷, 2020-08-20 11-05-54\"></p>\n<hr>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#-%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%EB%9E%80\">✔ 쿠버네티스란??</a></li>\n<li>\n<p><a href=\"#-%EB%8C%80%ED%91%9C%EC%A0%81%EC%9D%B8-%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%EC%9D%98-%EA%B8%B0%EB%8A%A5%EB%93%A4\">✌ 대표적인 쿠버네티스의 기능들</a></p>\n<ul>\n<li><a href=\"#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%EC%9D%98-%EB%B0%B0%ED%8F%AC-%EB%B0%A9%EC%8B%9D\">쿠버네티스의 배포 방식</a></li>\n<li><a href=\"#cloud-%EC%A7%80%EC%9B%90\">CLOUD 지원</a></li>\n<li><a href=\"#namespace--label\">NAMESPACE &#x26; LABEL</a></li>\n<li><a href=\"#auto-scaling\">Auto Scaling</a></li>\n<li><a href=\"#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%EC%9D%98-%EB%8B%A8%EC%A0%90\">쿠버네티스의 단점</a></li>\n</ul>\n</li>\n<li><a href=\"#-%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%EC%9D%98-%EA%B8%B0%EB%B3%B8-%EB%A1%9C%EC%A7%81-%EB%B0%8F-%EA%B0%9C%EB%85%90\">✌ 쿠버네티스의 기본 로직, 및 개념</a></li>\n<li><a href=\"#-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98\">👌 아키텍처</a></li>\n<li>\n<p><a href=\"#-%EB%A7%88%EC%8A%A4%ED%84%B0---%EB%85%B8%EB%93%9C-%EA%B5%AC%EC%A1%B0\">👍 마스터 - 노드 구조</a></p>\n<ul>\n<li><a href=\"#master-%EA%B5%AC%EC%84%B1-%EC%9A%94%EC%86%8C\">Master 구성 요소</a></li>\n<li><a href=\"#api-%EC%84%9C%EB%B2%84-kube-apiserver\">API 서버 kube-apiserver</a></li>\n<li><a href=\"#%EB%B6%84%EC%82%B0-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%80%EC%9E%A5%EC%86%8C-etcd\">분산 데이터 저장소 etcd</a></li>\n<li><a href=\"#%EC%8A%A4%EC%BC%80%EC%A4%84%EB%9F%AC-%EC%BB%A8%ED%8A%B8%EB%A1%A4%EB%9F%AC\">스케줄러, 컨트롤러</a></li>\n<li><a href=\"#node-%EA%B5%AC%EC%84%B1-%EC%9A%94%EC%86%8C\">Node 구성 요소</a></li>\n<li><a href=\"#k8s%EC%9D%98-%EC%A0%84%EC%B2%B4%EC%A0%81%EC%9D%B8-%EB%A1%9C%EC%A7%81-%EC%9A%94%EC%95%BD\">K8S의 전체적인 로직 요약</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"June 29, 2021","title":"[Kubernetes] - 쿠버네티스란?","categories":"Kubernetes","author":"nasa1515","emoji":"🤦‍♂️"},"fields":{"slug":"/kubernetes01/"}},"prev":{"id":"02ef2350-d7b7-5949-8669-9c9f4ed8580e","html":"<p>머리말  </p>\n<p>이전 포스트에서는 kubespay 자동화 툴을 사용해서 K8S 클러스터를 구축 했었습니다.<br>\n이번 포스트에서는 kubeadm을 이용해서 K8S 클러스터를 구축하는 방법에 대해서 포스트했습니다.  </p>\n<hr>\n<h2 id=\"-사전준비\" style=\"position:relative;\"><a href=\"#-%EC%82%AC%EC%A0%84%EC%A4%80%EB%B9%84\" aria-label=\" 사전준비 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✔ 사전준비</h2>\n<p>사전 준비의 경우 kubespray와 동일하게 GCP VM Instance에서 구성했기 때문에 방법이 동일합니다.<br>\n사전 준비는 <a href=\"https://nasa1515.tech/kubetnetes-kubespary/\">이전 포스트</a>인 kubespray를 확인해주세요.</p>\n<br/>\n<hr>\n<h2 id=\"-쿠버네티스--설치하기-kubeadm\" style=\"position:relative;\"><a href=\"#-%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4--%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0-kubeadm\" aria-label=\" 쿠버네티스  설치하기 kubeadm permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✌ 쿠버네티스  설치하기 [kubeadm]</h2>\n<p>본격적인 설치 과정입니다.\n<code class=\"language-text\">Kubeadm</code>은 <code class=\"language-text\">Kubelet</code> 과 <code class=\"language-text\">Kubectl</code> 을 <code class=\"language-text\">설치하지 않기</code> 때문에 직접 설치해야 합니다.  </p>\n<br/>\n<p>전체 Server에 아래 <code class=\"language-text\">Repo</code>를 추가합니다.  </p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">cat <span class=\"token operator\">&lt;&lt;</span>EOF <span class=\"token operator\">></span> <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>yum<span class=\"token punctuation\">.</span>repos<span class=\"token punctuation\">.</span>d<span class=\"token operator\">/</span>kubernetes<span class=\"token punctuation\">.</span>repo\n<span class=\"token punctuation\">[</span>kubernetes<span class=\"token punctuation\">]</span>\nname<span class=\"token operator\">=</span><span class=\"token class-name\">Kubernetes</span>\nbaseurl<span class=\"token operator\">=</span>https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>packages<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>google<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>yum<span class=\"token operator\">/</span>repos<span class=\"token operator\">/</span>kubernetes<span class=\"token operator\">-</span>el7<span class=\"token operator\">-</span><span class=\"token class-name\">x86_64</span>\nenabled<span class=\"token operator\">=</span><span class=\"token number\">1</span>\ngpgcheck<span class=\"token operator\">=</span><span class=\"token number\">1</span>\nrepo_gpgcheck<span class=\"token operator\">=</span><span class=\"token number\">1</span>\ngpgkey<span class=\"token operator\">=</span>https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>packages<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>google<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>yum<span class=\"token operator\">/</span>doc<span class=\"token operator\">/</span>yum<span class=\"token operator\">-</span><span class=\"token class-name\">key<span class=\"token punctuation\">.</span>gpg</span> https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>packages<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>google<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>yum<span class=\"token operator\">/</span>doc<span class=\"token operator\">/</span>rpm<span class=\"token operator\">-</span>package<span class=\"token operator\">-</span><span class=\"token class-name\">key<span class=\"token punctuation\">.</span>gpg</span>\nexclude<span class=\"token operator\">=</span>kube<span class=\"token operator\">*</span>\nEOF</code></pre></div>\n<br/>\n<br/>\n<p>CENSOS yum update</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">$ yum <span class=\"token operator\">-</span>y update</code></pre></div>\n<br/>\n<br/>\n<p>도커 설치 전 사전 세팅 </p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">$ yum install <span class=\"token operator\">-</span>y yum<span class=\"token operator\">-</span>utils device<span class=\"token operator\">-</span>mapper<span class=\"token operator\">-</span>persistent<span class=\"token operator\">-</span>data lvm2 </code></pre></div>\n<br/>\n<br/>\n<p>도커 저장소 설정</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">yum<span class=\"token operator\">-</span>config<span class=\"token operator\">-</span>manager <span class=\"token operator\">--</span><span class=\"token keyword\">add</span><span class=\"token operator\">-</span><span class=\"token class-name\">repo</span> https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>download<span class=\"token punctuation\">.</span>docker<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>linux<span class=\"token operator\">/</span>centos<span class=\"token operator\">/</span>docker<span class=\"token operator\">-</span>ce<span class=\"token punctuation\">.</span>repo</code></pre></div>\n<br/>\n<br/>\n<p>도커 패키지 설치</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">yum update <span class=\"token operator\">&amp;&amp;</span> yum install docker<span class=\"token operator\">-</span>ce<span class=\"token operator\">-</span><span class=\"token number\">18.06</span><span class=\"token number\">.2</span><span class=\"token punctuation\">.</span>ce</code></pre></div>\n<br/>\n<br/>\n<p>쿠버네티스 설치  </p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">yum install <span class=\"token operator\">-</span>y <span class=\"token operator\">--</span>disableexcludes<span class=\"token operator\">=</span>kubernetes kubeadm<span class=\"token operator\">-</span><span class=\"token number\">1.15</span><span class=\"token number\">.5</span><span class=\"token operator\">-</span><span class=\"token number\">0</span><span class=\"token punctuation\">.</span>x86_64 kubectl<span class=\"token operator\">-</span><span class=\"token number\">1.15</span><span class=\"token number\">.5</span><span class=\"token operator\">-</span><span class=\"token number\">0</span><span class=\"token punctuation\">.</span>x86_64 kubelet<span class=\"token operator\">-</span><span class=\"token number\">1.15</span><span class=\"token number\">.5</span><span class=\"token operator\">-</span><span class=\"token number\">0</span><span class=\"token punctuation\">.</span>x86_64</code></pre></div>\n<p>1.15 버전으로 설치하는 이유 : 헬스체크 이슈, 대쉬보드 호환성</p>\n<br/>\n<br/>\n<p><code class=\"language-text\">Master 노드</code>에 <code class=\"language-text\">컨트롤 구성 요소를 설치</code>합니다. 해당 작업은 <code class=\"language-text\">master</code> 에서만 실행합니다.<br>\n설치 시 사용할 이미지를 먼저 다운로드 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span># kubeadm config images pull\nI0824 <span class=\"token number\">02</span><span class=\"token punctuation\">:</span><span class=\"token number\">21</span><span class=\"token punctuation\">:</span><span class=\"token number\">37.374466</span>   <span class=\"token number\">13234</span> version<span class=\"token punctuation\">.</span>go<span class=\"token punctuation\">:</span><span class=\"token number\">248</span><span class=\"token punctuation\">]</span> remote version <span class=\"token keyword\">is</span> <span class=\"token class-name\">much</span> newer<span class=\"token punctuation\">:</span> v1<span class=\"token punctuation\">.</span><span class=\"token number\">18.8</span><span class=\"token punctuation\">;</span> falling <span class=\"token class-name\">back</span> to<span class=\"token punctuation\">:</span> stable<span class=\"token operator\">-</span><span class=\"token number\">1.15</span>\n<span class=\"token punctuation\">[</span>config<span class=\"token operator\">/</span>images<span class=\"token punctuation\">]</span> Pulled k8s<span class=\"token punctuation\">.</span>gcr<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>kube<span class=\"token operator\">-</span>apiserver<span class=\"token punctuation\">:</span>v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.12</span>\n<span class=\"token punctuation\">[</span>config<span class=\"token operator\">/</span>images<span class=\"token punctuation\">]</span> Pulled k8s<span class=\"token punctuation\">.</span>gcr<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>kube<span class=\"token operator\">-</span>controller<span class=\"token operator\">-</span>manager<span class=\"token punctuation\">:</span>v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.12</span>\n<span class=\"token punctuation\">[</span>config<span class=\"token operator\">/</span>images<span class=\"token punctuation\">]</span> Pulled k8s<span class=\"token punctuation\">.</span>gcr<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>kube<span class=\"token operator\">-</span>scheduler<span class=\"token punctuation\">:</span>v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.12</span>\n<span class=\"token punctuation\">[</span>config<span class=\"token operator\">/</span>images<span class=\"token punctuation\">]</span> Pulled k8s<span class=\"token punctuation\">.</span>gcr<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>kube<span class=\"token operator\">-</span>proxy<span class=\"token punctuation\">:</span>v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.12</span>\n<span class=\"token punctuation\">[</span>config<span class=\"token operator\">/</span>images<span class=\"token punctuation\">]</span> Pulled k8s<span class=\"token punctuation\">.</span>gcr<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>pause<span class=\"token punctuation\">:</span><span class=\"token number\">3.1</span>\n<span class=\"token punctuation\">[</span>config<span class=\"token operator\">/</span>images<span class=\"token punctuation\">]</span> Pulled k8s<span class=\"token punctuation\">.</span>gcr<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>etcd<span class=\"token punctuation\">:</span><span class=\"token number\">3.3</span><span class=\"token number\">.10</span>\n<span class=\"token punctuation\">[</span>config<span class=\"token operator\">/</span>images<span class=\"token punctuation\">]</span> Pulled k8s<span class=\"token punctuation\">.</span>gcr<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>coredns<span class=\"token punctuation\">:</span><span class=\"token number\">1.3</span><span class=\"token number\">.1</span></code></pre></div>\n<br/>\n<br/>\n<p>마스터 노드를 <code class=\"language-text\">초기화</code>합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span># kubeadm init\nI0824 <span class=\"token number\">02</span><span class=\"token punctuation\">:</span><span class=\"token number\">22</span><span class=\"token punctuation\">:</span><span class=\"token number\">23.982576</span>   <span class=\"token number\">13371</span> version<span class=\"token punctuation\">.</span>go<span class=\"token punctuation\">:</span><span class=\"token number\">248</span><span class=\"token punctuation\">]</span> remote version <span class=\"token keyword\">is</span> <span class=\"token class-name\">much</span> newer<span class=\"token punctuation\">:</span> v1<span class=\"token punctuation\">.</span><span class=\"token number\">18.8</span><span class=\"token punctuation\">;</span> falling <span class=\"token class-name\">back</span> to<span class=\"token punctuation\">:</span> stable<span class=\"token operator\">-</span><span class=\"token number\">1.15</span>\n<span class=\"token punctuation\">[</span>init<span class=\"token punctuation\">]</span> Using <span class=\"token class-name\">Kubernetes</span> version<span class=\"token punctuation\">:</span> v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.12</span>\n<span class=\"token punctuation\">[</span>preflight<span class=\"token punctuation\">]</span> Running pre<span class=\"token operator\">-</span>flight checks\n        <span class=\"token punctuation\">[</span>WARNING Service<span class=\"token operator\">-</span>Kubelet<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> kubelet service <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token class-name\">enabled</span><span class=\"token punctuation\">,</span> please run 'systemctl enable kubelet<span class=\"token punctuation\">.</span>service'\n<span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">preflight</span></span><span class=\"token punctuation\">]</span> Pulling images required <span class=\"token keyword\">for</span> setting up a Kubernetes cluster\n<span class=\"token punctuation\">[</span>preflight<span class=\"token punctuation\">]</span> This might take a minute <span class=\"token keyword\">or</span> two<span class=\"token punctuation\">,</span> depending <span class=\"token keyword\">on</span> the speed of your internet connection\n<span class=\"token punctuation\">[</span>preflight<span class=\"token punctuation\">]</span> You can also perform <span class=\"token keyword\">this</span> action <span class=\"token keyword\">in</span> beforehand <span class=\"token keyword\">using</span> 'kubeadm config images pull'\n<span class=\"token punctuation\">[</span>kubelet<span class=\"token operator\">-</span>start<span class=\"token punctuation\">]</span> Writing kubelet environment file with flags to file <span class=\"token string\">\"/var/lib/kubelet/kubeadm-flags.env\"</span>\n<span class=\"token punctuation\">[</span>kubelet<span class=\"token operator\">-</span>start<span class=\"token punctuation\">]</span> Writing kubelet configuration to file <span class=\"token string\">\"/var/lib/kubelet/config.yaml\"</span>\n<span class=\"token punctuation\">[</span>kubelet<span class=\"token operator\">-</span>start<span class=\"token punctuation\">]</span> Activating the kubelet service\n<span class=\"token punctuation\">[</span>certs<span class=\"token punctuation\">]</span> Using certificateDir folder <span class=\"token string\">\"/etc/kubernetes/pki\"</span>\n<span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">certs</span></span><span class=\"token punctuation\">]</span> Generating <span class=\"token string\">\"ca\"</span> certificate <span class=\"token keyword\">and</span> key\n<span class=\"token punctuation\">[</span>certs<span class=\"token punctuation\">]</span> Generating <span class=\"token string\">\"apiserver-kubelet-client\"</span> certificate <span class=\"token keyword\">and</span> key\n<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span>\n<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>중략<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>\nYour Kubernetes control<span class=\"token operator\">-</span>plane has initialized successfully<span class=\"token operator\">!</span>\nTo start <span class=\"token keyword\">using</span> <span class=\"token class-name\">your</span> cluster<span class=\"token punctuation\">,</span> you need to run the following <span class=\"token keyword\">as</span> <span class=\"token class-name\">a</span> <span class=\"token class-name\">regular</span> user<span class=\"token punctuation\">:</span>\nmkdir <span class=\"token operator\">-</span>p $HOME<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>kube\nsudo cp <span class=\"token operator\">-</span>i <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>kubernetes<span class=\"token operator\">/</span>admin<span class=\"token punctuation\">.</span>conf $HOME<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>kube<span class=\"token operator\">/</span>config\nsudo chown $<span class=\"token punctuation\">(</span>id <span class=\"token operator\">-</span>u<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>$<span class=\"token punctuation\">(</span>id <span class=\"token operator\">-</span>g<span class=\"token punctuation\">)</span> $HOME<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>kube<span class=\"token operator\">/</span>config\nYou should now deploy a pod network to the cluster<span class=\"token punctuation\">.</span>\nRun <span class=\"token string\">\"kubectl apply -f [podnetwork].yaml\"</span> with one of the options <span class=\"token class-name\">listed</span> at<span class=\"token punctuation\">:</span>\nhttps<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>kubernetes<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>docs<span class=\"token operator\">/</span>concepts<span class=\"token operator\">/</span>cluster<span class=\"token operator\">-</span>administration<span class=\"token operator\">/</span>addons<span class=\"token operator\">/</span>\nThen you can <span class=\"token keyword\">join</span> any number of worker nodes <span class=\"token keyword\">by</span> running the following <span class=\"token keyword\">on</span> each <span class=\"token keyword\">as</span> <span class=\"token class-name\">root</span><span class=\"token punctuation\">:</span>\nkubeadm <span class=\"token keyword\">join</span> <span class=\"token number\">10.146</span><span class=\"token number\">.0</span><span class=\"token number\">.6</span><span class=\"token punctuation\">:</span><span class=\"token number\">6443</span> <span class=\"token operator\">--</span>token ofhrxu<span class=\"token punctuation\">.</span>dgsn2pc08glnfj06 \\\n    <span class=\"token operator\">--</span>discovery<span class=\"token operator\">-</span>token<span class=\"token operator\">-</span>ca<span class=\"token operator\">-</span>cert<span class=\"token operator\">-</span><span class=\"token class-name\">hash</span> sha256<span class=\"token punctuation\">:</span>00f7773eea1e619ea4c5698417679475cb07774b26cd7f738fb82a315f643b5a</code></pre></div>\n<br/>\n<br/>\n<p>여기서 <code class=\"language-text\">일반 사용자</code>가 <code class=\"language-text\">kubectl</code> 을 <code class=\"language-text\">사용</code>할 수 있도록 환경변수를 설정합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">mkdir <span class=\"token operator\">-</span>p $HOME<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>kube\nsudo cp <span class=\"token operator\">-</span>i <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>kubernetes<span class=\"token operator\">/</span>admin<span class=\"token punctuation\">.</span>conf $HOME<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>kube<span class=\"token operator\">/</span>config\nsudo chown $<span class=\"token punctuation\">(</span>id <span class=\"token operator\">-</span>u<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>$<span class=\"token punctuation\">(</span>id <span class=\"token operator\">-</span>g<span class=\"token punctuation\">)</span> $HOME<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>kube<span class=\"token operator\">/</span>config</code></pre></div>\n<br/>\n<hr>\n<h3 id=\"worker-노드-설정\" style=\"position:relative;\"><a href=\"#worker-%EB%85%B8%EB%93%9C-%EC%84%A4%EC%A0%95\" aria-label=\"worker 노드 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WORKER 노드 설정</h3>\n<p>도커 실행</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">systemctl daemon<span class=\"token operator\">-</span>reload\nsystemctl enable <span class=\"token operator\">--</span>now docker</code></pre></div>\n<br/>\n<br/>\n<p>kubelet 실행  </p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">systemctl enable <span class=\"token operator\">--</span>now kubelet</code></pre></div>\n<br/>\n<br/>\n<p>로그의 <code class=\"language-text\">마지막 라인의 명령어</code>는 <code class=\"language-text\">워커 노드</code>를 해당 <code class=\"language-text\">클러스터에 추가</code>하는 명령어입니다.<br>\n해당 명령어를 복사해서 <code class=\"language-text\">nasa-node1</code>, <code class=\"language-text\">nasa-node2</code>, <code class=\"language-text\">nasa-node3</code> 노드에서 수행합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span>node1 <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span># kubeadm <span class=\"token keyword\">join</span> <span class=\"token number\">10.146</span><span class=\"token number\">.0</span><span class=\"token number\">.6</span><span class=\"token punctuation\">:</span><span class=\"token number\">6443</span> <span class=\"token operator\">--</span>token ofhrxu<span class=\"token punctuation\">.</span>dgsn2pc08glnfj06 \\<span class=\"token operator\">--</span>discove\nry<span class=\"token operator\">-</span>token<span class=\"token operator\">-</span>ca<span class=\"token operator\">-</span>cert<span class=\"token operator\">-</span><span class=\"token class-name\">hash</span> sha256<span class=\"token punctuation\">:</span>00f7773eea1e619ea4c5698417679475cb07774b26cd7f738fb82a315f643b5\na \n<span class=\"token punctuation\">[</span>preflight<span class=\"token punctuation\">]</span> Running pre<span class=\"token operator\">-</span>flight checks\n<span class=\"token punctuation\">[</span>preflight<span class=\"token punctuation\">]</span> Reading configuration <span class=\"token keyword\">from</span> the cluster<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">preflight</span></span><span class=\"token punctuation\">]</span> FYI<span class=\"token punctuation\">:</span> You can look at <span class=\"token keyword\">this</span> config file with 'kubectl <span class=\"token operator\">-</span>n kube<span class=\"token operator\">-</span>system <span class=\"token keyword\">get</span> cm kubead\nm<span class=\"token operator\">-</span>config <span class=\"token operator\">-</span>oyaml'\n<span class=\"token punctuation\">[</span>kubelet<span class=\"token operator\">-</span>start<span class=\"token punctuation\">]</span> Downloading configuration <span class=\"token keyword\">for</span> the kubelet <span class=\"token keyword\">from</span> the <span class=\"token string\">\"kubelet-config-1.15\"</span> <span class=\"token class-name\">Con</span>\nfigMap <span class=\"token keyword\">in</span> the kube<span class=\"token operator\">-</span>system <span class=\"token keyword\">namespace</span>\n<span class=\"token punctuation\">[</span>kubelet<span class=\"token operator\">-</span>start<span class=\"token punctuation\">]</span> Writing kubelet configuration to file <span class=\"token string\">\"/var/lib/kubelet/config.yaml\"</span>\n<span class=\"token punctuation\">[</span>kubelet<span class=\"token operator\">-</span>start<span class=\"token punctuation\">]</span> Writing kubelet environment file with flags to file \"<span class=\"token operator\">/</span><span class=\"token keyword\">var</span><span class=\"token operator\">/</span>lib<span class=\"token operator\">/</span>kubelet<span class=\"token operator\">/</span>kubead\nm<span class=\"token operator\">-</span>flags<span class=\"token punctuation\">.</span>env\"\n<span class=\"token punctuation\">[</span>kubelet<span class=\"token operator\">-</span>start<span class=\"token punctuation\">]</span> Activating the kubelet service\n<span class=\"token punctuation\">[</span>kubelet<span class=\"token operator\">-</span>start<span class=\"token punctuation\">]</span> Waiting <span class=\"token keyword\">for</span> the kubelet to perform the TLS Bootstrap<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span>\nThis node has joined <span class=\"token class-name\">the</span> cluster<span class=\"token punctuation\">:</span>\n<span class=\"token operator\">*</span> Certificate signing request was sent to apiserver <span class=\"token keyword\">and</span> a response was received<span class=\"token punctuation\">.</span>\n<span class=\"token operator\">*</span> The Kubelet was informed of the <span class=\"token keyword\">new</span> secure connection details<span class=\"token punctuation\">.</span>\nRun 'kubectl <span class=\"token keyword\">get</span> nodes' <span class=\"token keyword\">on</span> the control<span class=\"token operator\">-</span>plane to see <span class=\"token keyword\">this</span> node <span class=\"token keyword\">join</span> the cluster<span class=\"token punctuation\">.</span></code></pre></div>\n<br>\n<h3 id=\"pod-network-add-on-설치하기\" style=\"position:relative;\"><a href=\"#pod-network-add-on-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\" aria-label=\"pod network add on 설치하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Pod network add-on 설치하기</h3>\n<p><code class=\"language-text\">Pod</code> 은 실제로 여러 노드에 걸쳐 배포되는데, Pod 끼리 하나의 네트워크에 있는 것처럼 통신할 수 있습니다.<br>\n이를 <code class=\"language-text\">오버레이 네트워크(Overlay Network)</code>라고 합니다.</p>\n<p>오버레이 네트워크를 지원하는 <code class=\"language-text\">CNI(Container Network Interface) 플러그인</code>을 설치해보겠습니다.<br>\nCNI 에는 여러 종류가 있는데, 이번 포스트는 <code class=\"language-text\">Weave</code> 를 이용합니다.</p>\n<br/>\n<p><code class=\"language-text\">Master</code> 노드에서 <code class=\"language-text\">weave</code>를 설치합니다</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span># kubectl apply <span class=\"token operator\">-</span>f <span class=\"token string\">\"https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d '\\n')\"</span>\nserviceaccount<span class=\"token operator\">/</span>weave<span class=\"token operator\">-</span>net created\nclusterrole<span class=\"token punctuation\">.</span>rbac<span class=\"token punctuation\">.</span>authorization<span class=\"token punctuation\">.</span>k8s<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>weave<span class=\"token operator\">-</span>net created\nclusterrolebinding<span class=\"token punctuation\">.</span>rbac<span class=\"token punctuation\">.</span>authorization<span class=\"token punctuation\">.</span>k8s<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>weave<span class=\"token operator\">-</span>net created\nrole<span class=\"token punctuation\">.</span>rbac<span class=\"token punctuation\">.</span>authorization<span class=\"token punctuation\">.</span>k8s<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>weave<span class=\"token operator\">-</span>net created\nrolebinding<span class=\"token punctuation\">.</span>rbac<span class=\"token punctuation\">.</span>authorization<span class=\"token punctuation\">.</span>k8s<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>weave<span class=\"token operator\">-</span>net created\ndaemonset<span class=\"token punctuation\">.</span>apps<span class=\"token operator\">/</span>weave<span class=\"token operator\">-</span>net created</code></pre></div>\n<p><code class=\"language-text\">CNI</code>를 설치하면 <code class=\"language-text\">CoreDNS Pod</code> 이 <code class=\"language-text\">정상적으로 동작</code>하게 됩니다.</p>\n<br/>\n<p>각 노드와 상태를 확인해보겠습니다 </p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span># kubectl <span class=\"token keyword\">get</span> nodes\nNAME          STATUS   ROLES    AGE     VERSION\nnasa<span class=\"token operator\">-</span>master   Ready    master   <span class=\"token number\">10m</span>     v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.5</span>\nnasa<span class=\"token operator\">-</span>node1    Ready    <span class=\"token operator\">&lt;</span>none<span class=\"token operator\">></span>   3m48s   v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.5</span>\nnasa<span class=\"token operator\">-</span>node2    Ready    <span class=\"token operator\">&lt;</span>none<span class=\"token operator\">></span>   4m15s   v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.5</span>\nnasa<span class=\"token operator\">-</span>node3    Ready    <span class=\"token operator\">&lt;</span>none<span class=\"token operator\">></span>   3m48s   v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.5</span></code></pre></div>\n<br/>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span># kubectl <span class=\"token keyword\">get</span> cs\nNAME                 STATUS    MESSAGE             ERROR\ncontroller<span class=\"token operator\">-</span>manager   Healthy   ok                  \nscheduler            Healthy   ok                  \netcd<span class=\"token operator\">-</span><span class=\"token number\">0</span>               Healthy   <span class=\"token punctuation\">{</span><span class=\"token string\">\"health\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"true\"</span><span class=\"token punctuation\">}</span>   </code></pre></div>\n<br/>\n<br/>\n<p>최종적으로 구성 API, 및 요소가 정상적으로 실행중인지 확인합니다</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span># kubectl <span class=\"token keyword\">get</span> po <span class=\"token operator\">-</span>o custom<span class=\"token operator\">-</span>columns<span class=\"token operator\">=</span>POD<span class=\"token punctuation\">:</span>metadata<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span><span class=\"token named-parameter punctuation\">NODE</span><span class=\"token punctuation\">:</span>spec<span class=\"token punctuation\">.</span>nodeName <span class=\"token operator\">--</span>sort<span class=\"token operator\">-</span><span class=\"token keyword\">by</span> spec<span class=\"token punctuation\">.</span>nodeName \n<span class=\"token operator\">-</span>n kube<span class=\"token operator\">-</span>system\nPOD                                   NODE\nkube<span class=\"token operator\">-</span>scheduler<span class=\"token operator\">-</span>nasa<span class=\"token operator\">-</span>master            nasa<span class=\"token operator\">-</span>master\nweave<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>v7bff                       nasa<span class=\"token operator\">-</span>master\netcd<span class=\"token operator\">-</span>nasa<span class=\"token operator\">-</span>master                      nasa<span class=\"token operator\">-</span>master\nkube<span class=\"token operator\">-</span>apiserver<span class=\"token operator\">-</span>nasa<span class=\"token operator\">-</span>master            nasa<span class=\"token operator\">-</span>master\nkube<span class=\"token operator\">-</span>controller<span class=\"token operator\">-</span>manager<span class=\"token operator\">-</span>nasa<span class=\"token operator\">-</span>master   nasa<span class=\"token operator\">-</span>master\nkube<span class=\"token operator\">-</span>proxy<span class=\"token operator\">-</span>6w9dk                      nasa<span class=\"token operator\">-</span>master\nkube<span class=\"token operator\">-</span>proxy<span class=\"token operator\">-</span>lxn6d                      nasa<span class=\"token operator\">-</span>node1\nweave<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>k2tcb                       nasa<span class=\"token operator\">-</span>node1\ncoredns<span class=\"token operator\">-</span>5c98db65d4<span class=\"token operator\">-</span>8cg79              nasa<span class=\"token operator\">-</span>node1\nkube<span class=\"token operator\">-</span>proxy<span class=\"token operator\">-</span>jqks7                      nasa<span class=\"token operator\">-</span>node2\nweave<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>dd6f2                       nasa<span class=\"token operator\">-</span>node2\ncoredns<span class=\"token operator\">-</span>5c98db65d4<span class=\"token operator\">-</span>zbvbn              nasa<span class=\"token operator\">-</span>node2\nweave<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>k2jc9                       nasa<span class=\"token operator\">-</span>node3\nkube<span class=\"token operator\">-</span>proxy<span class=\"token operator\">-</span>kr9sb                      nasa<span class=\"token operator\">-</span>node3</code></pre></div>\n<hr>\n<h3 id=\"간단한-pods-배포-test\" style=\"position:relative;\"><a href=\"#%EA%B0%84%EB%8B%A8%ED%95%9C-pods-%EB%B0%B0%ED%8F%AC-test\" aria-label=\"간단한 pods 배포 test permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>간단한 pods 배포 TEST</h3>\n<p>간단한 Pod 을 배포해서 동작을 확인해봅시다. 아래 pod-test.yaml 파일을 생성합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">apiVersion<span class=\"token punctuation\">:</span> <span class=\"token class-name\">v1</span>\nkind<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Pod</span>\nmetadata<span class=\"token punctuation\">:</span>\nname<span class=\"token punctuation\">:</span> myapp<span class=\"token operator\">-</span><span class=\"token class-name\">pod</span>\nlabels<span class=\"token punctuation\">:</span>\n    app<span class=\"token punctuation\">:</span> <span class=\"token class-name\">myapp</span>\nspec<span class=\"token punctuation\">:</span>\ncontainers<span class=\"token punctuation\">:</span>\n<span class=\"token operator\">-</span> name<span class=\"token punctuation\">:</span> myapp<span class=\"token operator\">-</span><span class=\"token class-name\">container</span>\n    image<span class=\"token punctuation\">:</span> <span class=\"token class-name\">busybox</span>\n    command<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>'sh'<span class=\"token punctuation\">,</span> '<span class=\"token operator\">-</span>c'<span class=\"token punctuation\">,</span> 'echo Hello Kubernetes<span class=\"token operator\">!</span> <span class=\"token operator\">&amp;&amp;</span> sleep <span class=\"token number\">3600</span>'<span class=\"token punctuation\">]</span></code></pre></div>\n<p>해당 Pod 이 실행되면 <code class=\"language-text\">busybox</code> 라는 경량 리눅스 이미지에 <code class=\"language-text\">Hello Kubernetes!</code> 라는 로그가 잠시 동안 출력되고 Pod 은 종료됩니다.</p>\n<br/>\n<br/>\n<p>PODS 배포</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kube<span class=\"token punctuation\">]</span># kubectl apply <span class=\"token operator\">-</span>f pod<span class=\"token operator\">-</span>test<span class=\"token punctuation\">.</span>yaml\npod<span class=\"token operator\">/</span>nasa<span class=\"token operator\">-</span>pod created</code></pre></div>\n<br/>\n<br/>\n<p>동작 및 로그 확인</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kube<span class=\"token punctuation\">]</span># kubectl <span class=\"token keyword\">get</span> po\nNAME       READY   STATUS    RESTARTS   AGE\nnasa<span class=\"token operator\">-</span>pod   <span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">1</span>     Running   <span class=\"token number\">0</span>          10s\n<span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kube<span class=\"token punctuation\">]</span># \n<span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kube<span class=\"token punctuation\">]</span># kubectl logs nasa<span class=\"token operator\">-</span>pod\nHello Kubernetes<span class=\"token operator\">!</span></code></pre></div>\n<p>이로써 기본적인 k8s 클러스터 구성이 완료되었습니다</p>\n<hr>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#-%EC%82%AC%EC%A0%84%EC%A4%80%EB%B9%84\">✔ 사전준비</a></li>\n<li>\n<p><a href=\"#-%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4--%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0-kubeadm\">✌ 쿠버네티스  설치하기 kubeadm</a></p>\n<ul>\n<li><a href=\"#worker-%EB%85%B8%EB%93%9C-%EC%84%A4%EC%A0%95\">WORKER 노드 설정</a></li>\n<li><a href=\"#pod-network-add-on-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\">Pod network add-on 설치하기</a></li>\n<li><a href=\"#%EA%B0%84%EB%8B%A8%ED%95%9C-pods-%EB%B0%B0%ED%8F%AC-test\">간단한 pods 배포 TEST</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"June 29, 2021","title":"[Kubernetes] - Kubernetes 환경구성 on GCP Using kubeadm","categories":"Kubernetes GCP","author":"nasa1515","emoji":"🤦‍♂️"},"fields":{"slug":"/kubernetes-kubeadm/"}},"site":{"siteMetadata":{"siteUrl":"https://nasa1515.com","comments":{"utterances":{"repo":"nasa1515/nasablog"}}}}},"pageContext":{"slug":"/kubetnetes-kubespary/","nextSlug":"/kubernetes01/","prevSlug":"/kubernetes-kubeadm/"}},"staticQueryHashes":["1073350324","2938748437"]}