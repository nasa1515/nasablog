{"componentChunkName":"component---src-templates-blog-template-js","path":"/kubernetes-kubeadm/","result":{"data":{"cur":{"id":"02ef2350-d7b7-5949-8669-9c9f4ed8580e","html":"<p>머리말  </p>\n<p>이전 포스트에서는 kubespay 자동화 툴을 사용해서 K8S 클러스터를 구축 했었습니다.<br>\n이번 포스트에서는 kubeadm을 이용해서 K8S 클러스터를 구축하는 방법에 대해서 포스트했습니다.  </p>\n<hr>\n<h2 id=\"-사전준비\" style=\"position:relative;\"><a href=\"#-%EC%82%AC%EC%A0%84%EC%A4%80%EB%B9%84\" aria-label=\" 사전준비 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✔ 사전준비</h2>\n<p>사전 준비의 경우 kubespray와 동일하게 GCP VM Instance에서 구성했기 때문에 방법이 동일합니다.<br>\n사전 준비는 <a href=\"https://nasa1515.tech/kubetnetes-kubespary/\">이전 포스트</a>인 kubespray를 확인해주세요.</p>\n<br/>\n<hr>\n<h2 id=\"-쿠버네티스--설치하기-kubeadm\" style=\"position:relative;\"><a href=\"#-%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4--%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0-kubeadm\" aria-label=\" 쿠버네티스  설치하기 kubeadm permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✌ 쿠버네티스  설치하기 [kubeadm]</h2>\n<p>본격적인 설치 과정입니다.\n<code class=\"language-text\">Kubeadm</code>은 <code class=\"language-text\">Kubelet</code> 과 <code class=\"language-text\">Kubectl</code> 을 <code class=\"language-text\">설치하지 않기</code> 때문에 직접 설치해야 합니다.  </p>\n<br/>\n<p>전체 Server에 아래 <code class=\"language-text\">Repo</code>를 추가합니다.  </p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">cat <span class=\"token operator\">&lt;&lt;</span>EOF <span class=\"token operator\">></span> <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>yum<span class=\"token punctuation\">.</span>repos<span class=\"token punctuation\">.</span>d<span class=\"token operator\">/</span>kubernetes<span class=\"token punctuation\">.</span>repo\n<span class=\"token punctuation\">[</span>kubernetes<span class=\"token punctuation\">]</span>\nname<span class=\"token operator\">=</span><span class=\"token class-name\">Kubernetes</span>\nbaseurl<span class=\"token operator\">=</span>https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>packages<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>google<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>yum<span class=\"token operator\">/</span>repos<span class=\"token operator\">/</span>kubernetes<span class=\"token operator\">-</span>el7<span class=\"token operator\">-</span><span class=\"token class-name\">x86_64</span>\nenabled<span class=\"token operator\">=</span><span class=\"token number\">1</span>\ngpgcheck<span class=\"token operator\">=</span><span class=\"token number\">1</span>\nrepo_gpgcheck<span class=\"token operator\">=</span><span class=\"token number\">1</span>\ngpgkey<span class=\"token operator\">=</span>https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>packages<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>google<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>yum<span class=\"token operator\">/</span>doc<span class=\"token operator\">/</span>yum<span class=\"token operator\">-</span><span class=\"token class-name\">key<span class=\"token punctuation\">.</span>gpg</span> https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>packages<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>google<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>yum<span class=\"token operator\">/</span>doc<span class=\"token operator\">/</span>rpm<span class=\"token operator\">-</span>package<span class=\"token operator\">-</span><span class=\"token class-name\">key<span class=\"token punctuation\">.</span>gpg</span>\nexclude<span class=\"token operator\">=</span>kube<span class=\"token operator\">*</span>\nEOF</code></pre></div>\n<br/>\n<br/>\n<p>CENSOS yum update</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">$ yum <span class=\"token operator\">-</span>y update</code></pre></div>\n<br/>\n<br/>\n<p>도커 설치 전 사전 세팅 </p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">$ yum install <span class=\"token operator\">-</span>y yum<span class=\"token operator\">-</span>utils device<span class=\"token operator\">-</span>mapper<span class=\"token operator\">-</span>persistent<span class=\"token operator\">-</span>data lvm2 </code></pre></div>\n<br/>\n<br/>\n<p>도커 저장소 설정</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">yum<span class=\"token operator\">-</span>config<span class=\"token operator\">-</span>manager <span class=\"token operator\">--</span><span class=\"token keyword\">add</span><span class=\"token operator\">-</span><span class=\"token class-name\">repo</span> https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>download<span class=\"token punctuation\">.</span>docker<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>linux<span class=\"token operator\">/</span>centos<span class=\"token operator\">/</span>docker<span class=\"token operator\">-</span>ce<span class=\"token punctuation\">.</span>repo</code></pre></div>\n<br/>\n<br/>\n<p>도커 패키지 설치</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">yum update <span class=\"token operator\">&amp;&amp;</span> yum install docker<span class=\"token operator\">-</span>ce<span class=\"token operator\">-</span><span class=\"token number\">18.06</span><span class=\"token number\">.2</span><span class=\"token punctuation\">.</span>ce</code></pre></div>\n<br/>\n<br/>\n<p>쿠버네티스 설치  </p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">yum install <span class=\"token operator\">-</span>y <span class=\"token operator\">--</span>disableexcludes<span class=\"token operator\">=</span>kubernetes kubeadm<span class=\"token operator\">-</span><span class=\"token number\">1.15</span><span class=\"token number\">.5</span><span class=\"token operator\">-</span><span class=\"token number\">0</span><span class=\"token punctuation\">.</span>x86_64 kubectl<span class=\"token operator\">-</span><span class=\"token number\">1.15</span><span class=\"token number\">.5</span><span class=\"token operator\">-</span><span class=\"token number\">0</span><span class=\"token punctuation\">.</span>x86_64 kubelet<span class=\"token operator\">-</span><span class=\"token number\">1.15</span><span class=\"token number\">.5</span><span class=\"token operator\">-</span><span class=\"token number\">0</span><span class=\"token punctuation\">.</span>x86_64</code></pre></div>\n<p>1.15 버전으로 설치하는 이유 : 헬스체크 이슈, 대쉬보드 호환성</p>\n<br/>\n<br/>\n<p><code class=\"language-text\">Master 노드</code>에 <code class=\"language-text\">컨트롤 구성 요소를 설치</code>합니다. 해당 작업은 <code class=\"language-text\">master</code> 에서만 실행합니다.<br>\n설치 시 사용할 이미지를 먼저 다운로드 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span># kubeadm config images pull\nI0824 <span class=\"token number\">02</span><span class=\"token punctuation\">:</span><span class=\"token number\">21</span><span class=\"token punctuation\">:</span><span class=\"token number\">37.374466</span>   <span class=\"token number\">13234</span> version<span class=\"token punctuation\">.</span>go<span class=\"token punctuation\">:</span><span class=\"token number\">248</span><span class=\"token punctuation\">]</span> remote version <span class=\"token keyword\">is</span> <span class=\"token class-name\">much</span> newer<span class=\"token punctuation\">:</span> v1<span class=\"token punctuation\">.</span><span class=\"token number\">18.8</span><span class=\"token punctuation\">;</span> falling <span class=\"token class-name\">back</span> to<span class=\"token punctuation\">:</span> stable<span class=\"token operator\">-</span><span class=\"token number\">1.15</span>\n<span class=\"token punctuation\">[</span>config<span class=\"token operator\">/</span>images<span class=\"token punctuation\">]</span> Pulled k8s<span class=\"token punctuation\">.</span>gcr<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>kube<span class=\"token operator\">-</span>apiserver<span class=\"token punctuation\">:</span>v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.12</span>\n<span class=\"token punctuation\">[</span>config<span class=\"token operator\">/</span>images<span class=\"token punctuation\">]</span> Pulled k8s<span class=\"token punctuation\">.</span>gcr<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>kube<span class=\"token operator\">-</span>controller<span class=\"token operator\">-</span>manager<span class=\"token punctuation\">:</span>v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.12</span>\n<span class=\"token punctuation\">[</span>config<span class=\"token operator\">/</span>images<span class=\"token punctuation\">]</span> Pulled k8s<span class=\"token punctuation\">.</span>gcr<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>kube<span class=\"token operator\">-</span>scheduler<span class=\"token punctuation\">:</span>v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.12</span>\n<span class=\"token punctuation\">[</span>config<span class=\"token operator\">/</span>images<span class=\"token punctuation\">]</span> Pulled k8s<span class=\"token punctuation\">.</span>gcr<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>kube<span class=\"token operator\">-</span>proxy<span class=\"token punctuation\">:</span>v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.12</span>\n<span class=\"token punctuation\">[</span>config<span class=\"token operator\">/</span>images<span class=\"token punctuation\">]</span> Pulled k8s<span class=\"token punctuation\">.</span>gcr<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>pause<span class=\"token punctuation\">:</span><span class=\"token number\">3.1</span>\n<span class=\"token punctuation\">[</span>config<span class=\"token operator\">/</span>images<span class=\"token punctuation\">]</span> Pulled k8s<span class=\"token punctuation\">.</span>gcr<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>etcd<span class=\"token punctuation\">:</span><span class=\"token number\">3.3</span><span class=\"token number\">.10</span>\n<span class=\"token punctuation\">[</span>config<span class=\"token operator\">/</span>images<span class=\"token punctuation\">]</span> Pulled k8s<span class=\"token punctuation\">.</span>gcr<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>coredns<span class=\"token punctuation\">:</span><span class=\"token number\">1.3</span><span class=\"token number\">.1</span></code></pre></div>\n<br/>\n<br/>\n<p>마스터 노드를 <code class=\"language-text\">초기화</code>합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span># kubeadm init\nI0824 <span class=\"token number\">02</span><span class=\"token punctuation\">:</span><span class=\"token number\">22</span><span class=\"token punctuation\">:</span><span class=\"token number\">23.982576</span>   <span class=\"token number\">13371</span> version<span class=\"token punctuation\">.</span>go<span class=\"token punctuation\">:</span><span class=\"token number\">248</span><span class=\"token punctuation\">]</span> remote version <span class=\"token keyword\">is</span> <span class=\"token class-name\">much</span> newer<span class=\"token punctuation\">:</span> v1<span class=\"token punctuation\">.</span><span class=\"token number\">18.8</span><span class=\"token punctuation\">;</span> falling <span class=\"token class-name\">back</span> to<span class=\"token punctuation\">:</span> stable<span class=\"token operator\">-</span><span class=\"token number\">1.15</span>\n<span class=\"token punctuation\">[</span>init<span class=\"token punctuation\">]</span> Using <span class=\"token class-name\">Kubernetes</span> version<span class=\"token punctuation\">:</span> v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.12</span>\n<span class=\"token punctuation\">[</span>preflight<span class=\"token punctuation\">]</span> Running pre<span class=\"token operator\">-</span>flight checks\n        <span class=\"token punctuation\">[</span>WARNING Service<span class=\"token operator\">-</span>Kubelet<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> kubelet service <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token class-name\">enabled</span><span class=\"token punctuation\">,</span> please run 'systemctl enable kubelet<span class=\"token punctuation\">.</span>service'\n<span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">preflight</span></span><span class=\"token punctuation\">]</span> Pulling images required <span class=\"token keyword\">for</span> setting up a Kubernetes cluster\n<span class=\"token punctuation\">[</span>preflight<span class=\"token punctuation\">]</span> This might take a minute <span class=\"token keyword\">or</span> two<span class=\"token punctuation\">,</span> depending <span class=\"token keyword\">on</span> the speed of your internet connection\n<span class=\"token punctuation\">[</span>preflight<span class=\"token punctuation\">]</span> You can also perform <span class=\"token keyword\">this</span> action <span class=\"token keyword\">in</span> beforehand <span class=\"token keyword\">using</span> 'kubeadm config images pull'\n<span class=\"token punctuation\">[</span>kubelet<span class=\"token operator\">-</span>start<span class=\"token punctuation\">]</span> Writing kubelet environment file with flags to file <span class=\"token string\">\"/var/lib/kubelet/kubeadm-flags.env\"</span>\n<span class=\"token punctuation\">[</span>kubelet<span class=\"token operator\">-</span>start<span class=\"token punctuation\">]</span> Writing kubelet configuration to file <span class=\"token string\">\"/var/lib/kubelet/config.yaml\"</span>\n<span class=\"token punctuation\">[</span>kubelet<span class=\"token operator\">-</span>start<span class=\"token punctuation\">]</span> Activating the kubelet service\n<span class=\"token punctuation\">[</span>certs<span class=\"token punctuation\">]</span> Using certificateDir folder <span class=\"token string\">\"/etc/kubernetes/pki\"</span>\n<span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">certs</span></span><span class=\"token punctuation\">]</span> Generating <span class=\"token string\">\"ca\"</span> certificate <span class=\"token keyword\">and</span> key\n<span class=\"token punctuation\">[</span>certs<span class=\"token punctuation\">]</span> Generating <span class=\"token string\">\"apiserver-kubelet-client\"</span> certificate <span class=\"token keyword\">and</span> key\n<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span>\n<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>중략<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>\nYour Kubernetes control<span class=\"token operator\">-</span>plane has initialized successfully<span class=\"token operator\">!</span>\nTo start <span class=\"token keyword\">using</span> <span class=\"token class-name\">your</span> cluster<span class=\"token punctuation\">,</span> you need to run the following <span class=\"token keyword\">as</span> <span class=\"token class-name\">a</span> <span class=\"token class-name\">regular</span> user<span class=\"token punctuation\">:</span>\nmkdir <span class=\"token operator\">-</span>p $HOME<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>kube\nsudo cp <span class=\"token operator\">-</span>i <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>kubernetes<span class=\"token operator\">/</span>admin<span class=\"token punctuation\">.</span>conf $HOME<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>kube<span class=\"token operator\">/</span>config\nsudo chown $<span class=\"token punctuation\">(</span>id <span class=\"token operator\">-</span>u<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>$<span class=\"token punctuation\">(</span>id <span class=\"token operator\">-</span>g<span class=\"token punctuation\">)</span> $HOME<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>kube<span class=\"token operator\">/</span>config\nYou should now deploy a pod network to the cluster<span class=\"token punctuation\">.</span>\nRun <span class=\"token string\">\"kubectl apply -f [podnetwork].yaml\"</span> with one of the options <span class=\"token class-name\">listed</span> at<span class=\"token punctuation\">:</span>\nhttps<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>kubernetes<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>docs<span class=\"token operator\">/</span>concepts<span class=\"token operator\">/</span>cluster<span class=\"token operator\">-</span>administration<span class=\"token operator\">/</span>addons<span class=\"token operator\">/</span>\nThen you can <span class=\"token keyword\">join</span> any number of worker nodes <span class=\"token keyword\">by</span> running the following <span class=\"token keyword\">on</span> each <span class=\"token keyword\">as</span> <span class=\"token class-name\">root</span><span class=\"token punctuation\">:</span>\nkubeadm <span class=\"token keyword\">join</span> <span class=\"token number\">10.146</span><span class=\"token number\">.0</span><span class=\"token number\">.6</span><span class=\"token punctuation\">:</span><span class=\"token number\">6443</span> <span class=\"token operator\">--</span>token ofhrxu<span class=\"token punctuation\">.</span>dgsn2pc08glnfj06 \\\n    <span class=\"token operator\">--</span>discovery<span class=\"token operator\">-</span>token<span class=\"token operator\">-</span>ca<span class=\"token operator\">-</span>cert<span class=\"token operator\">-</span><span class=\"token class-name\">hash</span> sha256<span class=\"token punctuation\">:</span>00f7773eea1e619ea4c5698417679475cb07774b26cd7f738fb82a315f643b5a</code></pre></div>\n<br/>\n<br/>\n<p>여기서 <code class=\"language-text\">일반 사용자</code>가 <code class=\"language-text\">kubectl</code> 을 <code class=\"language-text\">사용</code>할 수 있도록 환경변수를 설정합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">mkdir <span class=\"token operator\">-</span>p $HOME<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>kube\nsudo cp <span class=\"token operator\">-</span>i <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>kubernetes<span class=\"token operator\">/</span>admin<span class=\"token punctuation\">.</span>conf $HOME<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>kube<span class=\"token operator\">/</span>config\nsudo chown $<span class=\"token punctuation\">(</span>id <span class=\"token operator\">-</span>u<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>$<span class=\"token punctuation\">(</span>id <span class=\"token operator\">-</span>g<span class=\"token punctuation\">)</span> $HOME<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>kube<span class=\"token operator\">/</span>config</code></pre></div>\n<br/>\n<hr>\n<h3 id=\"worker-노드-설정\" style=\"position:relative;\"><a href=\"#worker-%EB%85%B8%EB%93%9C-%EC%84%A4%EC%A0%95\" aria-label=\"worker 노드 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WORKER 노드 설정</h3>\n<p>도커 실행</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">systemctl daemon<span class=\"token operator\">-</span>reload\nsystemctl enable <span class=\"token operator\">--</span>now docker</code></pre></div>\n<br/>\n<br/>\n<p>kubelet 실행  </p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">systemctl enable <span class=\"token operator\">--</span>now kubelet</code></pre></div>\n<br/>\n<br/>\n<p>로그의 <code class=\"language-text\">마지막 라인의 명령어</code>는 <code class=\"language-text\">워커 노드</code>를 해당 <code class=\"language-text\">클러스터에 추가</code>하는 명령어입니다.<br>\n해당 명령어를 복사해서 <code class=\"language-text\">nasa-node1</code>, <code class=\"language-text\">nasa-node2</code>, <code class=\"language-text\">nasa-node3</code> 노드에서 수행합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span>node1 <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span># kubeadm <span class=\"token keyword\">join</span> <span class=\"token number\">10.146</span><span class=\"token number\">.0</span><span class=\"token number\">.6</span><span class=\"token punctuation\">:</span><span class=\"token number\">6443</span> <span class=\"token operator\">--</span>token ofhrxu<span class=\"token punctuation\">.</span>dgsn2pc08glnfj06 \\<span class=\"token operator\">--</span>discove\nry<span class=\"token operator\">-</span>token<span class=\"token operator\">-</span>ca<span class=\"token operator\">-</span>cert<span class=\"token operator\">-</span><span class=\"token class-name\">hash</span> sha256<span class=\"token punctuation\">:</span>00f7773eea1e619ea4c5698417679475cb07774b26cd7f738fb82a315f643b5\na \n<span class=\"token punctuation\">[</span>preflight<span class=\"token punctuation\">]</span> Running pre<span class=\"token operator\">-</span>flight checks\n<span class=\"token punctuation\">[</span>preflight<span class=\"token punctuation\">]</span> Reading configuration <span class=\"token keyword\">from</span> the cluster<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">preflight</span></span><span class=\"token punctuation\">]</span> FYI<span class=\"token punctuation\">:</span> You can look at <span class=\"token keyword\">this</span> config file with 'kubectl <span class=\"token operator\">-</span>n kube<span class=\"token operator\">-</span>system <span class=\"token keyword\">get</span> cm kubead\nm<span class=\"token operator\">-</span>config <span class=\"token operator\">-</span>oyaml'\n<span class=\"token punctuation\">[</span>kubelet<span class=\"token operator\">-</span>start<span class=\"token punctuation\">]</span> Downloading configuration <span class=\"token keyword\">for</span> the kubelet <span class=\"token keyword\">from</span> the <span class=\"token string\">\"kubelet-config-1.15\"</span> <span class=\"token class-name\">Con</span>\nfigMap <span class=\"token keyword\">in</span> the kube<span class=\"token operator\">-</span>system <span class=\"token keyword\">namespace</span>\n<span class=\"token punctuation\">[</span>kubelet<span class=\"token operator\">-</span>start<span class=\"token punctuation\">]</span> Writing kubelet configuration to file <span class=\"token string\">\"/var/lib/kubelet/config.yaml\"</span>\n<span class=\"token punctuation\">[</span>kubelet<span class=\"token operator\">-</span>start<span class=\"token punctuation\">]</span> Writing kubelet environment file with flags to file \"<span class=\"token operator\">/</span><span class=\"token keyword\">var</span><span class=\"token operator\">/</span>lib<span class=\"token operator\">/</span>kubelet<span class=\"token operator\">/</span>kubead\nm<span class=\"token operator\">-</span>flags<span class=\"token punctuation\">.</span>env\"\n<span class=\"token punctuation\">[</span>kubelet<span class=\"token operator\">-</span>start<span class=\"token punctuation\">]</span> Activating the kubelet service\n<span class=\"token punctuation\">[</span>kubelet<span class=\"token operator\">-</span>start<span class=\"token punctuation\">]</span> Waiting <span class=\"token keyword\">for</span> the kubelet to perform the TLS Bootstrap<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span>\nThis node has joined <span class=\"token class-name\">the</span> cluster<span class=\"token punctuation\">:</span>\n<span class=\"token operator\">*</span> Certificate signing request was sent to apiserver <span class=\"token keyword\">and</span> a response was received<span class=\"token punctuation\">.</span>\n<span class=\"token operator\">*</span> The Kubelet was informed of the <span class=\"token keyword\">new</span> secure connection details<span class=\"token punctuation\">.</span>\nRun 'kubectl <span class=\"token keyword\">get</span> nodes' <span class=\"token keyword\">on</span> the control<span class=\"token operator\">-</span>plane to see <span class=\"token keyword\">this</span> node <span class=\"token keyword\">join</span> the cluster<span class=\"token punctuation\">.</span></code></pre></div>\n<br>\n<h3 id=\"pod-network-add-on-설치하기\" style=\"position:relative;\"><a href=\"#pod-network-add-on-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\" aria-label=\"pod network add on 설치하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Pod network add-on 설치하기</h3>\n<p><code class=\"language-text\">Pod</code> 은 실제로 여러 노드에 걸쳐 배포되는데, Pod 끼리 하나의 네트워크에 있는 것처럼 통신할 수 있습니다.<br>\n이를 <code class=\"language-text\">오버레이 네트워크(Overlay Network)</code>라고 합니다.</p>\n<p>오버레이 네트워크를 지원하는 <code class=\"language-text\">CNI(Container Network Interface) 플러그인</code>을 설치해보겠습니다.<br>\nCNI 에는 여러 종류가 있는데, 이번 포스트는 <code class=\"language-text\">Weave</code> 를 이용합니다.</p>\n<br/>\n<p><code class=\"language-text\">Master</code> 노드에서 <code class=\"language-text\">weave</code>를 설치합니다</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span># kubectl apply <span class=\"token operator\">-</span>f <span class=\"token string\">\"https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d '\\n')\"</span>\nserviceaccount<span class=\"token operator\">/</span>weave<span class=\"token operator\">-</span>net created\nclusterrole<span class=\"token punctuation\">.</span>rbac<span class=\"token punctuation\">.</span>authorization<span class=\"token punctuation\">.</span>k8s<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>weave<span class=\"token operator\">-</span>net created\nclusterrolebinding<span class=\"token punctuation\">.</span>rbac<span class=\"token punctuation\">.</span>authorization<span class=\"token punctuation\">.</span>k8s<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>weave<span class=\"token operator\">-</span>net created\nrole<span class=\"token punctuation\">.</span>rbac<span class=\"token punctuation\">.</span>authorization<span class=\"token punctuation\">.</span>k8s<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>weave<span class=\"token operator\">-</span>net created\nrolebinding<span class=\"token punctuation\">.</span>rbac<span class=\"token punctuation\">.</span>authorization<span class=\"token punctuation\">.</span>k8s<span class=\"token punctuation\">.</span>io<span class=\"token operator\">/</span>weave<span class=\"token operator\">-</span>net created\ndaemonset<span class=\"token punctuation\">.</span>apps<span class=\"token operator\">/</span>weave<span class=\"token operator\">-</span>net created</code></pre></div>\n<p><code class=\"language-text\">CNI</code>를 설치하면 <code class=\"language-text\">CoreDNS Pod</code> 이 <code class=\"language-text\">정상적으로 동작</code>하게 됩니다.</p>\n<br/>\n<p>각 노드와 상태를 확인해보겠습니다 </p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span># kubectl <span class=\"token keyword\">get</span> nodes\nNAME          STATUS   ROLES    AGE     VERSION\nnasa<span class=\"token operator\">-</span>master   Ready    master   <span class=\"token number\">10m</span>     v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.5</span>\nnasa<span class=\"token operator\">-</span>node1    Ready    <span class=\"token operator\">&lt;</span>none<span class=\"token operator\">></span>   3m48s   v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.5</span>\nnasa<span class=\"token operator\">-</span>node2    Ready    <span class=\"token operator\">&lt;</span>none<span class=\"token operator\">></span>   4m15s   v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.5</span>\nnasa<span class=\"token operator\">-</span>node3    Ready    <span class=\"token operator\">&lt;</span>none<span class=\"token operator\">></span>   3m48s   v1<span class=\"token punctuation\">.</span><span class=\"token number\">15.5</span></code></pre></div>\n<br/>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span># kubectl <span class=\"token keyword\">get</span> cs\nNAME                 STATUS    MESSAGE             ERROR\ncontroller<span class=\"token operator\">-</span>manager   Healthy   ok                  \nscheduler            Healthy   ok                  \netcd<span class=\"token operator\">-</span><span class=\"token number\">0</span>               Healthy   <span class=\"token punctuation\">{</span><span class=\"token string\">\"health\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"true\"</span><span class=\"token punctuation\">}</span>   </code></pre></div>\n<br/>\n<br/>\n<p>최종적으로 구성 API, 및 요소가 정상적으로 실행중인지 확인합니다</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span># kubectl <span class=\"token keyword\">get</span> po <span class=\"token operator\">-</span>o custom<span class=\"token operator\">-</span>columns<span class=\"token operator\">=</span>POD<span class=\"token punctuation\">:</span>metadata<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span><span class=\"token named-parameter punctuation\">NODE</span><span class=\"token punctuation\">:</span>spec<span class=\"token punctuation\">.</span>nodeName <span class=\"token operator\">--</span>sort<span class=\"token operator\">-</span><span class=\"token keyword\">by</span> spec<span class=\"token punctuation\">.</span>nodeName \n<span class=\"token operator\">-</span>n kube<span class=\"token operator\">-</span>system\nPOD                                   NODE\nkube<span class=\"token operator\">-</span>scheduler<span class=\"token operator\">-</span>nasa<span class=\"token operator\">-</span>master            nasa<span class=\"token operator\">-</span>master\nweave<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>v7bff                       nasa<span class=\"token operator\">-</span>master\netcd<span class=\"token operator\">-</span>nasa<span class=\"token operator\">-</span>master                      nasa<span class=\"token operator\">-</span>master\nkube<span class=\"token operator\">-</span>apiserver<span class=\"token operator\">-</span>nasa<span class=\"token operator\">-</span>master            nasa<span class=\"token operator\">-</span>master\nkube<span class=\"token operator\">-</span>controller<span class=\"token operator\">-</span>manager<span class=\"token operator\">-</span>nasa<span class=\"token operator\">-</span>master   nasa<span class=\"token operator\">-</span>master\nkube<span class=\"token operator\">-</span>proxy<span class=\"token operator\">-</span>6w9dk                      nasa<span class=\"token operator\">-</span>master\nkube<span class=\"token operator\">-</span>proxy<span class=\"token operator\">-</span>lxn6d                      nasa<span class=\"token operator\">-</span>node1\nweave<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>k2tcb                       nasa<span class=\"token operator\">-</span>node1\ncoredns<span class=\"token operator\">-</span>5c98db65d4<span class=\"token operator\">-</span>8cg79              nasa<span class=\"token operator\">-</span>node1\nkube<span class=\"token operator\">-</span>proxy<span class=\"token operator\">-</span>jqks7                      nasa<span class=\"token operator\">-</span>node2\nweave<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>dd6f2                       nasa<span class=\"token operator\">-</span>node2\ncoredns<span class=\"token operator\">-</span>5c98db65d4<span class=\"token operator\">-</span>zbvbn              nasa<span class=\"token operator\">-</span>node2\nweave<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>k2jc9                       nasa<span class=\"token operator\">-</span>node3\nkube<span class=\"token operator\">-</span>proxy<span class=\"token operator\">-</span>kr9sb                      nasa<span class=\"token operator\">-</span>node3</code></pre></div>\n<hr>\n<h3 id=\"간단한-pods-배포-test\" style=\"position:relative;\"><a href=\"#%EA%B0%84%EB%8B%A8%ED%95%9C-pods-%EB%B0%B0%ED%8F%AC-test\" aria-label=\"간단한 pods 배포 test permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>간단한 pods 배포 TEST</h3>\n<p>간단한 Pod 을 배포해서 동작을 확인해봅시다. 아래 pod-test.yaml 파일을 생성합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">apiVersion<span class=\"token punctuation\">:</span> <span class=\"token class-name\">v1</span>\nkind<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Pod</span>\nmetadata<span class=\"token punctuation\">:</span>\nname<span class=\"token punctuation\">:</span> myapp<span class=\"token operator\">-</span><span class=\"token class-name\">pod</span>\nlabels<span class=\"token punctuation\">:</span>\n    app<span class=\"token punctuation\">:</span> <span class=\"token class-name\">myapp</span>\nspec<span class=\"token punctuation\">:</span>\ncontainers<span class=\"token punctuation\">:</span>\n<span class=\"token operator\">-</span> name<span class=\"token punctuation\">:</span> myapp<span class=\"token operator\">-</span><span class=\"token class-name\">container</span>\n    image<span class=\"token punctuation\">:</span> <span class=\"token class-name\">busybox</span>\n    command<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>'sh'<span class=\"token punctuation\">,</span> '<span class=\"token operator\">-</span>c'<span class=\"token punctuation\">,</span> 'echo Hello Kubernetes<span class=\"token operator\">!</span> <span class=\"token operator\">&amp;&amp;</span> sleep <span class=\"token number\">3600</span>'<span class=\"token punctuation\">]</span></code></pre></div>\n<p>해당 Pod 이 실행되면 <code class=\"language-text\">busybox</code> 라는 경량 리눅스 이미지에 <code class=\"language-text\">Hello Kubernetes!</code> 라는 로그가 잠시 동안 출력되고 Pod 은 종료됩니다.</p>\n<br/>\n<br/>\n<p>PODS 배포</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kube<span class=\"token punctuation\">]</span># kubectl apply <span class=\"token operator\">-</span>f pod<span class=\"token operator\">-</span>test<span class=\"token punctuation\">.</span>yaml\npod<span class=\"token operator\">/</span>nasa<span class=\"token operator\">-</span>pod created</code></pre></div>\n<br/>\n<br/>\n<p>동작 및 로그 확인</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kube<span class=\"token punctuation\">]</span># kubectl <span class=\"token keyword\">get</span> po\nNAME       READY   STATUS    RESTARTS   AGE\nnasa<span class=\"token operator\">-</span>pod   <span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">1</span>     Running   <span class=\"token number\">0</span>          10s\n<span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kube<span class=\"token punctuation\">]</span># \n<span class=\"token punctuation\">[</span>root@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kube<span class=\"token punctuation\">]</span># kubectl logs nasa<span class=\"token operator\">-</span>pod\nHello Kubernetes<span class=\"token operator\">!</span></code></pre></div>\n<p>이로써 기본적인 k8s 클러스터 구성이 완료되었습니다</p>\n<hr>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#-%EC%82%AC%EC%A0%84%EC%A4%80%EB%B9%84\">✔ 사전준비</a></li>\n<li>\n<p><a href=\"#-%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4--%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0-kubeadm\">✌ 쿠버네티스  설치하기 kubeadm</a></p>\n<ul>\n<li><a href=\"#worker-%EB%85%B8%EB%93%9C-%EC%84%A4%EC%A0%95\">WORKER 노드 설정</a></li>\n<li><a href=\"#pod-network-add-on-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\">Pod network add-on 설치하기</a></li>\n<li><a href=\"#%EA%B0%84%EB%8B%A8%ED%95%9C-pods-%EB%B0%B0%ED%8F%AC-test\">간단한 pods 배포 TEST</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"머리말   이전 포스트에서는 kubespay 자동화 툴을 사용해서 K8S 클러스터를 구축 했었습니다. 이번 포스트에서는 kubeadm을 이용해서 K8S 클러스터를 구축하는 방법에 대해서 포스트했습니다.   ✔ 사전준비 사전 준비의 경우 kubespray와 동일하게 GCP VM Instance에서 구성했기 때문에 방법이 동일합니다. 사전 준비는 이전 포스트인 kubespray를 확인해주세요. ✌ 쿠버네티스  설치하기 kubeadm 본격적인 설치 과정입니다.\n은  과  을  때문에 직접 설치해야 합니다.   전체 Server에 아래 를 추가합니다.   CENSOS yum update 도커 설치 전 사전 세팅  도커 저장소…","frontmatter":{"date":"June 29, 2021","title":"[Kubernetes] - Kubernetes 환경구성 on GCP Using kubeadm","categories":"Kubernetes GCP","author":"nasa1515","emoji":"🤦‍♂️"},"fields":{"slug":"/kubernetes-kubeadm/"}},"next":{"id":"22b18939-b966-58ca-8408-1ddb10464062","html":"<p>머리말  </p>\n<p>쿠버네티스 환경을 구성하는 방법은 여러가지가 존재합니다 서버를 준비하는 방법은 또한 여러 가지가 있겠지만<br>\n가장 쉽게 생각해볼 수 있는 건 <code class=\"language-text\">VirtualBox</code> 와 <code class=\"language-text\">Vagrant</code> 를 이용한 <code class=\"language-text\">로컬 VM</code>로 구성하는 것 입니다.<br>\n하지만 이번 포스트에서는 GCP STUDY + Kubernetes STUDY 겸 GCP로 진행했습니다.<br>\n사실 GCP 무료 크레딧이 아까운 마음이 더 크긴 했습니다.</p>\n<hr>\n<h2 id=\"-사전준비\" style=\"position:relative;\"><a href=\"#-%EC%82%AC%EC%A0%84%EC%A4%80%EB%B9%84\" aria-label=\" 사전준비 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✔ 사전준비</h2>\n<ul>\n<li>쿠버네티스는 3개월 마다 새로운 버전이 릴리즈 되고 해당 버전은 9개월 동안 버그와 보안 이슈를 수정하는 패치가 이루어 집니다.  </li>\n<li>이번 포스트에 구성할 노드는 <code class=\"language-text\">Master 노드 하나</code>와 <code class=\"language-text\">Worker 노드 세 개</code>로 총 <code class=\"language-text\">네 개</code>의 서버가 필요합니다.</li>\n<li>\n<p>노드의 최소 요구 사양은 다음과 같습니다.</p>\n<table>\n<thead>\n<tr>\n<th>항목</th>\n<th>사양</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>CPU</td>\n<td>1 CPU 이상</td>\n</tr>\n<tr>\n<td>메모리</td>\n<td>2 GB 이상</td>\n</tr>\n<tr>\n<td>OS</td>\n<td>CentOS 7, RHEL 7, Ubuntu 16.04+ etc.</td>\n</tr>\n</tbody>\n</table>\n</li>\n</ul>\n<br/>\n<p>또한 각 서버는 다음 조건을 만족해야 합니다.</p>\n<ul>\n<li>각 노드가 서로 <code class=\"language-text\">네트워크 연결</code>되어 있어야 합니다.</li>\n<li>\n<p>각 노드는 다음 <code class=\"language-text\">정보가 겹치지 않아야</code> 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">hostname<span class=\"token punctuation\">:</span> hostname\n<span class=\"token class-name\">MAC</span> address<span class=\"token punctuation\">:</span> ip link 또는 ifconfig <span class=\"token operator\">-</span><span class=\"token class-name\">a</span>\nproduct_uuid<span class=\"token punctuation\">:</span> sudo cat <span class=\"token operator\">/</span>sys<span class=\"token operator\">/</span><span class=\"token keyword\">class</span><span class=\"token operator\">/</span>dmi<span class=\"token operator\">/</span>id<span class=\"token operator\">/</span>product_uuid</code></pre></div>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>각 노드가 사용하는 <code class=\"language-text\">포트</code>입니다. <code class=\"language-text\">각 포트는 방화벽에서 모두 허용 되어</code> 있어야 합니다.</p>\n<table>\n<thead>\n<tr>\n<th>노드</th>\n<th>프로토콜</th>\n<th>방향</th>\n<th>포트 범위</th>\n<th align=\"center\">목적</th>\n<th align=\"center\">누가 사용?</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Master</td>\n<td>TCP</td>\n<td>Inbound</td>\n<td>6443</td>\n<td align=\"center\">Kubernetes API server</td>\n<td align=\"center\">All</td>\n</tr>\n<tr>\n<td>Master</td>\n<td>TCP</td>\n<td>Inbound</td>\n<td>2379-2380</td>\n<td align=\"center\">etcd server client API</td>\n<td align=\"center\">kube-apiserver, etcd</td>\n</tr>\n<tr>\n<td>Master</td>\n<td>TCP</td>\n<td>Inbound</td>\n<td>10250</td>\n<td align=\"center\">Kubelet API</td>\n<td align=\"center\">Self, Control plane</td>\n</tr>\n<tr>\n<td>Master</td>\n<td>TCP</td>\n<td>Inbound</td>\n<td>10251</td>\n<td align=\"center\">kube-scheduler</td>\n<td align=\"center\">Self</td>\n</tr>\n<tr>\n<td>Master</td>\n<td>TCP</td>\n<td>Inbound</td>\n<td>10252</td>\n<td align=\"center\">kube-controller-manager</td>\n<td align=\"center\">Self</td>\n</tr>\n<tr>\n<td>Worker</td>\n<td>TCP</td>\n<td>Inbound</td>\n<td>10250</td>\n<td align=\"center\">Kubelet API</td>\n<td align=\"center\">Self, Control plane</td>\n</tr>\n<tr>\n<td>Worker</td>\n<td>TCP</td>\n<td>Inbound</td>\n<td>30000-32767</td>\n<td align=\"center\">NodePort Services</td>\n<td align=\"center\">All</td>\n</tr>\n</tbody>\n</table>\n</li>\n</ul>\n<br/>\n<hr>\n<h2 id=\"-구성-install\" style=\"position:relative;\"><a href=\"#-%EA%B5%AC%EC%84%B1-install\" aria-label=\" 구성 install permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✌ 구성 (Install)</h2>\n<p><strong>구성 전 안내</strong></p>\n<p> <code class=\"language-text\">GCP</code>에는 이미 <code class=\"language-text\">Kubernetes Engine</code>란 이름으로 쿠버네티스를 사용할 수 있는 서비스를 제공하고 있습니다.</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90713985-91cef580-e2e1-11ea-98f2-09c7e0f72c9f.png\" alt=\"스크린샷, 2020-08-20 12-34-57\"></p>\n<br/>\n<p>실제 해당 메뉴에 들어가보면 이렇게 설치 없이 바로 클러스터를 만들 수 있습니다.</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90714040-ba56ef80-e2e1-11ea-91a7-51616910e81e.png\" alt=\"스크린샷, 2020-08-20 12-36-07\"></p>\n<p>하지만 이번 포스트에서는 쿠버스프레이를 이용한 구성방법을 포스팅 할 것이기 때문에 해당 서비스는 넘기겠습니다.</p>\n<br/>\n<hr>\n<h3 id=\"kubespray-로-환경-설정하기\" style=\"position:relative;\"><a href=\"#kubespray-%EB%A1%9C-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\" aria-label=\"kubespray 로 환경 설정하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kubespray 로 환경 설정하기</h3>\n<br/>\n<p><code class=\"language-text\">GCP Console</code>에 접속 후 아래 Spec으로 4개의 Instance를 생성합니다.  [인스턴스 구성 방법] : <a href=\"https://nasa1515.tech/gcp-first/\">“GCP포스트”!!!</a>  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90719826-4e2fb800-e2f0-11ea-94d4-b8f9dc1d31f4.png\" alt=\"스크린샷, 2020-08-20 14-20-27\"></p>\n<br/>\n<p>아래처럼 인스턴스 4개를 생성해야 합니다.</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90720126-eded4600-e2f0-11ea-963e-c7d5203642b8.png\" alt=\"스크린샷, 2020-08-20 14-24-55\"></p>\n<br/>\n<hr>\n<h3 id=\"설치-전-사전-작업\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EC%B9%98-%EC%A0%84-%EC%82%AC%EC%A0%84-%EC%9E%91%EC%97%85\" aria-label=\"설치 전 사전 작업 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>설치 전 사전 작업</h3>\n<p>사전 작업은 master, node1, node2, node3 모두 동일하게 진행합니다.</p>\n<br/>\n<p>사전 작업의 모든 과정은 <code class=\"language-text\">root</code> 권한으로 진행합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">sudo su <span class=\"token operator\">-</span></code></pre></div>\n<br/>\n<br/>\n<p>스왑 메모리 사용 중지  </p>\n<p><code class=\"language-text\">Swap</code> 은 디스크의 일부 공간을 메모리처럼 사용하는 기능입니다.<br>\n<code class=\"language-text\">Kubelet</code> 이 정상 동작할 수 있도록 swap 디바이스와 파일 모두 <code class=\"language-text\">disable</code> 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">swapoff <span class=\"token operator\">-</span>a\necho <span class=\"token number\">0</span> <span class=\"token operator\">></span> <span class=\"token operator\">/</span>proc<span class=\"token operator\">/</span>sys<span class=\"token operator\">/</span>vm<span class=\"token operator\">/</span>swappiness\nsed <span class=\"token operator\">-</span>e '<span class=\"token operator\">/</span>swap<span class=\"token operator\">/</span> s<span class=\"token operator\">/</span><span class=\"token operator\">^</span>#<span class=\"token operator\">*</span><span class=\"token operator\">/</span>#<span class=\"token operator\">/</span>' <span class=\"token operator\">-</span>i <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>fstab</code></pre></div>\n<ul>\n<li><code class=\"language-text\">swapoff -a</code>: paging 과 swap 기능을 끕니다.  </li>\n<li><code class=\"language-text\">/proc/sys/vm/swappiness</code>: 커널 속성을 변경해 swap을 disable 합니다.  </li>\n<li><code class=\"language-text\">/etc/fastab</code>: Swap을 하는 파일 시스템을 찾아 disable 합니다.</li>\n</ul>\n<br/>\n<br/>\n<p>각 노드의 통신을 원활하게 하기 위해 <code class=\"language-text\">방화벽을 해제</code>합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">systemctl disable firewalld\nsystemctl stop firewalld</code></pre></div>\n<br/>\n<br/>\n<p><code class=\"language-text\">SELinux(Security-Enhanced Linux)</code> 종료. 컨테이너가 호스트의 파일시스템에 접속할 수 있도록 해당 기능을 꺼야 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">setenforce <span class=\"token number\">0</span>\nsed <span class=\"token operator\">-</span>i 's<span class=\"token operator\">/</span><span class=\"token operator\">^</span>SELINUX<span class=\"token operator\">=</span>enforcing$<span class=\"token operator\">/</span>SELINUX<span class=\"token operator\">=</span>permissive<span class=\"token operator\">/</span>' <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>selinux<span class=\"token operator\">/</span>config</code></pre></div>\n<br/>\n<br/>\n<p><code class=\"language-text\">RHEL</code> 과 <code class=\"language-text\">CentOS 7</code>에서 <code class=\"language-text\">iptables</code> 관련 이슈가 있어 <code class=\"language-text\">커널 매개변수</code>를 다음과 같이 수정하고 적용합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">cat <span class=\"token operator\">&lt;&lt;</span>EOF <span class=\"token operator\">></span>  <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>sysctl<span class=\"token punctuation\">.</span>d<span class=\"token operator\">/</span>k8s<span class=\"token punctuation\">.</span>conf\nnet<span class=\"token punctuation\">.</span>bridge<span class=\"token punctuation\">.</span>bridge<span class=\"token operator\">-</span>nf<span class=\"token operator\">-</span>call<span class=\"token operator\">-</span>ip6tables <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nnet<span class=\"token punctuation\">.</span>bridge<span class=\"token punctuation\">.</span>bridge<span class=\"token operator\">-</span>nf<span class=\"token operator\">-</span>call<span class=\"token operator\">-</span>iptables <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nEOF\nsysctl <span class=\"token operator\">--</span>system</code></pre></div>\n<br/>\n<br/>\n<p><code class=\"language-text\">br_netfilter 모듈</code>을 <code class=\"language-text\">활성화</code>합니다. <code class=\"language-text\">modprobe br_netfilter 명령어</code>로 해당 모듈을 명시적으로 <code class=\"language-text\">추가</code>합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">$ modprobe br_netfilter\n$ lsmod <span class=\"token operator\">|</span> grep br_netfilter <span class=\"token punctuation\">[</span>확인<span class=\"token punctuation\">]</span></code></pre></div>\n<br/>\n<hr>\n<h3 id=\"설치-진행\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EC%B9%98-%EC%A7%84%ED%96%89\" aria-label=\"설치 진행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>설치 진행</h3>\n<p>앤서블의 인벤토리는 SSH(RSA) 기반으로 동작하므로 VM끼리의 공개 키를 공유해줘야 합니다.</p>\n<p>각 인스턴스 별로 <code class=\"language-text\">호스트 네임</code>을 설정해줍니다.<br>\n사실 GCP는 자동적으로 인스턴스의 이름을 받아오지만 GCP가 아닌 직접 구성을 할 경우에는 호스트네임을 모두 바꿔주어야 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>node3 <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ hostnamectl <span class=\"token keyword\">set</span><span class=\"token operator\">-</span>hostname nasa<span class=\"token operator\">-</span>node3\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>node3 <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ hostname\nnasa<span class=\"token operator\">-</span>node3</code></pre></div>\n<br/>\n<br/>\n<p><code class=\"language-text\">MASTER</code> 인스턴스에 HOST 정보 및 SSH 권한 설정을 합니다. GCP에서는 할 필요가 없지만 직접 구성시에는 필요합니다.</p>\n<p><code class=\"language-text\">/etc/hosts</code>에 각 노드 등록</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ sudo cat <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>hosts\n<span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span>   localhost localhost<span class=\"token punctuation\">.</span>localdomain localhost4 localhost4<span class=\"token punctuation\">.</span>localdomain4\n<span class=\"token punctuation\">::</span><span class=\"token number\">1</span>         localhost localhost<span class=\"token punctuation\">.</span>localdomain localhost6 localhost6<span class=\"token punctuation\">.</span>localdomain6\n<span class=\"token number\">10.178</span><span class=\"token number\">.0</span><span class=\"token number\">.2</span>      nasa<span class=\"token operator\">-</span>master\n<span class=\"token number\">10.178</span><span class=\"token number\">.0</span><span class=\"token number\">.4</span>      nasa<span class=\"token operator\">-</span>node1\n<span class=\"token number\">10.178</span><span class=\"token number\">.0</span><span class=\"token number\">.5</span>      nasa<span class=\"token operator\">-</span>node2\n<span class=\"token number\">10.178</span><span class=\"token number\">.0</span><span class=\"token number\">.3</span>      nasa<span class=\"token operator\">-</span>node3</code></pre></div>\n<br/>\n<br/>\n<p><code class=\"language-text\">ssh 유저 권한 설정</code>을 위해 <code class=\"language-text\">master서버</code>의 <code class=\"language-text\">/etc/sudoers</code> 파일에 내용을 추가 </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90839950-b5eb0f00-e393-11ea-94a3-b7dabd3c2d51.png\" alt=\"스크린샷, 2020-08-21 09-49-17\"></p>\n<p>h43254라는 유저에 대해서 패스워드를 물어보지 않겠다는 설정입니다.</p>\n<br/>\n<br/>\n<p><code class=\"language-text\">공개키 설정</code>을 위해서 SSH 버튼을 눌러서 <code class=\"language-text\">nasa-master</code>에 접속해 <code class=\"language-text\">ssh-keygen -t rsa</code>를 입력. 공개키를 생성합니다.  </p>\n<p>(그 외에 옵션은 Enter를 눌러서 기본값을 넣어줍니다.)</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ ssh<span class=\"token operator\">-</span>keygen <span class=\"token operator\">-</span>t rsa\nGenerating <span class=\"token keyword\">public</span><span class=\"token operator\">/</span><span class=\"token keyword\">private</span> rsa key <span class=\"token class-name\">pair<span class=\"token punctuation\">.</span>\nEnter</span> file <span class=\"token keyword\">in</span> which to save <span class=\"token return-type class-name\">the</span> key <span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>home<span class=\"token operator\">/</span>h43254<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>ssh<span class=\"token operator\">/</span>id_rsa<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> \n<span class=\"token return-type class-name\">Enter</span> passphrase <span class=\"token punctuation\">(</span>empty <span class=\"token keyword\">for</span> <span class=\"token class-name\">no</span> passphrase<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> \nEnter same <span class=\"token class-name\">passphrase</span> again<span class=\"token punctuation\">:</span> \nYour identification has <span class=\"token class-name\">been</span> saved <span class=\"token keyword\">in</span> <span class=\"token operator\">/</span>home<span class=\"token operator\">/</span>h43254<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>ssh<span class=\"token operator\">/</span>id_rsa<span class=\"token punctuation\">.</span>\nYour <span class=\"token keyword\">public</span> key has <span class=\"token class-name\">been</span> saved <span class=\"token keyword\">in</span> <span class=\"token operator\">/</span>home<span class=\"token operator\">/</span>h43254<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>ssh<span class=\"token operator\">/</span>id_rsa<span class=\"token punctuation\">.</span>pub<span class=\"token punctuation\">.</span>\nThe key fingerprint <span class=\"token keyword\">is</span><span class=\"token punctuation\">:</span>\nSHA256<span class=\"token punctuation\">:</span>sr6RS6MW<span class=\"token operator\">/</span>ESkXfbVBi9LTdRSfPm3a2F7VrC9K8e93mc h43254@nasa<span class=\"token operator\">-</span>master\nThe key's randomart image <span class=\"token keyword\">is</span><span class=\"token punctuation\">:</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span><span class=\"token punctuation\">[</span>RSA <span class=\"token number\">2048</span><span class=\"token punctuation\">]</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span>            <span class=\"token punctuation\">.</span><span class=\"token operator\">+</span>o<span class=\"token operator\">+</span>o<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>      <span class=\"token punctuation\">.</span> o   <span class=\"token punctuation\">.</span><span class=\"token operator\">++</span><span class=\"token punctuation\">.</span><span class=\"token operator\">+</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>     <span class=\"token operator\">+</span> o <span class=\"token punctuation\">.</span> <span class=\"token punctuation\">.</span>o<span class=\"token punctuation\">.</span>o<span class=\"token punctuation\">.</span>o<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>    <span class=\"token punctuation\">.</span> o   <span class=\"token range operator\">..</span> o<span class=\"token punctuation\">.</span> o<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>   <span class=\"token punctuation\">.</span> <span class=\"token range operator\">..</span> S   <span class=\"token punctuation\">.</span>  <span class=\"token operator\">+</span>o<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>    o <span class=\"token punctuation\">.</span><span class=\"token operator\">+</span>      <span class=\"token punctuation\">.</span><span class=\"token operator\">+</span>o<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>     <span class=\"token operator\">+</span><span class=\"token operator\">*</span>       o B<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>    <span class=\"token punctuation\">.</span><span class=\"token operator\">+</span><span class=\"token punctuation\">.</span><span class=\"token operator\">+</span>     <span class=\"token punctuation\">.</span> BE<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>   <span class=\"token range operator\">..</span> <span class=\"token operator\">+</span><span class=\"token punctuation\">.</span>      <span class=\"token operator\">=</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">SHA256</span></span><span class=\"token punctuation\">]</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span></code></pre></div>\n<br/>\n<br/>\n<p>키가 잘 만들어 있는지 확인하기 위해서 아래 명령어로 확인합니다. </p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ cd <span class=\"token punctuation\">.</span>ssh\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token punctuation\">.</span>ssh<span class=\"token punctuation\">]</span>$ ls <span class=\"token operator\">-</span>al\ntotal <span class=\"token number\">8</span>\ndrwx<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token punctuation\">.</span> <span class=\"token number\">2</span> h43254 h43254   <span class=\"token number\">38</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">05</span><span class=\"token punctuation\">:</span><span class=\"token number\">31</span> <span class=\"token punctuation\">.</span>\ndrwx<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token punctuation\">.</span> <span class=\"token number\">3</span> h43254 h43254   <span class=\"token number\">74</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">05</span><span class=\"token punctuation\">:</span><span class=\"token number\">28</span> <span class=\"token range operator\">..</span>\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span><span class=\"token punctuation\">.</span> <span class=\"token number\">1</span> h43254 h43254 <span class=\"token number\">1679</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">05</span><span class=\"token punctuation\">:</span><span class=\"token number\">30</span> id_rsa\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span> <span class=\"token number\">1</span> h43254 h43254  <span class=\"token number\">400</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">05</span><span class=\"token punctuation\">:</span><span class=\"token number\">30</span> id_rsa<span class=\"token punctuation\">.</span>pub       ## 정상 생성<span class=\"token punctuation\">.</span></code></pre></div>\n<br/>\n<br/>\n    \n아래 명령어를 통해서 공개키를 복사하고, 나온 명령어를 복사합니다.  \n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token punctuation\">.</span>ssh<span class=\"token punctuation\">]</span>$ cat id_rsa<span class=\"token punctuation\">.</span>pub \nssh<span class=\"token operator\">-</span>rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDMcBYtD<span class=\"token operator\">/</span>NDrxGOyjPJ9DryBOWzoWlVszqI<span class=\"token operator\">+</span>jqSAUeAsZ<span class=\"token operator\">+</span>hwjTtyU60I3vuBn9Ge6HcgKfKUccUyGPickMyTXk2qzeMsa9iN0MOgLZ3GM<span class=\"token comment\">//aFE5z6yoEvjPJ9KxQg9qRrLhUUWqYtBhyegBt26+YdSWF24ZNutp7CRLtVQpwT/opMkY9XTseaD1kaj1BZF8ls2V5WNCgC504JfPKuKBVKcbuOwBIBv6TyZhhGXRWfKTKpma3/L5Yhc4qNOZGDo913/kkwlMpqPb4JQAEasXELfFPMou9vPOaKEK7CDdcJ/EOkXct7d43vnMRa8360okA+BMP7vJ4c4ElW+T0op5rt h43254@nasa-master</span></code></pre></div>\n<br/>\n<br/>\n<p>GCP에 <code class=\"language-text\">공개키를 등록</code>하기 위해서 <code class=\"language-text\">Compute Engine - 메타데이터- SSH</code> 에  서  공개 키를 추가합니다.  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90721321-7e2c8a80-e2f3-11ea-914e-8174cfc57d39.png\" alt=\"스크린샷, 2020-08-20 14-43-15\"></p>\n<p>복사한 키를 넣으면 자동으로 왼쪽에 아이디(여기서는  h43254)이 나타납니다.<br>\n아이디를 확인 한 다음에 저장을 누릅니다. (만약에 나타나지 않았다면 공개키 코드의 띄어쓰기 때문이니 확인해야 합니다)</p>\n<br/>\n<br/>\n<p>메타데이터 정상 확인을 위해 <code class=\"language-text\">NODE1</code>에 접속 후 확인합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>node1 <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ cat <span class=\"token punctuation\">.</span>ssh<span class=\"token operator\">/</span>authorized_keys \n<span class=\"token preprocessor property\"># Added by Google</span>\nssh<span class=\"token operator\">-</span>rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCJjI66r5lO6y<span class=\"token operator\">/</span>3NVCDA9RZt98DCs1LDLL4rScU<span class=\"token operator\">+</span>scCDdIJmEHhqvOSU7bmK<span class=\"token operator\">+</span>a8BezaoqmlQgBWKt0Yj6FqxXyokAs2KBNEJMDA99yTAiyR1omopwsgD7Ce50iUDGs6jWvagPktuUznYyi75hQXoTQKt9FEhjBrpLBxoBZUoBgxa67mkc<span class=\"token operator\">+</span>rn1icoWoKRlAEt1UQzmT13Spx6ueTMYxC5CZIhPlWpTRpe5SthSvuOShv5KZy<span class=\"token operator\">+</span>0ByOycrTUrjDfqIY1zPiOJb5Q92UXbmSbsk2ZEMyD5JCC5kvD4poQBToE<span class=\"token operator\">/</span>mdFcdvfAkta<span class=\"token operator\">/</span>l9qh2qmI8FMHKkelLXM0m82yM0IRStR google<span class=\"token operator\">-</span>ssh <span class=\"token punctuation\">{</span><span class=\"token string\">\"userName\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"h43254@gmail.com\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"expireOn\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"2020-08-20T05:49:24+0000\"</span><span class=\"token punctuation\">}</span>\n<span class=\"token preprocessor property\"># Added by Google</span>\necdsa<span class=\"token operator\">-</span>sha2<span class=\"token operator\">-</span>nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBFwFZIw8RvKf9xUVUx<span class=\"token operator\">+</span>NO3yzwCMFgqTRB2UxxnjqrxImnPWraBpEKdtY4m<span class=\"token operator\">/</span>VIxn9hL26OyF3fD<span class=\"token operator\">+</span>NRGMySo7xlnI<span class=\"token operator\">=</span> google<span class=\"token operator\">-</span>ssh<span class=\"token punctuation\">{</span><span class=\"token string\">\"userName\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"h43254@gmail.com\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"expireOn\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"2020-08-20T05:49:22+0000\"</span><span class=\"token punctuation\">}</span>\n<span class=\"token preprocessor property\"># Added by Google         ###### 정상 등록 확인!!! ######</span>\nssh<span class=\"token operator\">-</span>rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDMcBYtD<span class=\"token operator\">/</span>NDrxGOyjPJ9DryBOWzoWlVszqI<span class=\"token operator\">+</span>jqSAUeAsZ<span class=\"token operator\">+</span>hwjTtyU60I3vuBn9Ge6HcgKfKUccUyGPickMyTXk2qzeMsa9iN0MOgLZ3GM<span class=\"token comment\">//aFE5z6yoEvjPJ9KxQg9qRrLhUUWqYtBhyegBt26+YdSWF24ZNutp7CRLtVQpwT/opMkY9XTseaD1kaj1BZF8ls2V5WNCgC504JfPKuKBVKcbuOwBIBv6TyZhhGXRWfKTKpma3/L5Yhc4qNOZGDo913/kkwlMpqPb4JQAEasXELfFPMou9vPOaKEK7CDdcJ/EOkXct7d43vnMRa8360okA+BMP7vJ4c4ElW+T0op5rt h43254@nasa-master</span>\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>node1 <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ </code></pre></div>\n<br/>\n<p>터미널에서 <code class=\"language-text\">cat .ssh/authorized_keys</code>를 쳐보면 등록된 키를 확인할 수 있습니다.<br>\n자 이제 마스터 &#x3C;-> 노드의 통신이 원활해졌으니 본격적으로 설치를 진행하죠.</p>\n<br/>\n<hr>\n<h2 id=\"-kubespray-설치하기\" style=\"position:relative;\"><a href=\"#-kubespray-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\" aria-label=\" kubespray 설치하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>👍 Kubespray 설치하기</h2>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90722288-85549800-e2f5-11ea-8eb9-aefa22c73f46.png\" alt=\"스크린샷, 2020-08-20 14-57-48\"></p>\n<p>이제 <code class=\"language-text\">Kubespray</code>를 설치해보도록 하겠습니다. Kubespray는 <code class=\"language-text\">Ansible을 기반</code>으로 Kubernetes를 설치하는 도구 입니다.  </p>\n<br/>\n<p>우선 <code class=\"language-text\">Master</code> 인스턴스인 <code class=\"language-text\">nasa-master</code>에서 패키지를 업데이트 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token punctuation\">.</span>ssh<span class=\"token punctuation\">]</span>$ sudo yum update\n<span class=\"token class-name\">Loaded</span> plugins<span class=\"token punctuation\">:</span> fastestmirror\nLoading mirror speeds <span class=\"token keyword\">from</span> cached hostfile\n<span class=\"token operator\">*</span> <span class=\"token keyword\">base</span><span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\n<span class=\"token operator\">*</span> epel<span class=\"token punctuation\">:</span> d2lzkl7pfhq30w<span class=\"token punctuation\">.</span>cloudfront<span class=\"token punctuation\">.</span>net\n<span class=\"token operator\">*</span> extras<span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\n<span class=\"token operator\">*</span> updates<span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\nResolving Dependencies\n<span class=\"token operator\">--</span><span class=\"token operator\">></span> Running transaction check\n<span class=\"token operator\">--</span><span class=\"token operator\">-></span> Package google<span class=\"token operator\">-</span>cloud<span class=\"token operator\">-</span>sdk<span class=\"token punctuation\">.</span>x86_64 <span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">304.0</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span><span class=\"token number\">1</span> will be updated\n<span class=\"token operator\">--</span><span class=\"token operator\">-></span> Package google<span class=\"token operator\">-</span>cloud<span class=\"token operator\">-</span>sdk<span class=\"token punctuation\">.</span>x86_64 <span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">306.0</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span><span class=\"token number\">1</span> will be an update\n<span class=\"token operator\">--</span><span class=\"token operator\">></span> Finished Dependency Resolution\n<span class=\"token range operator\">..</span><span class=\"token range operator\">..</span>\n<span class=\"token range operator\">..</span><span class=\"token range operator\">..</span><span class=\"token punctuation\">(</span>중략<span class=\"token punctuation\">)</span>\nUpdated<span class=\"token punctuation\">:</span>\ngoogle<span class=\"token operator\">-</span>cloud<span class=\"token operator\">-</span>sdk<span class=\"token punctuation\">.</span>x86_64 <span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">306.0</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span><span class=\"token number\">1</span>                                                                                                                                                        \nComplete<span class=\"token operator\">!</span></code></pre></div>\n<br/>\n<br/>\n<p>그리고 <code class=\"language-text\">pip</code>를 설치합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">/</span><span class=\"token punctuation\">]</span>$ sudo yum <span class=\"token operator\">-</span>y install python<span class=\"token operator\">-</span>pip\n<span class=\"token class-name\">Loaded</span> plugins<span class=\"token punctuation\">:</span> fastestmirror\nLoading mirror speeds <span class=\"token keyword\">from</span> cached hostfile\n<span class=\"token operator\">*</span> <span class=\"token keyword\">base</span><span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\n<span class=\"token operator\">*</span> epel<span class=\"token punctuation\">:</span> d2lzkl7pfhq30w<span class=\"token punctuation\">.</span>cloudfront<span class=\"token punctuation\">.</span>net\n<span class=\"token operator\">*</span> extras<span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\n<span class=\"token operator\">*</span> updates<span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\nResolving Dependencies\n<span class=\"token operator\">--</span><span class=\"token operator\">></span> Running transaction check\n<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span>\n<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>중략<span class=\"token punctuation\">)</span>\npython<span class=\"token operator\">-</span>ipaddress<span class=\"token punctuation\">.</span>noarch <span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">1.0</span><span class=\"token number\">.16</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">.</span>el7                                                       \npython<span class=\"token operator\">-</span>setuptools<span class=\"token punctuation\">.</span>noarch <span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">0.9</span><span class=\"token number\">.8</span><span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">.</span>el7                                                       \n\nComplete<span class=\"token operator\">!</span></code></pre></div>\n<br/>\n<br/>\n<p>패키지가 정상적으로 설치되었는지 확인해봅니다  </p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">/</span><span class=\"token punctuation\">]</span>$ pip <span class=\"token operator\">--</span>version\npip <span class=\"token number\">8.1</span><span class=\"token number\">.2</span> <span class=\"token keyword\">from</span> <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>lib<span class=\"token operator\">/</span>python2<span class=\"token punctuation\">.</span><span class=\"token number\">7</span><span class=\"token operator\">/</span>site<span class=\"token operator\">-</span>packages <span class=\"token punctuation\">(</span>python <span class=\"token number\">2.7</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br/>\n<br/>\n<p><code class=\"language-text\">git clone</code> 명령어를 통해서 Kubespray File을 다운로드 합니다.  </p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">$ git <span class=\"token class-name\">clone</span> https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>github<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>kubernetes<span class=\"token operator\">-</span>sigs<span class=\"token operator\">/</span>kubespray<span class=\"token punctuation\">.</span>git</code></pre></div>\n<br/>\n<br/>\n<p>다운로드 완료!!</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">/</span><span class=\"token punctuation\">]</span>$ sudo git <span class=\"token class-name\">clone</span> https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>github<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>kubernetes<span class=\"token operator\">-</span>sigs<span class=\"token operator\">/</span>kubespray<span class=\"token punctuation\">.</span>git\nCloning <span class=\"token keyword\">into</span> 'kubespray'<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span>\nremote<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Enumerating</span> objects<span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> done<span class=\"token punctuation\">.</span>\nremote<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Counting</span> objects<span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token operator\">/</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> done<span class=\"token punctuation\">.</span>\nremote<span class=\"token punctuation\">:</span> Total <span class=\"token number\">46404</span> <span class=\"token punctuation\">(</span>delta <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> reused <span class=\"token number\">2</span> <span class=\"token punctuation\">(</span>delta <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> pack<span class=\"token operator\">-</span>reused <span class=\"token number\">46401</span>\n<span class=\"token class-name\">Receiving</span> objects<span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span><span class=\"token number\">46404</span><span class=\"token operator\">/</span><span class=\"token number\">46404</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13.45</span> MiB <span class=\"token operator\">|</span> <span class=\"token number\">6.09</span> MiB<span class=\"token operator\">/</span>s<span class=\"token punctuation\">,</span> <span class=\"token class-name\">done<span class=\"token punctuation\">.</span>\nResolving</span> deltas<span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span><span class=\"token number\">25881</span><span class=\"token operator\">/</span><span class=\"token number\">25881</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> done<span class=\"token punctuation\">.</span></code></pre></div>\n<br/>\n<br/>\n<p>다운받은 설치 파일은 아래와 같습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">$ cd kubespray<span class=\"token operator\">/</span>\n$ ls <span class=\"token operator\">-</span>alrt</code></pre></div>\n<br/>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">/</span><span class=\"token punctuation\">]</span>$ cd <span class=\"token operator\">/</span>kubespray<span class=\"token operator\">/</span>\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ ls <span class=\"token operator\">-</span>alrt \ntotal <span class=\"token number\">184</span>\ndr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span> <span class=\"token number\">18</span> root root   <span class=\"token number\">241</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token range operator\">..</span>\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">285</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>editorconfig\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">832</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>ansible<span class=\"token operator\">-</span>lint\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root     <span class=\"token number\">0</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>nojekyll\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root    <span class=\"token number\">17</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>markdownlint<span class=\"token punctuation\">.</span>yaml\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root     <span class=\"token number\">0</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>gitmodules\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">1980</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>gitlab<span class=\"token operator\">-</span>ci<span class=\"token punctuation\">.</span>yml\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span>  <span class=\"token number\">2</span> root root   <span class=\"token number\">102</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>gitlab<span class=\"token operator\">-</span>ci\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">1192</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>gitignore\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span>  <span class=\"token number\">3</span> root root    <span class=\"token number\">60</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>github\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">289</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>yamllint\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">531</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> SECURITY_CONTACTS\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">3272</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> RELEASE<span class=\"token punctuation\">.</span>md\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root <span class=\"token number\">12328</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> README<span class=\"token punctuation\">.</span>md\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">283</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> OWNERS_ALIASES\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">121</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> OWNERS\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root    <span class=\"token number\">85</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> Makefile\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root <span class=\"token number\">11342</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> LICENSE\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">969</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> Dockerfile\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">1661</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> CONTRIBUTING<span class=\"token punctuation\">.</span>md\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root    <span class=\"token number\">12</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> CNAME\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root <span class=\"token number\">10127</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> Vagrantfile\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root    <span class=\"token number\">30</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> _config<span class=\"token punctuation\">.</span>yml\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">148</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> code<span class=\"token operator\">-</span>of<span class=\"token operator\">-</span>conduct<span class=\"token punctuation\">.</span>md\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">4526</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> cluster<span class=\"token punctuation\">.</span>yml\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">412</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> ansible_version<span class=\"token punctuation\">.</span>yml\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">927</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> ansible<span class=\"token punctuation\">.</span>cfg\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span> <span class=\"token number\">13</span> root root   <span class=\"token number\">193</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> contrib\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span>  <span class=\"token number\">4</span> root root    <span class=\"token number\">33</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> inventory\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">1468</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> index<span class=\"token punctuation\">.</span>html\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">484</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> facts<span class=\"token punctuation\">.</span>yml\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span>  <span class=\"token number\">3</span> root root   <span class=\"token number\">115</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> extra_playbooks\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span>  <span class=\"token number\">5</span> root root  <span class=\"token number\">4096</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> docs\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span>  <span class=\"token number\">2</span> root root    <span class=\"token number\">21</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> library\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root    <span class=\"token number\">94</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> requirements<span class=\"token punctuation\">.</span>txt\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">1705</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token keyword\">remove</span><span class=\"token operator\">-</span>node<span class=\"token punctuation\">.</span>yml\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">612</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> recover<span class=\"token operator\">-</span>control<span class=\"token operator\">-</span>plane<span class=\"token punctuation\">.</span>yml\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">1172</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> mitogen<span class=\"token punctuation\">.</span>yml\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span>  <span class=\"token number\">2</span> root root  <span class=\"token number\">4096</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> logo\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">726</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> reset<span class=\"token punctuation\">.</span>yml\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">2608</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> scale<span class=\"token punctuation\">.</span>yml\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span> <span class=\"token number\">17</span> root root  <span class=\"token number\">4096</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> roles\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root   <span class=\"token number\">693</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> setup<span class=\"token punctuation\">.</span>py\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span>  <span class=\"token number\">1</span> root root  <span class=\"token number\">1663</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> setup<span class=\"token punctuation\">.</span>cfg</code></pre></div>\n<br/>\n<br/>\n<p><code class=\"language-text\">requirements.txt</code>에 필요한 패키지들이 명시되어 있는데 이를 이용해 패키지 설치를 진행합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ sudo pip install <span class=\"token operator\">-</span>r requirements<span class=\"token punctuation\">.</span>txt\n<span class=\"token class-name\">Collecting</span> ansible<span class=\"token operator\">==</span><span class=\"token number\">2.9</span><span class=\"token number\">.6</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">from</span> <span class=\"token operator\">-</span><span class=\"token return-type class-name\">r</span> requirements<span class=\"token punctuation\">.</span>txt <span class=\"token punctuation\">(</span>line <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token class-name\">Downloading</span> https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>files<span class=\"token punctuation\">.</span>pythonhosted<span class=\"token punctuation\">.</span>org<span class=\"token operator\">/</span>packages<span class=\"token operator\">/</span>ae<span class=\"token operator\">/</span>b7<span class=\"token operator\">/</span>c717363f767f7af33d90af9458d5f1e0960\ndb9c2393a6c221c2ce97ad1aa<span class=\"token operator\">/</span>ansible<span class=\"token operator\">-</span><span class=\"token number\">2.9</span><span class=\"token number\">.6</span><span class=\"token punctuation\">.</span>tar<span class=\"token punctuation\">.</span>gz <span class=\"token punctuation\">(</span><span class=\"token number\">14</span><span class=\"token punctuation\">.</span>2MB<span class=\"token punctuation\">)</span>\n    <span class=\"token number\">100</span><span class=\"token operator\">%</span> <span class=\"token operator\">|</span>████████████████████████████████<span class=\"token operator\">|</span> <span class=\"token number\">14</span><span class=\"token punctuation\">.</span>2MB 75kB<span class=\"token operator\">/</span>s \n<span class=\"token class-name\">Collecting</span> jinja2<span class=\"token operator\">==</span><span class=\"token number\">2.11</span><span class=\"token number\">.1</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">from</span> <span class=\"token operator\">-</span><span class=\"token return-type class-name\">r</span> requirements<span class=\"token punctuation\">.</span>txt <span class=\"token punctuation\">(</span>line <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token class-name\">Downloading</span> https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>files<span class=\"token punctuation\">.</span>pythonhosted<span class=\"token punctuation\">.</span>org<span class=\"token operator\">/</span>packages<span class=\"token operator\">/</span><span class=\"token number\">27</span><span class=\"token operator\">/</span><span class=\"token number\">24</span><span class=\"token operator\">/</span>4f35961e5c669e96f6559760042a55b9bcf\n<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span>\n<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>중략<span class=\"token punctuation\">)</span>\n8e2a0ecf73d21d6b85865da11<span class=\"token operator\">/</span>MarkupSafe<span class=\"token operator\">-</span><span class=\"token number\">1.1</span><span class=\"token number\">.1</span><span class=\"token operator\">-</span>cp27<span class=\"token operator\">-</span>cp27mu<span class=\"token operator\">-</span>manylinux1_x86_64<span class=\"token punctuation\">.</span>whl\nCollecting ruamel<span class=\"token punctuation\">.</span>ordereddict<span class=\"token punctuation\">;</span> platform_python_implementation <span class=\"token operator\">==</span> <span class=\"token string\">\"CPython\"</span> <span class=\"token keyword\">and</span> python_version <span class=\"token operator\">&lt;</span>\n<span class=\"token operator\">=</span> <span class=\"token string\">\"2.7\"</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">from</span> ruamel<span class=\"token punctuation\">.</span>yaml<span class=\"token operator\">==</span><span class=\"token number\">0.16</span><span class=\"token number\">.10</span><span class=\"token operator\">-></span><span class=\"token operator\">-</span><span class=\"token return-type class-name\">r</span> requirements<span class=\"token punctuation\">.</span>txt <span class=\"token punctuation\">(</span>line <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token class-name\">Downloading</span> https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>files<span class=\"token punctuation\">.</span>pythonhosted<span class=\"token punctuation\">.</span>org<span class=\"token operator\">/</span>packages<span class=\"token operator\">/</span>8c<span class=\"token operator\">/</span>d6<span class=\"token operator\">/</span>4971e55c60b972160b911368fa4cd756d68\n739b6616b0cb57d09d8a6ee18<span class=\"token operator\">/</span>ruamel<span class=\"token punctuation\">.</span>ordereddict<span class=\"token operator\">-</span><span class=\"token number\">0.4</span><span class=\"token number\">.14</span><span class=\"token operator\">-</span>cp27<span class=\"token operator\">-</span>cp27mu<span class=\"token operator\">-</span>manylinux1_x86_64<span class=\"token punctuation\">.</span>whl <span class=\"token punctuation\">(</span>93kB<span class=\"token punctuation\">)</span>\n    <span class=\"token number\">100</span><span class=\"token operator\">%</span> <span class=\"token operator\">|</span>████████████████████████████████<span class=\"token operator\">|</span> 102kB <span class=\"token number\">9</span><span class=\"token punctuation\">.</span>2MB<span class=\"token operator\">/</span>s </code></pre></div>\n<br/>\n<br/>\n<p>이 후 정상적으로 <code class=\"language-text\">ansible</code>이 설치된 것을 확인 할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ ansible <span class=\"token operator\">--</span>version\n<span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>lib64<span class=\"token operator\">/</span>python2<span class=\"token punctuation\">.</span><span class=\"token number\">7</span><span class=\"token operator\">/</span>site<span class=\"token operator\">-</span>packages<span class=\"token operator\">/</span>cryptography<span class=\"token operator\">/</span>__init__<span class=\"token punctuation\">.</span>py<span class=\"token punctuation\">:</span><span class=\"token number\">39</span><span class=\"token punctuation\">:</span> CryptographyDeprecationWarning<span class=\"token punctuation\">:</span> Python <span class=\"token number\">2</span> <span class=\"token keyword\">is</span> <span class=\"token class-name\">no</span> longer supported <span class=\"token keyword\">by</span> the Python core team<span class=\"token punctuation\">.</span> Support <span class=\"token keyword\">for</span> it <span class=\"token keyword\">is</span> <span class=\"token class-name\">now</span> <span class=\"token class-name\">deprecated</span> incryptography<span class=\"token punctuation\">,</span> <span class=\"token keyword\">and</span> will <span class=\"token class-name\">be</span> removed <span class=\"token keyword\">in</span> a future release<span class=\"token punctuation\">.</span>\nCryptographyDeprecationWarning<span class=\"token punctuation\">,</span>\nansible <span class=\"token number\">2.9</span><span class=\"token number\">.6</span>\n<span class=\"token class-name\">config</span> file <span class=\"token operator\">=</span> <span class=\"token operator\">/</span>kubespray<span class=\"token operator\">/</span>ansible<span class=\"token punctuation\">.</span>cfg\nconfigured module <span class=\"token class-name\">search</span> path <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>u'<span class=\"token operator\">/</span>kubespray<span class=\"token operator\">/</span>library'<span class=\"token punctuation\">]</span>\nansible python <span class=\"token class-name\">module</span> location <span class=\"token operator\">=</span> <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>lib<span class=\"token operator\">/</span>python2<span class=\"token punctuation\">.</span><span class=\"token number\">7</span><span class=\"token operator\">/</span>site<span class=\"token operator\">-</span>packages<span class=\"token operator\">/</span>ansible\n<span class=\"token class-name\">executable</span> location <span class=\"token operator\">=</span> <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span>ansible\n<span class=\"token class-name\">python</span> version <span class=\"token operator\">=</span> <span class=\"token number\">2.7</span><span class=\"token number\">.5</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">default</span><span class=\"token punctuation\">,</span> Apr  <span class=\"token number\">2</span> <span class=\"token number\">2020</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">:</span><span class=\"token number\">16</span><span class=\"token punctuation\">:</span><span class=\"token number\">51</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>GCC <span class=\"token number\">4.8</span><span class=\"token number\">.5</span> <span class=\"token number\">20150623</span> <span class=\"token punctuation\">(</span>Red Hat <span class=\"token number\">4.8</span><span class=\"token number\">.5</span><span class=\"token operator\">-</span><span class=\"token number\">39</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></code></pre></div>\n<br/>\n<br/>\n<p>이어서 기본 <code class=\"language-text\">inventory/sample</code>을 <code class=\"language-text\">inventory/mycluster</code> 로 복사합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ cp <span class=\"token operator\">-</span>rfp inventory<span class=\"token operator\">/</span>sample inventory<span class=\"token operator\">/</span><span class=\"token class-name\">cluster</span>\ncp<span class=\"token punctuation\">:</span> cannot create directory ‘inventory<span class=\"token operator\">/</span>mycluster’<span class=\"token punctuation\">:</span> Permission denied\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ sudo cp <span class=\"token operator\">-</span>rfp inventory<span class=\"token operator\">/</span>sample inventory<span class=\"token operator\">/</span>mycluster\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ ls <span class=\"token operator\">-</span>alrt inventory<span class=\"token operator\">/</span>mycluster<span class=\"token operator\">/</span>\ntotal <span class=\"token number\">4</span>\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span> <span class=\"token number\">4</span> root root  <span class=\"token number\">52</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> group_vars\n<span class=\"token operator\">-</span>rw<span class=\"token operator\">-</span>r<span class=\"token operator\">--</span>r<span class=\"token operator\">--</span><span class=\"token punctuation\">.</span> <span class=\"token number\">1</span> root root <span class=\"token number\">994</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> inventory<span class=\"token punctuation\">.</span>ini\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span> <span class=\"token number\">3</span> root root  <span class=\"token number\">45</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span> <span class=\"token punctuation\">.</span>\ndrwxr<span class=\"token operator\">-</span>xr<span class=\"token operator\">-</span>x<span class=\"token punctuation\">.</span> <span class=\"token number\">5</span> root root  <span class=\"token number\">50</span> Aug <span class=\"token number\">20</span> <span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">45</span> <span class=\"token range operator\">..</span></code></pre></div>\n<p>inventory를 복사할 디렉토리 이름은 아무이름이나 설정해도 됩니다.</p>\n<br/>\n<br/>\n<p>디렉토리의 <code class=\"language-text\">tree 구조</code>를 보기 위해서 tree 패키지를 설치합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ \n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ sudo yum <span class=\"token operator\">-</span>y install tree\n<span class=\"token class-name\">Loaded</span> plugins<span class=\"token punctuation\">:</span> fastestmirror\nLoading mirror speeds <span class=\"token keyword\">from</span> cached hostfile\n<span class=\"token operator\">*</span> <span class=\"token keyword\">base</span><span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\n<span class=\"token operator\">*</span> epel<span class=\"token punctuation\">:</span> d2lzkl7pfhq30w<span class=\"token punctuation\">.</span>cloudfront<span class=\"token punctuation\">.</span>net\n<span class=\"token operator\">*</span> extras<span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\n<span class=\"token operator\">*</span> updates<span class=\"token punctuation\">:</span> mirror<span class=\"token punctuation\">.</span>navercorp<span class=\"token punctuation\">.</span>com\nResolving Dependencies\n<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span>\n<span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>중략<span class=\"token punctuation\">)</span>\nTransaction test succeeded\nRunning <span class=\"token class-name\">transaction</span>\nInstalling <span class=\"token punctuation\">:</span> tree<span class=\"token operator\">-</span><span class=\"token number\">1.6</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">.</span>el7<span class=\"token punctuation\">.</span>x86_64                                                    <span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">1</span> \nVerifying  <span class=\"token punctuation\">:</span> tree<span class=\"token operator\">-</span><span class=\"token number\">1.6</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">.</span>el7<span class=\"token punctuation\">.</span>x86_64                                                    <span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">1</span> \nInstalled<span class=\"token punctuation\">:</span>\ntree<span class=\"token punctuation\">.</span>x86_64 <span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">1.6</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">.</span>el7                                                                   \nComplete<span class=\"token operator\">!</span></code></pre></div>\n<br/>\n<br/>\n<p><code class=\"language-text\">tree</code>로 <code class=\"language-text\">group_vars 디렉토리</code>를 보면 설치에 필요한 <code class=\"language-text\">yml 파일</code>이 있는걸 볼 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span><span class=\"token class-name\">master</span> kubespray<span class=\"token punctuation\">]</span>$ tree inventory<span class=\"token operator\">/</span>cluster<span class=\"token operator\">/</span>group_vars\ninventory<span class=\"token operator\">/</span>mycluster<span class=\"token operator\">/</span>group_vars\n├── all\n│   ├── all<span class=\"token punctuation\">.</span>yml\n│   ├── aws<span class=\"token punctuation\">.</span>yml\n│   ├── azure<span class=\"token punctuation\">.</span>yml\n│   ├── containerd<span class=\"token punctuation\">.</span>yml\n│   ├── coreos<span class=\"token punctuation\">.</span>yml\n│   ├── docker<span class=\"token punctuation\">.</span>yml\n│   ├── gcp<span class=\"token punctuation\">.</span>yml\n│   ├── oci<span class=\"token punctuation\">.</span>yml\n│   ├── openstack<span class=\"token punctuation\">.</span>yml\n│   └── vsphere<span class=\"token punctuation\">.</span>yml\n├── etcd<span class=\"token punctuation\">.</span>yml\n└── k8s<span class=\"token operator\">-</span>cluster\n    ├── addons<span class=\"token punctuation\">.</span>yml\n    ├── k8s<span class=\"token operator\">-</span>cluster<span class=\"token punctuation\">.</span>yml\n    ├── k8s<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>calico<span class=\"token punctuation\">.</span>yml\n    ├── k8s<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>canal<span class=\"token punctuation\">.</span>yml\n    ├── k8s<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>cilium<span class=\"token punctuation\">.</span>yml\n    ├── k8s<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>contiv<span class=\"token punctuation\">.</span>yml\n    ├── k8s<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>flannel<span class=\"token punctuation\">.</span>yml\n    ├── k8s<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>kube<span class=\"token operator\">-</span>router<span class=\"token punctuation\">.</span>yml\n    ├── k8s<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>macvlan<span class=\"token punctuation\">.</span>yml\n    └── k8s<span class=\"token operator\">-</span>net<span class=\"token operator\">-</span>weave<span class=\"token punctuation\">.</span>yml\n<span class=\"token number\">2</span> directories<span class=\"token punctuation\">,</span> <span class=\"token number\">21</span> files</code></pre></div>\n<br/>\n<br/>\n<p>설치를 위해 <code class=\"language-text\">inventory.ini</code>를 수정합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">vi inventory<span class=\"token operator\">/</span>mycluster<span class=\"token operator\">/</span>inventory<span class=\"token punctuation\">.</span>ini</code></pre></div>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90841465-b7b6d180-e397-11ea-9c8b-a129f1e9b5ce.png\" alt=\"스크린샷, 2020-08-21 10-18-49\"></p>\n<ul>\n<li><code class=\"language-text\">[all]</code> 그룹에는 인스턴스의 내부 아이피를 입력합니다  </li>\n<li><code class=\"language-text\">[kube-master]</code> 그룹에는 마스터로 사용할 인스턴스 명을 넣습니다.</li>\n<li><code class=\"language-text\">[etcd]</code> 그룹에는 etcd를 사용할 인스턴스를 입력합니다 (홀수)</li>\n<li><code class=\"language-text\">[kube-node]</code> 그룹에는 노드로 사용 할 인스턴스 명을 넣습니다.</li>\n</ul>\n<br/>\n<br/>\n<p><code class=\"language-text\">SSH KEY</code>를 한번 사용해서 마스터와 동기화 시켜줍니다</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ ssh h43254@nasa<span class=\"token operator\">-</span>node1\n<span class=\"token class-name\">Last</span> login<span class=\"token punctuation\">:</span> Thu Aug <span class=\"token number\">20</span> <span class=\"token number\">09</span><span class=\"token punctuation\">:</span><span class=\"token number\">12</span><span class=\"token punctuation\">:</span><span class=\"token number\">40</span> <span class=\"token number\">2020</span> <span class=\"token keyword\">from</span> nasa<span class=\"token operator\">-</span>master<span class=\"token punctuation\">.</span>asia<span class=\"token operator\">-</span>northeast3<span class=\"token operator\">-</span>a<span class=\"token punctuation\">.</span>c<span class=\"token punctuation\">.</span>nasa1515<span class=\"token punctuation\">.</span><span class=\"token keyword\">internal</span>\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>node1 <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ exit\nlogout\nConnection to nasa<span class=\"token operator\">-</span>node1 closed<span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ ssh h43254@nasa<span class=\"token operator\">-</span>node2\nThe authenticity of host 'nasa<span class=\"token operator\">-</span>node2 <span class=\"token punctuation\">(</span><span class=\"token number\">10.178</span><span class=\"token number\">.0</span><span class=\"token number\">.5</span><span class=\"token punctuation\">)</span>' can't be established<span class=\"token punctuation\">.</span>\nECDSA key fingerprint <span class=\"token keyword\">is</span> <span class=\"token class-name\">SHA256</span><span class=\"token punctuation\">:</span><span class=\"token operator\">+</span>Pcsu6s4ImB0kob1TZ41ieS8wz2drCalVIVzBawpRlk<span class=\"token punctuation\">.</span>\nECDSA key fingerprint <span class=\"token keyword\">is</span> <span class=\"token class-name\">MD5</span><span class=\"token punctuation\">:</span><span class=\"token number\">26</span><span class=\"token punctuation\">:</span>6a<span class=\"token punctuation\">:</span><span class=\"token number\">41</span><span class=\"token punctuation\">:</span><span class=\"token number\">28</span><span class=\"token punctuation\">:</span>c8<span class=\"token punctuation\">:</span>5a<span class=\"token punctuation\">:</span><span class=\"token number\">77</span><span class=\"token punctuation\">:</span>3e<span class=\"token punctuation\">:</span><span class=\"token number\">04</span><span class=\"token punctuation\">:</span><span class=\"token number\">7d</span><span class=\"token punctuation\">:</span><span class=\"token number\">88</span><span class=\"token punctuation\">:</span>1e<span class=\"token punctuation\">:</span><span class=\"token number\">14</span><span class=\"token punctuation\">:</span><span class=\"token number\">44</span><span class=\"token punctuation\">:</span>d8<span class=\"token punctuation\">:</span><span class=\"token number\">14</span><span class=\"token punctuation\">.</span>\nAre you sure you want to <span class=\"token keyword\">continue</span> connecting <span class=\"token punctuation\">(</span>yes<span class=\"token operator\">/</span>no<span class=\"token punctuation\">)</span><span class=\"token punctuation\">?</span> <span class=\"token class-name\">yes</span>\nWarning<span class=\"token punctuation\">:</span> Permanently added 'nasa<span class=\"token operator\">-</span>node2' <span class=\"token punctuation\">(</span>ECDSA<span class=\"token punctuation\">)</span> to the list of known <span class=\"token class-name\">hosts<span class=\"token punctuation\">.</span>\nLast</span> login<span class=\"token punctuation\">:</span> Thu Aug <span class=\"token number\">20</span> <span class=\"token number\">09</span><span class=\"token punctuation\">:</span><span class=\"token number\">12</span><span class=\"token punctuation\">:</span><span class=\"token number\">40</span> <span class=\"token number\">2020</span> <span class=\"token keyword\">from</span> nasa<span class=\"token operator\">-</span>master<span class=\"token punctuation\">.</span>asia<span class=\"token operator\">-</span>northeast3<span class=\"token operator\">-</span>a<span class=\"token punctuation\">.</span>c<span class=\"token punctuation\">.</span>nasa1515<span class=\"token punctuation\">.</span><span class=\"token keyword\">internal</span>\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>node2 <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ exit\nlogout\nConnection to nasa<span class=\"token operator\">-</span>node2 closed<span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ ssh h43254@nasa<span class=\"token operator\">-</span>node3\n<span class=\"token class-name\">Last</span> login<span class=\"token punctuation\">:</span> Fri Aug <span class=\"token number\">21</span> <span class=\"token number\">00</span><span class=\"token punctuation\">:</span><span class=\"token number\">43</span><span class=\"token punctuation\">:</span><span class=\"token number\">40</span> <span class=\"token number\">2020</span> <span class=\"token keyword\">from</span> <span class=\"token number\">35.235</span><span class=\"token number\">.240</span><span class=\"token number\">.229</span>\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>node3 <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ exit\nlogout\nConnection to nasa<span class=\"token operator\">-</span>node3 closed<span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">[</span>h43254@nasa<span class=\"token operator\">-</span>master <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span>$ </code></pre></div>\n<p>위와 같이 <code class=\"language-text\">ssh</code>로 한번씩 접속만 해주면 됩니다.</p>\n<br/>\n<br/>\n<p>모두 완료 되었으면 필요로 하는 <code class=\"language-text\">의존성 및 설정</code>을 세팅합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">$ ansible<span class=\"token operator\">-</span>playbook <span class=\"token operator\">-</span>i kubespray<span class=\"token operator\">/</span>inventory<span class=\"token operator\">/</span>cluster<span class=\"token operator\">/</span>inventory<span class=\"token punctuation\">.</span>ini <span class=\"token operator\">-</span>v <span class=\"token operator\">--</span>become <span class=\"token operator\">--</span>become<span class=\"token operator\">-</span>user<span class=\"token operator\">=</span>root kubespray<span class=\"token operator\">/</span>cluster<span class=\"token punctuation\">.</span>yml</code></pre></div>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90844636-5692fc00-e39f-11ea-9bce-2d1bea280a1c.png\" alt=\"스크린샷, 2020-08-21 11-11-23\">\n<code class=\"language-text\">skipped</code>이 많긴하지만 여러 테스트를 하며 설치를 해서 상관없습니다</p>\n<br/>\n<br/>\n<p>간혹가다 다음과 같은 에러가 발생할 경우에는 디렉토리를 수동으로 생성해주면 됩니다</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90846348-e71f0b80-e3a2-11ea-91c9-ffecd03462cb.png\" alt=\"스크린샷, 2020-08-21 10-42-48\"></p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">sudo mkdir credentials</code></pre></div>\n<br/>\n<br/>\n<p>설치가 완료되고 <code class=\"language-text\">root 권한</code>으로 <code class=\"language-text\">노드 정보</code>를 정상적으로 받아옴을 확인합니다  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90846161-91e2fa00-e3a2-11ea-86e4-cbaf96a90258.png\" alt=\"스크린샷, 2020-08-21 11-36-30\"></p>\n<hr>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#-%EC%82%AC%EC%A0%84%EC%A4%80%EB%B9%84\">✔ 사전준비</a></li>\n<li>\n<p><a href=\"#-%EA%B5%AC%EC%84%B1-install\">✌ 구성 (Install)</a></p>\n<ul>\n<li><a href=\"#kubespray-%EB%A1%9C-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\">Kubespray 로 환경 설정하기</a></li>\n<li><a href=\"#%EC%84%A4%EC%B9%98-%EC%A0%84-%EC%82%AC%EC%A0%84-%EC%9E%91%EC%97%85\">설치 전 사전 작업</a></li>\n<li><a href=\"#%EC%84%A4%EC%B9%98-%EC%A7%84%ED%96%89\">설치 진행</a></li>\n</ul>\n</li>\n<li><a href=\"#-kubespray-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\">👍 Kubespray 설치하기</a></li>\n</ul>\n</div>","frontmatter":{"date":"June 29, 2021","title":"[Kubernetes] - Kubernetes 환경구성 on GCP Using KubeSpary","categories":"Kubernetes GCP","author":"nasa1515","emoji":"🤦‍♂️"},"fields":{"slug":"/kubetnetes-kubespary/"}},"prev":{"id":"b10caab8-cb55-5a70-84d6-bbb3cda063ef","html":"<h2 id=\"-발생-에러\" style=\"position:relative;\"><a href=\"#-%EB%B0%9C%EC%83%9D-%EC%97%90%EB%9F%AC\" aria-label=\" 발생 에러 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✔ 발생 에러</h2>\n<p>상황 : kubespray로 <code class=\"language-text\">ansible-playbook</code> 명령어 구동 중 “assertion: groups.etcd | length is not divisibleby 2” 에러 발생”</p>\n<br/>\n<ul>\n<li>\n<p>kubespray로 <code class=\"language-text\">ansible-playbook</code> 명령어 진행 시 <code class=\"language-text\">\"assertion: groups.etcd | length is not divisibleby 2\"</code> 에러가 발생할 수 있습니다.</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90841029-8db0df80-e396-11ea-9580-2521ddd039ff.png\" alt=\"스크린샷, 2020-08-21 10-10-28\"></p>\n<p>캡쳐 이미지를 보면 특정노드는 성공했는데 특정노드는 실패했습니다</p>\n</li>\n</ul>\n<br/>\n<hr>\n<h2 id=\"-원인\" style=\"position:relative;\"><a href=\"#-%EC%9B%90%EC%9D%B8\" aria-label=\" 원인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✌ 원인</h2>\n<ul>\n<li>\n<p>해당 에러는 아래 이미지와 같이 <code class=\"language-text\">inventory.ini</code> 파일에 지정한 <code class=\"language-text\">etcd</code>가 <code class=\"language-text\">짝수</code>인 경우에 발생합니다.</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90841122-d10b4e00-e396-11ea-9848-425e4215a799.png\" alt=\"스크린샷, 2020-08-21 10-12-18\"></p>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>kubespray/roles/kubernetes/preinstall/tasks/0020-verify-settings.yml 코드 확인</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90841237-25aec900-e397-11ea-9519-93ec3550d18a.png\" alt=\"스크린샷, 2020-08-21 10-14-45\"></p>\n<p>해당 코드가 <code class=\"language-text\">etcd</code>의 갯수가 짝수일 경우에 에러를 표출합니다</p>\n</li>\n</ul>\n<br/>\n<hr>\n<h2 id=\"해결\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0\" aria-label=\"해결 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>👍해결</h2>\n<ul>\n<li>\n<p>문제해결하기 위해선 <code class=\"language-text\">etcd를 홀수</code>로 설정하거나 <code class=\"language-text\">-e ignore_assert_errors=yes</code> 옵션을 추가하여 해결 할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># ex\nansible-playbook -i kubespray/inventory/cluster/inventory.ini \\\n-v --become --become-user=root kubespray/cluster.yml -e ignore_assert_errors=yes</code></pre></div>\n</li>\n</ul>\n<br/>\n<ul>\n<li>저같은 경우 테스트용이라서 특정 노드를 <code class=\"language-text\">etcd</code>로 하나 추가해 해결 후 설치까지 확인 했습니다.</li>\n</ul>\n<br/>\n<ul>\n<li><code class=\"language-text\">설정파일</code>\n<img src=\"https://user-images.githubusercontent.com/69498804/90841465-b7b6d180-e397-11ea-9c8b-a129f1e9b5ce.png\" alt=\"스크린샷, 2020-08-21 10-18-49\"></li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>정상적으로 설치가 되었습니다.</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90844636-5692fc00-e39f-11ea-9bce-2d1bea280a1c.png\" alt=\"스크린샷, 2020-08-21 11-11-23\">\n<code class=\"language-text\">skipped</code>이 많긴하지만 여러 테스트를 하며 설치를 해서 상관없습니다</p>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p><code class=\"language-text\">root 권한</code>으로 <code class=\"language-text\">노드 정보</code>를 정상적으로 받아옴을 확인합니다</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/90846161-91e2fa00-e3a2-11ea-86e4-cbaf96a90258.png\" alt=\"스크린샷, 2020-08-21 11-36-30\"></p>\n</li>\n</ul>\n<br/>\n<hr>\n<h2 id=\"권장\" style=\"position:relative;\"><a href=\"#%EA%B6%8C%EC%9E%A5\" aria-label=\"권장 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>👏권장</h2>\n<h3 id=\"etcd는-홀수로-사용하는것을-권장-합니다\" style=\"position:relative;\"><a href=\"#etcd%EB%8A%94-%ED%99%80%EC%88%98%EB%A1%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94%EA%B2%83%EC%9D%84-%EA%B6%8C%EC%9E%A5-%ED%95%A9%EB%8B%88%EB%8B%A4\" aria-label=\"etcd는 홀수로 사용하는것을 권장 합니다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>etcd는 홀수로 사용하는것을 권장 합니다.</h3>\n<p>짝수로 사용할 경우 <code class=\"language-text\">스플릿 브레인(Split Brain)</code> 현상이 발생하여 네트워크 단절로 인한 통신 장애 등 문제가 발생 할 여지가 존재합니다.<br>\n이러한 이유로 실제 서비스 환경에서는 etcd 클러스터를 홀수로 사용하는 것이 좋습니다.</p>\n<br/>\n<ul>\n<li>\n<p><code class=\"language-text\">스플릿 브레인(Split Brain)</code></p>\n<p>일반적으로 클러스터로 구성된 두 시스템 그룹간 네트워크의 일시적 동시 단절현상이 발생 시 나타나는 현상.</p>\n<p>클러스터 상의 모든 노드들은 노드 각자가 자신을 <code class=\"language-text\">primary</code>라고 인식하게 되는 상황을 말합니다.<br>\n즉, 어느 특정 리소스에 대한 두 시스템 그룹 간의 모든 네트워크 연결이 동시에 실패하면 네트워크 파티션이 발생합니다.<br>\n이러한 상태가 발생하면 파티션 양쪽의 시스템이 각각 반대쪽에서 응용 프로그램을 재시작하여<br>\n<code class=\"language-text\">중복 서비스 또는 \"스플릿 브레인(split-brain)\"</code>을 유발합니다.  </p>\n<p><code class=\"language-text\">스플릿 브레인(split-brain)</code>은 클러스터로 구성된 독립적인 두 시스템이<br>\n<code class=\"language-text\">특정 리소스(일반적으로 파일 시스템 또는 볼륨)</code>에 대한 <code class=\"language-text\">배타적 액세스</code> 권한이 있다고 가정할 경우에 발생합니다.  </p>\n<p>네트워크 파티션으로 인해 발생하는 가장 심각한 문제는 <code class=\"language-text\">공유 디스크의 데이터</code>에 <code class=\"language-text\">영향</code>을 준다는 점입니다.</p>\n</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#-%EB%B0%9C%EC%83%9D-%EC%97%90%EB%9F%AC\">✔ 발생 에러</a></li>\n<li><a href=\"#-%EC%9B%90%EC%9D%B8\">✌ 원인</a></li>\n<li><a href=\"#%ED%95%B4%EA%B2%B0\">👍해결</a></li>\n<li>\n<p><a href=\"#%EA%B6%8C%EC%9E%A5\">👏권장</a></p>\n<ul>\n<li><a href=\"#etcd%EB%8A%94-%ED%99%80%EC%88%98%EB%A1%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94%EA%B2%83%EC%9D%84-%EA%B6%8C%EC%9E%A5-%ED%95%A9%EB%8B%88%EB%8B%A4\">etcd는 홀수로 사용하는것을 권장 합니다.</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"June 29, 2021","title":"[Error Report] - length is not divisibleby 2","categories":"Kubernetes Error-Report","author":"nasa1515","emoji":"🤦‍♂️"},"fields":{"slug":"/kubernetes-error1/"}},"site":{"siteMetadata":{"siteUrl":"https://nasa1515.com","comments":{"utterances":{"repo":"nasa1515/nasablog"}}}}},"pageContext":{"slug":"/kubernetes-kubeadm/","nextSlug":"/kubetnetes-kubespary/","prevSlug":"/kubernetes-error1/"}},"staticQueryHashes":["1073350324","2938748437"]}