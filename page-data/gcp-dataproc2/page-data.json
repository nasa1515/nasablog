{"componentChunkName":"component---src-templates-blog-template-js","path":"/gcp-dataproc2/","result":{"data":{"cur":{"id":"c0b1f1d9-1ce1-51df-9998-f2fdcca0e5a7","html":"<p>ë¨¸ë¦¬ë§  </p>\n<p>ì €ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œ DataProcì— ëŒ€í•œ ì„¤ëª…ê³¼ ê°„ë‹¨í•œ ì‚¬ìš©ë²•ì„ ë‹¤ë¤„ë´¤ì—ˆìŠµë‹ˆë‹¤.<br>\nì´ë²ˆì—ëŠ” DataProc Clusterì— Pyspark Scriptë¥¼ ì‚¬ìš©í•´ì„œ\nìë™í™” JOBì„ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤. íŒŒì´ì¬ì„ ì²¨ê°€í•´ì„œ  </p>\n<hr>\n<h2 id=\"-data\" style=\"position:relative;\"><a href=\"#-data\" aria-label=\" data permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>âœ” Data</h2>\n<p>Dataì˜ ê²½ìš°ì—ëŠ” ì´ì „ í¬ìŠ¤íŠ¸ì—ì„œ ë‹¤ë¤˜ì—ˆë˜ Covid-19ì˜ ê¸°ìƒ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì§„í–‰í•©ë‹ˆë‹¤.  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116961186-9e637480-acdd-11eb-906f-9e340165dee1.JPG\" alt=\"12312312\"></p>\n<ul>\n<li>ìš©ëŸ‰ : ì•½ 51GB</li>\n<li>í–‰ : 542,304,210</li>\n</ul>\n<br/>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116961225-bfc46080-acdd-11eb-930e-ec68574417e5.JPG\" alt=\"2222\"></p>\n<ul>\n<li>ë°ì´í„° í˜•ì‹ ìš”ì•½</li>\n</ul>\n<br/>\n<hr>\n<h2 id=\"-python-script\" style=\"position:relative;\"><a href=\"#-python-script\" aria-label=\" python script permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ‘ Python Script</h2>\n<p>ìœ„ì˜ ë°ì´í„°ì—ì„œ íŠ¹ì • ê·¸ë£¹(ë‚˜ë¼, ë‚ ì§œ) ë³„ë¡œ MAX,MIN,AVG ê°’ë“¤ì˜ í‰ê·  ê°’ì„ êµ¬í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>context <span class=\"token keyword\">import</span> SparkContext\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>session <span class=\"token keyword\">import</span> SparkSession\nsc <span class=\"token operator\">=</span> SparkContext<span class=\"token punctuation\">(</span><span class=\"token string\">'local'</span><span class=\"token punctuation\">)</span>\nspark <span class=\"token operator\">=</span> SparkSession<span class=\"token punctuation\">(</span>sc<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>spark<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n\nread_path <span class=\"token operator\">=</span> <span class=\"token string\">\"gs://nasa_us/\"</span>\nwrite_path <span class=\"token operator\">=</span> <span class=\"token string\">'gs://proc_result/result/'</span>\n\n\n<span class=\"token comment\"># def for columns cheange</span>\n\n<span class=\"token comment\"># ------------------------------------------------------------------</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">renameCols</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> old_columns<span class=\"token punctuation\">,</span> new_columns<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> old_col<span class=\"token punctuation\">,</span>new_col <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>old_columns<span class=\"token punctuation\">,</span>new_columns<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        df <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>withColumnRenamed<span class=\"token punctuation\">(</span>old_col<span class=\"token punctuation\">,</span>new_col<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> df\n\n\n<span class=\"token comment\"># Old_columns</span>\nold_columns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'avg(min_temperature_air_2m_f)'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'avg(max_temperature_air_2m_f)'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'avg(avg_temperature_air_2m_f)'</span>\n                <span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># New_columns</span>\nnew_columns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'temperature_air_min_avg'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'temperature_air_max_avg'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'temperature_air_avg_avg'</span>\n                <span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># --------------------------------------------</span>\n<span class=\"token comment\"># ----------------------</span>\n\n<span class=\"token comment\"># Read CSV from GCS</span>\ndf <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span>read_path<span class=\"token punctuation\">,</span> header<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> inferSchema<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># data transform</span>\ndf <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>groupBy<span class=\"token punctuation\">(</span><span class=\"token string\">'country'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'date'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>agg<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">'min_temperature_air_2m_f'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'avg'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'max_temperature_air_2m_f'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'avg'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'avg_temperature_air_2m_f'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'avg'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\ndf2 <span class=\"token operator\">=</span> renameCols<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> old_columns<span class=\"token punctuation\">,</span> new_columns<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Write CSV to GCS</span>\ndf2<span class=\"token punctuation\">.</span>coalesce<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"header\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"true\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>mode<span class=\"token punctuation\">(</span><span class=\"token string\">\"overwrite\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span>write_path<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>ê°„ë‹¨ ì„¤ëª… : GCSì—ì„œ CSV Formatì˜ Dataë¥¼ ì½ê³  ETL ì‘ì—… í›„ ê²°ê³¼ë¥¼ GCSì— ì €ì¥  </li>\n<li>Bigquery Table Dataë¥¼ csví™” ì‹œí‚¤ê³  GCSì— ì €ì¥í•˜ëŠ” ë°©ë²•ì€ <a href=\"https://nasa1515.tech/gcp_dataproc/\">ì´ì „í¬ìŠ¤íŠ¸</a>ë¥¼ í™•ì¸í•˜ì„¸ìš”</li>\n</ul>\n<br/>\n<hr>\n<h2 id=\"-dataproc-job-ìƒì„±\" style=\"position:relative;\"><a href=\"#-dataproc-job-%EC%83%9D%EC%84%B1\" aria-label=\" dataproc job ìƒì„± permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ‘Œ DataProc Job ìƒì„±</h2>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116962299-91945000-ace0-11eb-8e8f-20ea0f9f5b15.JPG\" alt=\"333\"></p>\n<ul>\n<li>ìœ„ì™€ ê°™ì´ DataProc - JOB -> ì‘ì—… ì œì¶œë¡œ JOBì„ ìƒì„±í•©ë‹ˆë‹¤.  </li>\n</ul>\n<br/>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116962386-c6a0a280-ace0-11eb-96f5-aaaad00c4588.JPG\" alt=\"44444\"></p>\n<ul>\n<li>ClusterëŠ” ì‹¤í–‰ í•  Clusterë¥¼ ì§€ì •í•©ë‹ˆë‹¤.</li>\n<li>ì‘ì—… ìœ í˜•ì€ Pysparkë¥¼ ì„ íƒí•©ë‹ˆë‹¤. </li>\n<li>Python Fileì˜ ê²½ìš° ë¯¸ë¦¬ GCSì— ì˜¬ë ¤ë†“ê³  ì§€ì •í•˜ë©´ ë©ë‹ˆë‹¤.  </li>\n</ul>\n<br/>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116962498-12ebe280-ace1-11eb-835a-2b85ed26c91c.JPG\" alt=\"ìº¡ì²˜55555\"></p>\n<ul>\n<li>ìœ„ì™€ ê°™ì´ í•´ë‹¹ ì‘ì—…ì´ ìƒì„±ë˜ë©´ì„œ ì‹¤í–‰ë˜ê²Œ ë˜ê³ <br>\nJOBì˜ ì™„ë£Œ ëœ í›„ì—ëŠ” ê²°ê³¼ ë° ë¡œê·¸ê°€ ì¶œë ¥ë˜ê²Œ ë©ë‹ˆë‹¤.  </li>\n</ul>\n<br/>\n<hr>\n<h2 id=\"-ê²°ê³¼-í™•ì¸\" style=\"position:relative;\"><a href=\"#-%EA%B2%B0%EA%B3%BC-%ED%99%95%EC%9D%B8\" aria-label=\" ê²°ê³¼ í™•ì¸ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ±â€ğŸ ê²°ê³¼ í™•ì¸</h2>\n<p>Script ì‹¤í–‰ëŒ€ë¡œ GCSì— ETL ê²°ê³¼ íŒŒì¼ì´ ë‹¤ìŒê³¼ ê°™ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116962590-5c3c3200-ace1-11eb-8614-8e54e3664677.JPG\" alt=\"66666666\"></p>\n<br/>\n<p>ê·¸ëŸ¼ í•´ë‹¹ CSV íŒŒì¼ì„ ê¸°ë°˜ìœ¼ë¡œ BigQueryì— Tableì„ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤.  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116962680-a0c7cd80-ace1-11eb-84fa-c3e8ca5a092b.JPG\" alt=\"65446565464\"></p>\n<br/>\n<p>ë°ì´í„°ë¥¼ í™•ì¸í•´ë³´ë©´ Scriptì—ì„œ ì‹¤í–‰ ëœ ETL ê²°ê³¼ë§Œ ë‚¨ì•„ìˆëŠ” ê²ƒì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>\n<ul>\n<li>\n<p>ìŠ¤í‚¤ë§ˆ ë°ì´í„°</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116963266-59424100-ace3-11eb-9d2a-e3549f04bcae.JPG\" alt=\"77777\"></p>\n<br/>\n</li>\n<li>\n<p>ê²°ê³¼ ë°ì´í„°</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116963305-76770f80-ace3-11eb-800d-7cb6f0762ef5.JPG\" alt=\"ìº¡ì²˜332131\"></p>\n<br/>\n</li>\n</ul>\n<h2 id=\"ë\" style=\"position:relative;\"><a href=\"#%EB%81%9D\" aria-label=\"ë permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë!</h2>\n<hr>\n<h2 id=\"ë§ˆì¹˜ë©°\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"ë§ˆì¹˜ë©° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë§ˆì¹˜ë©°â€¦</h2>\n<p>DataProcì— ëŒ€í•´ì„œëŠ” ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ì§€ ëŒ€ì¶© ì•Œì•„ ë³¸ ê²ƒ ê°™ìŠµë‹ˆë‹¤.<br>\nê·¸ë˜ì„œ ë‹¤ìŒ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Procê³¼ ë™ì¼í•œ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” DataBricksë¥¼ ì‚¬ìš©í•´ë³´ê² ìŠµë‹ˆë‹¤.  </p>\n<hr>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#-data\">âœ” Data</a></li>\n<li><a href=\"#-python-script\">ğŸ‘ Python Script</a></li>\n<li><a href=\"#-dataproc-job-%EC%83%9D%EC%84%B1\">ğŸ‘Œ DataProc Job ìƒì„±</a></li>\n<li><a href=\"#-%EA%B2%B0%EA%B3%BC-%ED%99%95%EC%9D%B8\">ğŸ±â€ğŸ ê²°ê³¼ í™•ì¸</a></li>\n<li><a href=\"#%EB%81%9D\">ë!</a></li>\n<li><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">ë§ˆì¹˜ë©°â€¦</a></li>\n</ul>\n</div>","excerpt":"ë¨¸ë¦¬ë§   ì €ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œ DataProcì— ëŒ€í•œ ì„¤ëª…ê³¼ ê°„ë‹¨í•œ ì‚¬ìš©ë²•ì„ ë‹¤ë¤„ë´¤ì—ˆìŠµë‹ˆë‹¤. ì´ë²ˆì—ëŠ” DataProc Clusterì— Pyspark Scriptë¥¼ ì‚¬ìš©í•´ì„œ \nìë™í™” JOBì„ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤. íŒŒì´ì¬ì„ ì²¨ê°€í•´ì„œ   âœ” Data Dataì˜ ê²½ìš°ì—ëŠ” ì´ì „ í¬ìŠ¤íŠ¸ì—ì„œ ë‹¤ë¤˜ì—ˆë˜ Covid-19ì˜ ê¸°ìƒ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì§„í–‰í•©ë‹ˆë‹¤.   12312312 ìš©ëŸ‰ : ì•½ 51GB í–‰ : 542,304,210 2222 ë°ì´í„° í˜•ì‹ ìš”ì•½ ğŸ‘ Python Script ìœ„ì˜ ë°ì´í„°ì—ì„œ íŠ¹ì • ê·¸ë£¹(ë‚˜ë¼, ë‚ ì§œ) ë³„ë¡œ MAX,MIN,AVG ê°’ë“¤ì˜ í‰ê·  ê°’ì„ êµ¬í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸  ê°„ë‹¨ ì„¤ëª… : GCSì—ì„œ CSV Formatì˜ Dataë¥¼ â€¦","frontmatter":{"date":"September 10, 2021","title":"[DATA, GCP] - GCP DataProc 2íƒ„ Pyspark JOB Access","categories":"GCP DATA","author":"nasa1515","emoji":"ğŸ¤¦â€â™‚ï¸"},"fields":{"slug":"/gcp-dataproc2/"}},"next":{"id":"f1eefdc3-7c74-544e-b4c9-728dcf1c72c7","html":"<p>ë¨¸ë¦¬ë§  </p>\n<p>ì´ë²ˆì—ëŠ” DataProc(Hadoop/Spark)ë¥¼ ì‚¬ìš©í•˜ì—¬\nëŒ€ìš©ëŸ‰ì˜ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ë‹¤ë£¹ë‹ˆë‹¤. ë¬¼ë¡  íŒŒì´ì¬ì„ ì²¨ê°€í•´ì„œ  </p>\n<hr>\n<h2 id=\"-dataprocì—-ëŒ€í•´ì„œ\" style=\"position:relative;\"><a href=\"#-dataproc%EC%97%90-%EB%8C%80%ED%95%B4%EC%84%9C\" aria-label=\" dataprocì— ëŒ€í•´ì„œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>âœ” DataProcì— ëŒ€í•´ì„œ..</h2>\n<p><em>Dataprocì€ ì¼ê´„ ì²˜ë¦¬, ì¿¼ë¦¬, ìŠ¤íŠ¸ë¦¬ë°, ë¨¸ì‹  ëŸ¬ë‹ì— ì˜¤í”ˆì†ŒìŠ¤ ë°ì´í„° ë„êµ¬ë¥¼ í™œìš©í•  ìˆ˜ ìˆëŠ” ê´€ë¦¬í˜• Spark ë° Hadoop ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.</em><br>\nì¦‰ ì§€ê¸ˆê¹Œì§€ ê·€ì°®ê²Œ Spark, Hadoopì„ ì—°ë™í•˜ëŠ” ê³¼ì •ì„ ì—†ì• ê³  ì‚¬ìš©ë§Œí•˜ë©´ ë˜ëŠ” ì„œë¹„ìŠ¤ë¼ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  </p>\n<p>ì—¬ê¸°ì„œ DataFlowì™€ DataProcì˜ ì°¨ì´ì— ëŒ€í•´ì„œ ê¶ê¸ˆì¦ì´ ìƒê²¼ëŠ”ë°<br>\në‘ íˆ´ ëª¨ë‘ ETLì„ í•˜ëŠ” íˆ´ì— ëŒ€í•´ì„œëŠ” ê³µí†µì ì„ ê°€ì§€ê³  ìˆì§€ë§Œ<br>\nDataFlowëŠ” Serverless ì„œë¹„ìŠ¤ë¡œ Streaming, Batch Flowë¥¼ Codeë¡œ ê´€ë¦¬í•˜ê³  ì‹¶ìœ¼ë©´ ì‚¬ìš©í•˜ê³ <br>\nDataProcì€ ê¸°ì¡´ì— HDFS ê°™ì€ Hadoop EcoSystemì— ì¢…ì†ë˜ì–´ ìˆëŠ” ì‹œìŠ¤í…œì„ ê°€ì§€ê³  ìˆë‹¤ë©´ ì‚¬ìš©í•˜ê¸° ì¢‹ë‹¤ê³  í•©ë‹ˆë‹¤.</p>\n<br/>\n<hr>\n<h2 id=\"-dataproc-cluster-ìƒì„±\" style=\"position:relative;\"><a href=\"#-dataproc-cluster-%EC%83%9D%EC%84%B1\" aria-label=\" dataproc cluster ìƒì„± permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>âœŒ DataProc Cluster ìƒì„±</h2>\n<br/>\n<ul>\n<li>\n<p>GCP íƒìƒ‰ ë©”ë‰´ > Dataproc > í´ëŸ¬ìŠ¤í„° ì„ íƒ > í´ëŸ¬ìŠ¤í„° ë§Œë“¤ê¸°</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116354676-b8134080-a833-11eb-8b5a-249126ff2798.png\" alt=\"ë‹¤ìš´ë¡œë“œ\"></p>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>í´ëŸ¬ìŠ¤í„° í•„ë“œ ì„¤ì • (ì´ë¦„ì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ë¶€ë¶„ì€ ê¸°ë³¸ê°’)</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116355090-4f789380-a834-11eb-8880-311c70b982b2.JPG\" alt=\"ìº¡ì²˜\"></p>\n<br/>\n</li>\n<li>\n<p>í”„ë¡œë¹„ì €ë‹ ê³¼ì •ì„ 3ë¶„ì •ë„ ê±°ì¹˜ê³  ë‹¤ìŒê³¼ ê°™ì´ ìƒì„±ì´ ì™„ë£Œë©ë‹ˆë‹¤.</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116356531-5b655500-a836-11eb-873e-f5701fbc4d9a.JPG\" alt=\"2\"></p>\n</li>\n</ul>\n<br/>\n<hr>\n<h2 id=\"-data-ì¤€ë¹„í•˜ê¸°\" style=\"position:relative;\"><a href=\"#-data-%EC%A4%80%EB%B9%84%ED%95%98%EA%B8%B0\" aria-label=\" data ì¤€ë¹„í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ™Œ Data ì¤€ë¹„í•˜ê¸°</h2>\n<p>ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” BigQueryì—ì„œ ê³µê°œì ìœ¼ë¡œ ì œê³µí•˜ëŠ” DataSetì„ ì´ìš©í•©ë‹ˆë‹¤.  </p>\n<p>Dataproc ClusterëŠ” GCS Connectorë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ì—¬<br>\në‹¤ë¥¸ ì„¤ì •ì—†ì´ GCSì— ìˆëŠ” ë°ì´í„°ì— ë°”ë¡œ ì•¡ì„¸ìŠ¤ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.<br>\nì €ëŠ” ì´ë¥¼ ì´ìš©í•´ì„œ BigQueryì˜ ê³µê°œ DataSetì˜ íŠ¹ì • í…Œì´ë¸”ì„ Cloud Storageë¡œ Exportí•˜ì—¬<br>\nExportí•œ ë°ì´í„°ì— ë°”ë¡œ ì ‘ê·¼í•˜ì—¬ ì‚¬ìš©, í¼í¬ë¨¼ìŠ¤ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ê² ìŠµë‹ˆë‹¤.  </p>\n<br/>\n<ul>\n<li>\n<p>ë°ì´í„° ì •ë³´  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116357157-24437380-a837-11eb-9047-048e8e5a018d.JPG\" alt=\"ìº¡ì²˜3\"></p>\n<ul>\n<li>Table ID : bigquery-public-data:covid19<em>weathersource</em>com.postal<em>code</em>day_history</li>\n<li>Table í¬ê¸° : ì•½ 300 </li>\n</ul>\n<br/>\n</li>\n<li>\n<p>ë°ì´í„° í˜•ì‹ </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116357277-476e2300-a837-11eb-920c-682f3e9dfa19.JPG\" alt=\"ìº¡ì²˜4\"></p>\n<p>ë°ì´í„°ì˜ ë‚´ìš©ì€ ë‚˜ë¼ ë³„ COVID-19ì˜ ê¸°ìƒìƒíƒœ ë°ì´í„°ì…ë‹ˆë‹¤.  </p>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>Cloude Storage ìƒì„± (GCS) - ì¿¼ë¦¬ ê²°ê³¼ ë°ì´ëŸ¬(CSV)í‹‘ ìŒ“ëŠ” ê³³  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116358291-720cab80-a838-11eb-8d31-a13169891652.JPG\" alt=\"ìº¡ì²˜5\"></p>\n<ul>\n<li>Regionì„ Bigqueryì™€ ë§ì¶°ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. </li>\n</ul>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>BigQuery DataSet, Table ìƒì„± (ì¿¼ë¦¬ ê²°ê³¼ ë°ì´í„°ë¥¼ ìŒ“ëŠ” ê³³)</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116358650-d7609c80-a838-11eb-8791-4acddef9cb46.JPG\" alt=\"ìº¡ì²˜6\"></p>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>ì €ëŠ” Pythonìœ¼ë¡œ ê°„ë‹¨í•œ ì½”ë“œë¥¼ ì‘ì„±í•´ì„œ ë‹¤ìŒê³¼ ê°™ì´ ë°ì´í„°ë¥¼ ë¶„ë¥˜í–ˆìŠµë‹ˆë‹¤.  </p>\n<p>ê³µê°œ DataSetì—ì„œ ì¿¼ë¦¬ ê²°ê³¼ë¥¼ ë‹¤ë¥¸ í…Œì´ë¸”ì— ì €ì¥í•˜ëŠ” ì½”ë“œ </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> google<span class=\"token punctuation\">.</span>cloud <span class=\"token keyword\">import</span> bigquery\n\n<span class=\"token comment\"># Construct a BigQuery client object.</span>\nclient <span class=\"token operator\">=</span> bigquery<span class=\"token punctuation\">.</span>Client<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># TODO(developer): Set table_id to the ID of the destination table.</span>\ntable_id <span class=\"token operator\">=</span> <span class=\"token string\">\"lws-cloocus.ustest.ustable\"</span>\n\njob_config <span class=\"token operator\">=</span> bigquery<span class=\"token punctuation\">.</span>QueryJobConfig<span class=\"token punctuation\">(</span>destination<span class=\"token operator\">=</span>table_id<span class=\"token punctuation\">)</span>\n\nsql <span class=\"token operator\">=</span> <span class=\"token string\">'SELECT * FROM `bigquery-public-data.covid19_weathersource_com.postal_code_day_history` LIMIT 34230421'</span>\n\n<span class=\"token comment\"># Start the query, passing in the extra configuration.</span>\nquery_job <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> job_config<span class=\"token operator\">=</span>job_config<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># Make an API request.</span>\nquery_job<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># Wait for the job to complete.</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Query results loaded to the table {}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>table_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>ì•„ì…”ì•¼ í•˜ëŠ” ê±´ Tableì„ ë³µì‚¬í•˜ëŠ” ê²ƒê³¼ ë°ì´í„°ë§Œ(ì¿¼ë¦¬ê²°ê³¼)ë³µì‚¬í•˜ëŠ” ê²ƒì€ ë‹¤ë¦…ë‹ˆë‹¤.<br>\nTableì„ ê·¸ëŒ€ë¡œ ë³µì‚¬í•˜ê²Œë˜ë©´ Tableì˜ ì •ë³´ê¹Œì§€ ì €ì¥ë©ë‹ˆë‹¤..</li>\n</ul>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>í•´ë‹¹ Codeë¥¼ ì‹¤í–‰ì‹œí‚¤ê²Œ ë˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ íŠ¹ì • Tableì— ì¿¼ë¦¬ê²°ê³¼ê°€ ì €ì¥ë©ë‹ˆë‹¤.  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116361301-c9f8e180-a83b-11eb-90fb-a61cfbbd8fc9.JPG\" alt=\"ìº¡ì²˜\"></p>\n</li>\n</ul>\n<br>\n<ul>\n<li>\n<p>ì¿¼ë¦¬ê²°ê³¼ê°€ ì €ì¥ë˜ì–´ìˆëŠ” Tableì˜ ë°ì´í„°ë¥¼ csvë¡œ ë³€í™˜í•´ì„œ GCSë¡œ ì €ì¥  </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Source option</span>\nproject <span class=\"token operator\">=</span> <span class=\"token string\">\"lws-cloocus\"</span>\ndataset_id <span class=\"token operator\">=</span> <span class=\"token string\">\"ustest\"</span>\ntable_id <span class=\"token operator\">=</span> <span class=\"token string\">\"ustable\"</span>\n\n\n<span class=\"token comment\"># ìš©ëŸ‰ ë§ì€ Table (1Gì´ìƒ)ì€ * ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ Table ì½ì–´ì„œ csví™” ì‹œì¼œì•¼ í•¨.</span>\ndestination_uri <span class=\"token operator\">=</span> <span class=\"token string\">\"gs://{}/{}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>bucket_name<span class=\"token punctuation\">,</span> <span class=\"token string\">\"result*.csv\"</span><span class=\"token punctuation\">)</span>\ndataset_ref <span class=\"token operator\">=</span> bigquery<span class=\"token punctuation\">.</span>DatasetReference<span class=\"token punctuation\">(</span>project<span class=\"token punctuation\">,</span> dataset_id<span class=\"token punctuation\">)</span>\ntable_ref <span class=\"token operator\">=</span> dataset_ref<span class=\"token punctuation\">.</span>table<span class=\"token punctuation\">(</span>table_id<span class=\"token punctuation\">)</span>\n\nextract_job <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span>extract_table<span class=\"token punctuation\">(</span>\n    table_ref<span class=\"token punctuation\">,</span>\n    destination_uri<span class=\"token punctuation\">,</span>\n    <span class=\"token comment\"># Location must match that of the source table.</span>\n    location<span class=\"token operator\">=</span><span class=\"token string\">\"US\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># API request</span>\nextract_job<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># Waits for job to complete.</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"Exported {}:{}.{} to {}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>project<span class=\"token punctuation\">,</span> dataset_id<span class=\"token punctuation\">,</span> table_id<span class=\"token punctuation\">,</span> destination_uri<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>BigQeuryì—ì„œ Dataë¥¼ export í•  ë•Œ í•œë²ˆì— 1GB ë‹¨ìœ„ê¹Œì§€ ë°–ì— ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br>\në•Œë¬¸ì— * ì™€ì¼ë“œì¹´ë“œë¥¼ ì‚¬ìš©í•´ì„œ CSV Fileì„ ë¶„ë¦¬í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.  </li>\n</ul>\n<br/>\n</li>\n<li>\n<p>í•´ë‹¹ ì½”ë“œë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ GCSì— Dataê°€ ì €ì¥ë©ë‹ˆë‹¤.  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116361977-8783d480-a83c-11eb-8d1e-5d447ce71323.JPG\" alt=\"ìº¡ì²˜3\"></p>\n<ul>\n<li>ë‹¤ìŒê³¼ ê°™ì´ ìš©ëŸ‰ì´ ì¼ì •í•˜ê²Œ ë‚˜ëˆ ì„œ ì €ì¥ë©ë‹ˆë‹¤.  </li>\n</ul>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>ì €ì¥ëœ CSV Fileì„ Localë¡œ ë‹¤ìš´ë°›ì•„ì„œ NotePadë¡œ í™•ì¸í•´ë³´ì£   </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116362297-ddf11300-a83c-11eb-8944-4694fb94bd4e.JPG\" alt=\"23\"></p>\n<ul>\n<li>ë‹¤ìŒê³¼ ê°™ì´ ë§¨ ìœ—ì¤„ì€ í—¤ë” ì •ë³´, ë‚˜ë¨¸ì§€ëŠ” ë°ì´í„° ê°’ë§Œ ì €ì¥ë©ë‹ˆë‹¤.  </li>\n</ul>\n</li>\n</ul>\n<br/>\n<hr>\n<h2 id=\"-jupyter-notebook-ì—°ê²°\" style=\"position:relative;\"><a href=\"#-jupyter-notebook-%EC%97%B0%EA%B2%B0\" aria-label=\" jupyter notebook ì—°ê²° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ‘ Jupyter Notebook ì—°ê²°</h2>\n<p>ì´ì œ ê°„ë‹¨í•œ ì¿¼ë¦¬ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ê¸° ìœ„í•´ Jupyter Notebookì„ ì—°ê²° í•˜ë ¤ê³  í–ˆëŠ”ë°â€¦<br>\në³´ë‹ˆê¹ Clusterë¥¼ ì˜ëª» ìƒì„±í–ˆë„¤ìš” ì•„ë˜ êµ¬ì„±ìš”ì†Œ GWë¥¼ ì‚¬ìš©í•˜ëŠ” ì˜µì…˜ì„ ì²´í¬í•´ì•¼í•©ë‹ˆë‹¤.  </p>\n<ul>\n<li>\n<p>êµ¬ì„±ìš”ì†Œ ê²Œì´íŠ¸ì›¨ì´ </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116366348-2a3e5200-a841-11eb-81c1-c83a9f629154.JPG\" alt=\"ìº¡ì²˜\"></p>\n<ul>\n<li>ê²Œì´íŠ¸ì›¨ì´ ì˜µì…˜ ì²´í¬</li>\n<li>êµ¬ì„±ìš”ì†Œì—ì„œ Jupyter Notebook ì²´í¬ </li>\n</ul>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>í´ëŸ¬ìŠ¤í„°ê°€ ìƒˆë¡­ê²Œ ë§Œë“¤ì–´ì¡Œë‹¤ë©´ í´ëŸ¬ìŠ¤í„° ì •ë³´-> ì›¹ ì¸í„°í˜ì´ìŠ¤ë¡œ ì ‘ì†í•©ë‹ˆë‹¤.  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116367440-527a8080-a842-11eb-9843-2fdb4cfdecfa.JPG\" alt=\"ìº¡ì²˜3\"></p>\n<ul>\n<li>ê·¸ëŸ¼ ë‹¤ìŒê³¼ ê°™ì´ JupyterLab GW linkê°€ ìƒê¸°ê³  ì ‘ì†í•©ë‹ˆë‹¤.  </li>\n</ul>\n<br/>\n</li>\n<li>\n<p>ê·¸ëŸ¼ ë‹¤ìŒê³¼ ê°™ì´ DataProc Clusterì™€ ì—°ê²°ëœ Jupyter Pageì— ì ‘ì†ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116367646-85bd0f80-a842-11eb-8005-406031f0ca44.JPG\" alt=\"ìº¡ì²˜4\"></p>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>ì´ í›„ì— GCSì— ì €ì¥ëœ csvë¥¼ ì½ëŠ” ê²ƒë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116504392-21a65400-a8f3-11eb-9e7e-8295718c17e2.JPG\" alt=\"33333\"></p>\n<br/>\n</li>\n<li>\n<p>ì €ëŠ” ì¿¼ë¦¬ ê²°ê³¼ ì‹œê°„ì´ë‚˜, table í˜•íƒœë¡œ ê²°ê³¼ë¥¼ ë³´ê³  ì‹¶ì–´ì„œ extensionì„ ì¶”ê°€ ì„¤ì¹˜ í–ˆìŠµë‹ˆë‹¤. </p>\n<br/>\n<ul>\n<li>\n<p>Jupyterì—ì„œ Terminal ì°½ì„ ì—° ë’¤ ì•„ë˜ ëª…ë ¹ì–´ë¡œ ì„¤ì¹˜í•©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token preprocessor property\"># pip install jupyterlab_execute_time</span></code></pre></div>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>ì„¤ì¹˜ê°€ ì™„ë£Œ ëœ ë’¤ ì—°ê²°ëœ WEBì„ ìƒˆë¡œê³ ì¹¨ í•˜ë©´ execure-time ì´ ì„¤ì¹˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤.  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116510416-d5154580-a8ff-11eb-86ff-8ea55e585217.JPG\" alt=\"ìº¡ì²˜444\"></p>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>ê·¸ í›„ Settings - Advanced Settings editor - Notebookì— ì•„ë˜ ì½”ë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116514663-4b1cab00-a906-11eb-9071-34c3d15fc616.JPG\" alt=\"22222222\"></p>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>ê·¸ëŸ¼ ë‹¤ìŒê³¼ ê°™ì´ ì¿¼ë¦¬ ì‹¤í–‰ ì‹œê°„ì´ ì¶œë ¥ë©ë‹ˆë‹¤.!</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116514759-6be50080-a906-11eb-9860-534243a6388f.JPG\" alt=\"3213121\"></p>\n</li>\n</ul>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>ì €ëŠ” í•„ìš”í•´ë³´ì´ëŠ” ì¶”ê°€ Extentionì„ ë” ì„¤ì¹˜í•´ì¤¬ìŠµë‹ˆë‹¤.  </p>\n<br/>\n<ul>\n<li>variableinspector</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token preprocessor property\"># pip install lckr-jupyterlab-variableinspector</span></code></pre></div>\n<br/>\n<ul>\n<li>TOC</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token preprocessor property\"># jupyter nbextension enable toc2/main</span></code></pre></div>\n</li>\n</ul>\n<br/>\n<hr>\n<h2 id=\"-pyspark-test\" style=\"position:relative;\"><a href=\"#-pyspark-test\" aria-label=\" pyspark test permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ‘ Pyspark Test</h2>\n<p>ìœ„ì—ì„œë„ Testë¥¼ í•´ë´¤ì§€ë§Œ ê·¸ë˜ë„ ëª‡ê°€ì§€ pyspark í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ë³´ê² ìŠµë‹ˆë‹¤.  </p>\n<br/>\n<ul>\n<li>\n<p>CSV File ì½ì–´ì˜¤ê¸° (GCSì— ìˆëŠ”)  </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># df = spark.read.csv(\"gs://nasa_us/\", header=True, inferSchema=True)</span></code></pre></div>\n<ul>\n<li>gs://nasa_us/ ê²½ë¡œì— ìˆëŠ” ëª¨ë“  íŒŒì¼ì„ ì½ìŠµë‹ˆë‹¤.  </li>\n<li>read.csv ì˜µì…˜ì¸ header, inferSchemaë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.  </li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116836339-17d96500-ac01-11eb-9ab5-707e5ae65e2c.JPG\" alt=\"2221313\"></p>\n<ul>\n<li>ì•½ 45.96s ê°€ ì†Œìš” ë˜ì—ˆìŠµë‹ˆë‹¤.  </li>\n</ul>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>í•´ë‹¹ DataFrameì˜ Row ë°˜í™˜ </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># df.show(10)    -- Row 10ê°œ ë°˜í™˜</span>\n<span class=\"token comment\"># df.count()     -- Row ê°¯ìˆ˜ ë°˜í™˜</span></code></pre></div>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116836737-ac909280-ac02-11eb-8dcc-dac053327581.JPG\" alt=\"11111\"></p>\n<ul>\n<li>showì—ëŠ” 546ms ê°€ ì†Œìš” ë˜ì—ˆìŠµë‹ˆë‹¤.</li>\n<li>countì—ëŠ” 13.81s ê°€ ì†Œìš” ë˜ì—ˆìŠµë‹ˆë‹¤.  </li>\n</ul>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>í•´ë‹¹ DataFrameì˜ Summary ê°’ ë°˜í™˜</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># df.summary().show()</span></code></pre></div>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/116841196-68f25480-ac13-11eb-872b-1fc2019bdc29.JPG\" alt=\"222222\"></p>\n<ul>\n<li>Summaryì—ëŠ” 4m 16.06s ê°€ ì†Œìš” ë˜ì—ˆìŠµë‹ˆë‹¤.</li>\n</ul>\n</li>\n</ul>\n<br/>\n<hr>\n<h2 id=\"ë§ˆì¹˜ë©°\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"ë§ˆì¹˜ë©° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë§ˆì¹˜ë©°â€¦</h2>\n<p>DataProcì„ ì‚¬ìš©í•´ë³´ë©´ì„œ Sparkì— ëŒ€í•´ì„œë„ ë‹¤ì‹œ ì•Œì•„ ê°ˆ ìƒê°ì…ë‹ˆë‹¤.<br>\nê·¸ë˜ì„œ ë‹¤ìŒ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Pysparkì˜ ë¬¸ë²•ì— ëŒ€í•´ì„œ í¬ìŠ¤íŒ… ì˜ˆì •ì…ë‹ˆë‹¤.  </p>\n<hr>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#-dataproc%EC%97%90-%EB%8C%80%ED%95%B4%EC%84%9C\">âœ” DataProcì— ëŒ€í•´ì„œ..</a></li>\n<li><a href=\"#-dataproc-cluster-%EC%83%9D%EC%84%B1\">âœŒ DataProc Cluster ìƒì„±</a></li>\n<li><a href=\"#-data-%EC%A4%80%EB%B9%84%ED%95%98%EA%B8%B0\">ğŸ™Œ Data ì¤€ë¹„í•˜ê¸°</a></li>\n<li><a href=\"#-jupyter-notebook-%EC%97%B0%EA%B2%B0\">ğŸ‘ Jupyter Notebook ì—°ê²°</a></li>\n<li><a href=\"#-pyspark-test\">ğŸ‘ Pyspark Test</a></li>\n<li><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">ë§ˆì¹˜ë©°â€¦</a></li>\n</ul>\n</div>","frontmatter":{"date":"September 08, 2021","title":"[DATA, GCP] - GCP DataProc spark Clusterë¡œ ETL í›„ BigQueryì— ì ì¬","categories":"GCP DATA","author":"nasa1515","emoji":"ğŸ¤¦â€â™‚ï¸"},"fields":{"slug":"/gcp-dataproc/"}},"prev":{"id":"14668db0-2f50-511a-abf9-9d92fcdc88bd","html":"<br/>\n<p>ë¨¸ë¦¬ë§  </p>\n<p>ì €ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œ DataProcì— ëŒ€í•œ ì„¤ëª…ê³¼ ê°„ë‹¨í•œ ì‚¬ìš©ë²•ì„ ë‹¤ë¤„ë´¤ì—ˆìŠµë‹ˆë‹¤.<br>\nì´ë²ˆì—ëŠ” GCPì—ì„œ íŒŒíŠ¸ë„ˆ SaaSí˜•íƒœë¡œ ì œê³µí•´ì£¼ëŠ” DataBricksë¥¼ ì‚¬ìš©í•´ì„œ<br>\nì§€ë‚œë²ˆê³¼ ë™ì¼í•œ ë°ì´í„°, ìŠ¤íŠ¸ë¦½íŠ¸ë¥¼ ì´ìš©í•´ì„œ ì„±ëŠ¥ì´ë‚˜, ì‚¬ìš©ë²•ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë´¤ìŠµë‹ˆë‹¤.<br>\në¬¼ë…¼ ì´ë²ˆì—ë„ íŒŒì´ì¬ì„ ì²¨ê°€í•´ì„œ  </p>\n<hr>\n<h2 id=\"-databricks\" style=\"position:relative;\"><a href=\"#-databricks\" aria-label=\" databricks permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>âœ” DataBricks?</h2>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/117228331-cf65b580-ae53-11eb-9b9d-81bd0a524677.png\" alt=\"og-databricks\"></p>\n<p>Databricksë€?<br>\nê°„ë‹¨ ìš”ì•½í•´ì„œ Spark,Hadoop ë“± ë¹…ë°ì´í„° ê´€ë ¨ ì†”ë£¨ì…˜ ì‹¤í–‰í™˜ê²½ì„ ì œê³µí•˜ëŠ” í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.<br>\ní†µí•© ë¶„ì„ í”Œë«í¼ìœ¼ë¡œ, í•œ WorkSpaceë‚´ì—ì„œ ì—¬ëŸ¬ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•´ ëª¨ë“  ë¶„ì„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.<br>\nì´ì „ì— Spark, Hadoopì„ ON-Premise í™˜ê²½ì— ì„¤ì¹˜í•œ í¬ìŠ¤íŠ¸ë¥¼ í™•ì¸í•´ë³´ì‹œë©´ ì•Œê² ì§€ë§Œ<br>\nJDKë¶€í„° ì—°ë™í•´ì•¼ í•˜ëŠ” ë¶€ë¶„ì´ ë§¤ìš° ê·€ì°®ê³  ì˜¤ëœ ì‹œê°„ì´ ê±¸ë¦¬ê²Œ ë©ë‹ˆë‹¤.<br>\nDataBricksë¥¼ ì‚¬ìš©í•˜ë©´ ì„¤ì¹˜, ì„¤ì • ë¶€ë¶„ ì—†ì´ ë°”ë¡œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.  </p>\n<p>DataBricksëŠ” ì•„ë˜ ì‘ì—…ë“¤ì„ í•œ WorkSpaceì—ì„œ ì§€ì›í•©ë‹ˆë‹¤.  </p>\n<ul>\n<li>reports</li>\n<li>dashboards</li>\n<li>ETL ì‘ì—… ì‹¤í–‰ (Extract, Transform, Load)</li>\n<li>ë¨¸ì‹ ëŸ¬ë‹, ìŠ¤íŠ¸ë¦¼ ì‘ì—…</li>\n<li>ì•„íŒŒì¹˜ Sparkë³´ë‹¤ ë” optimized.</li>\n<li>Databricks ì„œë²„ì™€ ì‹¤ì‹œê°„ìœ¼ë¡œ interaction</li>\n</ul>\n<br/>\n<hr>\n<h2 id=\"-gcp-databricks\" style=\"position:relative;\"><a href=\"#-gcp-databricks\" aria-label=\" gcp databricks permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ‘Œ GCP DataBricks?</h2>\n<p>GCP, Azure, AWS ë“± 3ì‚¬ Public CloudëŠ” ì´ë¯¸ DataBricksë¥¼ SaaS, PaaS í˜•íƒœë¡œ ì§€ì›í•˜ê³  ìˆìŠµë‹ˆë‹¤.<br>\nGCPì˜ ê²½ìš° ì•„ì§ ë„ì…ëœì§€ 1ë…„ì´ ì±„ ì•ˆë˜ì„œ ë¶ˆì•ˆì •í•œ ë¶€ë¶„ë„ ìˆê³  Korea Regionë„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br>\nì•„ì§ GAì¼ì •ë„ ë‚˜ì˜¤ì§€ ì•Šì€ ìƒíƒœêµ¬ìš”â€¦(AWS,AZUREëŠ” ë‹¤ ìˆëŠ”ë°â€¦)<br>\nê·¸ë˜ì„œ ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” ì–´ì©” ìˆ˜ ì—†ì´ US Regionì—ì„œì˜ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.  </p>\n<br/>\n<ul>\n<li>\n<h4 id=\"databricks-ì‚¬ìš©í•˜ê¸°êµ¬ë…\" style=\"position:relative;\"><a href=\"#databricks-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0%EA%B5%AC%EB%8F%85\" aria-label=\"databricks ì‚¬ìš©í•˜ê¸°êµ¬ë… permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DataBricks ì‚¬ìš©í•˜ê¸°(êµ¬ë…)</h4>\n<p>GCPì—ì„œ DataBricksë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬ë…ì„ ë¨¼ì € ì§„í–‰í•´ì•¼ í•©ë‹ˆë‹¤.  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/117228743-a0037880-ae54-11eb-9362-11dd61314007.JPG\" alt=\"da\"></p>\n<ul>\n<li>êµ¬ë… ì´í›„ì— DataBricksì˜ êµ¬ë§¤ ìŠ¤í™ì„ ì •í•˜ê³  DataBricks Dashboradë¡œ ì´ë™í•˜ë©´ ë©ë‹ˆë‹¤.  </li>\n</ul>\n<br/>\n</li>\n<li>\n<h4 id=\"workspace-ìƒì„±\" style=\"position:relative;\"><a href=\"#workspace-%EC%83%9D%EC%84%B1\" aria-label=\"workspace ìƒì„± permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WorkSpace ìƒì„±</h4>\n<p>Dashboradì—ì„œ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš© í•  WorkSpaceë¥¼ ìƒì„±í•˜ë©´ ë©ë‹ˆë‹¤.</p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/117228897-025c7900-ae55-11eb-941b-597f74ec3f45.JPG\" alt=\"ìº¡ì²˜2\"></p>\n<br/>\n</li>\n<li>\n<h4 id=\"workspace-ì ‘ì†\" style=\"position:relative;\"><a href=\"#workspace-%EC%A0%91%EC%86%8D\" aria-label=\"workspace ì ‘ì† permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WorkSpace ì ‘ì†</h4>\n<p>WorkSpaceë¥¼ ìƒì„± í›„ URLì— ì ‘ì†í•˜ë©´ ë“œë””ì–´ ë°ì´í„° ì‘ì—…ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/117229354-d42b6900-ae55-11eb-839c-bc1f7979ed4b.JPG\" alt=\"123123123\"></p>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<h4 id=\"databricks-cluster-ìƒì„±\" style=\"position:relative;\"><a href=\"#databricks-cluster-%EC%83%9D%EC%84%B1\" aria-label=\"databricks cluster ìƒì„± permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DataBricks Cluster ìƒì„±</h4>\n<p>WorkSpaceì˜ Cluster Tabì—ì„œ Create Clusterë¥¼ í´ë¦­í•´ ìƒì„±í•©ë‹ˆë‹¤.  </p>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/117230334-d68ec280-ae57-11eb-939d-295ed700acea.JPG\" alt=\"33333333333333\"></p>\n</li>\n</ul>\n<br>\n<ul>\n<li>\n<h4 id=\"ì €ëŠ”-ë‹¤ìŒê³¼-ê°™ì€-specìœ¼ë¡œ-clusterë¥¼-ìƒì„±í–ˆìŠµë‹ˆë‹¤\" style=\"position:relative;\"><a href=\"#%EC%A0%80%EB%8A%94-%EB%8B%A4%EC%9D%8C%EA%B3%BC-%EA%B0%99%EC%9D%80-spec%EC%9C%BC%EB%A1%9C-cluster%EB%A5%BC-%EC%83%9D%EC%84%B1%ED%96%88%EC%8A%B5%EB%8B%88%EB%8B%A4\" aria-label=\"ì €ëŠ” ë‹¤ìŒê³¼ ê°™ì€ specìœ¼ë¡œ clusterë¥¼ ìƒì„±í–ˆìŠµë‹ˆë‹¤ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì €ëŠ” ë‹¤ìŒê³¼ ê°™ì€ Specìœ¼ë¡œ Clusterë¥¼ ìƒì„±í–ˆìŠµë‹ˆë‹¤.</h4>\n<p><img src=\"https://user-images.githubusercontent.com/69498804/117380571-f20bd300-af14-11eb-9cae-69720f7c2043.JPG\" alt=\"2222\"></p>\n<ul>\n<li>Nmae : Cluster01 </li>\n<li>Runtime Version : 8.1  </li>\n<li>Worker Type : n2-standard-8 </li>\n<li>Advanced Option Tabì„ ì—´ì–´ Google Service Account ì…ë ¥\nì£¼ì˜ : Service AccountëŠ” GCSì— ê¶Œí•œì´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.</li>\n</ul>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>ì´ì œ Notebookì„ ìƒì„±í•˜ê³  GCSë¥¼ DBFSì— Mountí•´ì„œ ì‚¬ìš©í•˜ì‹œë©´ ë©ë‹ˆë‹¤.  </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">bucket_name <span class=\"token operator\">=</span> <span class=\"token string\">\"nasagcp\"</span>\nmount_name <span class=\"token operator\">=</span> <span class=\"token string\">\"gcpdata\"</span>\ndbutils<span class=\"token punctuation\">.</span>fs<span class=\"token punctuation\">.</span>mount<span class=\"token punctuation\">(</span><span class=\"token string\">\"gs://%s\"</span> <span class=\"token operator\">%</span> bucket_name<span class=\"token punctuation\">,</span> <span class=\"token string\">\"/mnt/%s\"</span> <span class=\"token operator\">%</span> mount_name<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>ë‹¤ìŒê³¼ ê°™ì€ í˜•ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</li>\n</ul>\n</li>\n</ul>\n<br/>\n<ul>\n<li>\n<p>ì €ëŠ” ì´ì „ì— ì§œë†¨ì—ˆë˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë‹¤ìŒê³¼ ê°™ì€ í˜•ì‹ìœ¼ë¡œ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">bucket_name <span class=\"token operator\">=</span> <span class=\"token string\">\"nasagcp\"</span>\nmount_name <span class=\"token operator\">=</span> <span class=\"token string\">\"gcpdat11\"</span>\ndbutils<span class=\"token punctuation\">.</span>fs<span class=\"token punctuation\">.</span>mount<span class=\"token punctuation\">(</span><span class=\"token string\">\"gs://%s\"</span> <span class=\"token operator\">%</span> bucket_name<span class=\"token punctuation\">,</span> <span class=\"token string\">\"/mnt/%s\"</span> <span class=\"token operator\">%</span> mount_name<span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>context <span class=\"token keyword\">import</span> SparkContext\n<span class=\"token keyword\">from</span> pyspark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>session <span class=\"token keyword\">import</span> SparkSession\n\n\n<span class=\"token comment\"># ------------------------------------------------------------------</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">renameCols</span><span class=\"token punctuation\">(</span>df1<span class=\"token punctuation\">,</span> old_columns<span class=\"token punctuation\">,</span> new_columns<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> old_col<span class=\"token punctuation\">,</span>new_col <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>old_columns<span class=\"token punctuation\">,</span>new_columns<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        d1f <span class=\"token operator\">=</span> df1<span class=\"token punctuation\">.</span>withColumnRenamed<span class=\"token punctuation\">(</span>old_col<span class=\"token punctuation\">,</span>new_col<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> df1\n\n\n<span class=\"token comment\"># Old_columns</span>\nold_columns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'avg(min_temperature_air_2m_f)'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'avg(max_temperature_air_2m_f)'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'avg(avg_temperature_air_2m_f)'</span>\n                <span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># New_columns</span>\nnew_columns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'temperature_air_min_avg'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'temperature_air_max_avg'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'temperature_air_avg_avg'</span>\n                <span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># --------------------------------------------</span>\n<span class=\"token comment\"># ----------------------</span>\n\n<span class=\"token comment\"># Read CSV from GCS</span>\ndf_lee <span class=\"token operator\">=</span> spark<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"/mnt/gcpdat11/\"</span><span class=\"token punctuation\">,</span> header<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> inferSchema<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># data transform</span>\ndf_lee <span class=\"token operator\">=</span> df_lee<span class=\"token punctuation\">.</span>groupBy<span class=\"token punctuation\">(</span><span class=\"token string\">'country'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'date'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>agg<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">'min_temperature_air_2m_f'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'avg'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'max_temperature_air_2m_f'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'avg'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'avg_temperature_air_2m_f'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'avg'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>sort<span class=\"token punctuation\">(</span>desc<span class=\"token punctuation\">(</span><span class=\"token string\">'country'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>orderBy<span class=\"token punctuation\">(</span><span class=\"token string\">'date'</span><span class=\"token punctuation\">)</span>\n\ndf_result <span class=\"token operator\">=</span> renameCols<span class=\"token punctuation\">(</span>df_lee<span class=\"token punctuation\">,</span> old_columns<span class=\"token punctuation\">,</span> new_columns<span class=\"token punctuation\">)</span>\n\ncountry1 <span class=\"token operator\">=</span> df_result<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token string\">\"country\"</span><span class=\"token punctuation\">)</span>\ncountry_dis10 <span class=\"token operator\">=</span> df_result<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token string\">\"country\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>distinct<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"country_count =\"</span><span class=\"token punctuation\">,</span>country_dis10<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\"># Write CSV to GCS</span>\ndf_result<span class=\"token punctuation\">.</span>coalesce<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"header\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"true\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>mode<span class=\"token punctuation\">(</span><span class=\"token string\">\"overwrite\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"/mnt/gcpdat11/dbfsre/\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>ì´ì „ì— ë°›ì•„ë†¨ë˜ Covid-19 ê¸°ìƒ ë°ì´í„°ë¥¼ ì •ë ¬í•˜ëŠ” Code ì…ë‹ˆë‹¤.  </li>\n</ul>\n</li>\n</ul>\n<br/> \n<hr>\n<h2 id=\"ë§ˆì¹˜ë©°\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"ë§ˆì¹˜ë©° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë§ˆì¹˜ë©°â€¦</h2>\n<p>ì‚¬ì‹¤ DataBricksëŠ” ì‚¬ìš©ë²•ì— ëŒ€í•œ ê°€ì´ë“œë¥¼ ë‚¨ê¸°ê¸°ì—ëŠ” ë„ˆë¬´ ê°„í¸í•©ë‹ˆë‹¤..<br>\nê·¸ë˜ì„œ ê·¸ë‚˜ë§ˆ ì–´ë ¤ì›€ì´ ìˆì„ ê²ƒ ê°™ì€ DBFS Mount ë¶€ë¶„ë§Œ ì„¤ëª…í–ˆìŠµë‹ˆë‹¤.  </p>\n<hr>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#-databricks\">âœ” DataBricks?</a></li>\n<li><a href=\"#-gcp-databricks\">ğŸ‘Œ GCP DataBricks?</a></li>\n<li><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">ë§ˆì¹˜ë©°â€¦</a></li>\n</ul>\n</div>","frontmatter":{"date":"September 12, 2021","title":"[DATA, GCP] - GCP DataBricks ì‚¬ìš©ê¸°","categories":"GCP DATA","author":"nasa1515","emoji":"ğŸ¤¦â€â™‚ï¸"},"fields":{"slug":"/data-databricks/"}},"site":{"siteMetadata":{"siteUrl":"https://nasa1515.com","comments":{"utterances":{"repo":"nasa1515/nasablog"}}}}},"pageContext":{"slug":"/gcp-dataproc2/","nextSlug":"/gcp-dataproc/","prevSlug":"/data-databricks/"}},"staticQueryHashes":["1073350324","2938748437"]}